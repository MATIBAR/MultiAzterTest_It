      Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II     Seigarren gaia: Hoberenatzea aldagai anitzetan (Programazio Lineala)      1.- Planteamendu orokorra. Forma kanonikoa eta forma estandarra  Programazioa  lineala,  hoberenatze  baldintzatuaren  kasu  berezi  bat  da,  helburu- funtzioa  lineala  izanik eta murrizketa guztiak desberdintza linealak direnean.  Bere forma kanonikoan, programa lineal bat honela idazten da:  maximizatu   1 1 2 2 ... n n z c x c x c x = ⋅ + ⋅ + + ⋅       ondokoari lotuta:   11 1 12 2 1 1 21 1 22 2 2 2 1 1 2 2 ... ... .............................................. ... n n n n m m mn n m a x a x a x b a x a x a x b a x a x a x b ⋅ + ⋅ + + ⋅ ≤   ⋅ + ⋅ + + ⋅ ≤   ⋅ + ⋅ + + ⋅ ≤    1 2 0 , 0 ,..., 0 n x x x ≥ ≥ ≥     Aurreko programa lineala forma estandarrean honela idatziko genuke:  maximizatu   1 1 2 2 ... n n z c x c x c x = ⋅ + ⋅ + + ⋅       ondokoari lotuta:   11 1 12 2 1 1 1 21 1 22 2 2 2 2 1 1 2 2 ... ... .................................................. ... n n n n m m mn n m m a x a x a x s b a x a x a x s b a x a x a x s b ⋅ + ⋅ + + ⋅ + =   ⋅ + ⋅ + + ⋅ + =   ⋅ + ⋅ + + ⋅ + =    1 2 1 0 , 0 ,..., 0 ; 0 , ..., 0 n m x x x s s ≥ ≥ ≥ ≥ ≥   Kasu  honetan,  programa  kanonikoko  desberdintza  bakoitzean  aldagai  artifizial  bat  sartu  dugu (lasaitze-aldagaia), berdintzazko murrizketak idatziz.    Murrizketa  guztiak  betetzen  dituzten  puntuen  multzoari  eremu  egingarria  edo  onargarria  esaten  zaio.    2.- Neurri txikiko ariketen ebazpen geometrikoa  Ebatzi nahi dugun programa lineala dimentsio txikikoa bada  (bi aldagai aske helburu-funtzioan, eta  murrizketa  zenbait),  planoaren  gainean  bilatu  dezakegu  soluzioa,  hoberenatze  baldintzatuaren  gainerako  kasuetan  egiten  den  bezala:   murrizketak  betetzen  dituzten  puntuen  multzoa  grafikoki  adierazi  (multzo  onargarria),  eta  helburu-funtzioaren  hainbat  maila- kurba  marraztu,  hoberena  (maximoa  edota  minimoa)  non  dagoen  topatzeko.  Helburu- funtzioa  lineala  izanik,  bere  maila-  Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  kurba  guztiak  paraleloak  izango  dira,  eta  gradientearekiko  elkartzutak,  beraz  1 2 ( , ) z c c c ∇ = =   bektoreak adieraziko digu helburu-funtzioa zein norabidetan handitzen doa.    Esaterako:  max  3 z x y = +   o.l.:   0 , 0 8 2 0 6 ≥ ≥    ≤ + ≤ + y x y x y x       0 1 2 3 4 5 6 7 8 9 10 0 1 2 3 4 5 y x :     1 x +     1 y =     6 :     0 x +     2 y =     8 Payoff:     1 x +     3 y =    14 Optimal Decisions(x,y): (   2,    4) :     1x +     1y <=     6 :     0x +     2y <=     8   Soluzio  egingarrien  multzoa  ilunduta  agertzen  den  eremua  da.  Helburu- funtzioaren  gradientea  (1,3) bektorea izanik, eta maila-kurbak  1 2 3 x x K + ⋅ =  zuzenak, soluzio egingarri guztien artean, K  handieneko  maila  kurba   (2,4)  puntutik  pasatzen  dena  da,  beraz,  hor  egongo  da  maximoa,  eta  funtzioak  har  dezakeen  baliorik  handiena  baldintzak  betetzen  dituzten  puntuen  artean,  z*=14.  Helburu-funtzioaren  balio  minimoa  bilatzen  badugu,  berriz,   (0,  0)  puntuan  topatuko  dugu,  bertan  z*=0 izango delarik.       Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II    Antzera egingo genuke minimizatzeko ariketa honetan:    min  y x z 80 40 + =   o.l.:   0 , 0 24 6 2 24 4 3 ≥ ≥    ≥ + ≥ + y x y x y x     0 1 2 3 4 5 6 7 8 9 10 11 12 0 1 2 3 4 5 6 y x :   2.0 x +   6.0 y =  24.0 :   3.0 x +   4.0 y =  24.0 Payoff:  40.0 x +  80.0 y = 384.0 Optimal Decisions(x,y): ( 4.8,  2.4) :   2.0x +   6.0y >=  24.0 :   3.0x +   4.0y >=  24.0   Soluzio  egingarrien  multzoa  ilundutako  eremua  da.  Kasu  honetan,  gradientea   (40,  80)  bektorea  izanik,  haren  paraleloa  den  edozein  erabil  dezakegu  irudian,  esaterako   (1,  2)  ||  (40,  80)  bektorea.  Maila-kurbak  K y x = + 8 4   formako  zuzenak  dira,  beraz,  helburu-funtzioaren  balio  minimoa  ) 4 . 2 , 8 . 4 (  puntuan aurkituko dugu, bertan funtzioak z*=384 balioa hartuko duelarik. Maximizatze  programa izango balitz, ordea, ariketa bornatu gabea da.      3.- Soluzio egingarriak eta mutur-puntuak  Froga  daiteke  hoberen  bat  egotekotan,  gutxienez  soluzio  egingarrien  multzoaren  mutur- puntu  batean egongo dela. Honako kasuak topatu daitezke:  •  soluzio bakar bat (mutur-puntu batean)   Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  •  soluzio anitzak (bi mutur-puntutan eta horien arteko segmentu osoan)  Honen adibide bat:  min  y x z 80 60 + =   o.l.:   0 , 0 24 6 2 24 4 3 ≥ ≥    ≥ + ≥ + y x y x y x   0 1 2 3 4 5 6 7 8 9 10 11 12 0 1 2 3 4 5 6 y x :   3.0 x +   4.0 y =  24.0 :   2.0 x +   6.0 y =  24.0 Payoff:  60.0 x +  80.0 y = 480.0 Optimal Decisions(x,y): ( 4.8,  2.4) ( 0.0,  6.0) :   3.0x +   4.0y >=  24.0 :   2.0x +   6.0y >=  24.0   Minimoak (0,6) eta (4.8 , 2.4) mutur- puntuetan daude, hala nola tarteko puntu guztietan ere,  bertan funtzioak z*=480 balio duelarik.    •  soluzio anitzak (mutur- puntu batean eta bertatik abiatzen den zuzenerdi batean)  Azken kasu hau ondoko adibidean ikus dezakegu:  min  y x z 2 8 − =   o.l.:   0 , 0 24 4 2 12 4 ≥ ≥    ≥ + ≥ − y x y x y x      Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  -2 -1 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 -2 -1 0 1 2 3 4 5 6 7 x :     4 x -     1 y =    12 :     2 x +     4 y =    24 :     1 x +     0 y =     0 :     0 x +     1 y =     0 Payoff:     8 x -     2 y =    24 Optimal Decisions(x,y): (   4,    4) :     4x -     1y >=    12 :     2x +     4y >=    24 :     1x +     0y >=     0 :     0x +     1y >=     0   Ikusten denez, minimoa (4,4) puntuan dago, eta baita ere puntu horretatik gora  12 4 = − y x   zuzenaren puntuetan. Puntu guzti horietan funtzioak z*=24 balio du  (maximorako bornatu  gabea da).    4.- Ebazpenerako Simplex metodoa  Programa  linealak  bi  aldagai  baino  gehiago  baditu,  ezin  da  grafikoaren  gainean  ebatzi.  Kasu  honetarako  badaude  zenbait  ebazpen- metodo,  horien  artean  Simplex  izenekoa.  Algoritmo 1 honen  bidez, programa linealaren datuak taula batean sartzen dira, eta bertan mutur- puntu batetik abiatuz  (normalean, (0,0) puntutik) hainbat eragiketa egiten dira mutur- puntu hoberena aurkitu arte, edota  programa  bornatu  gabe  dela  ondorioztatu  arte.  Eragiketa  matrizial  hauek  egiteko  prozedura  bibliografiako  testu-liburuetan  aurkitu  daiteke   (euskaraz,  liburu  honetan:  Optimizazioa,  Programazio lineala, Fernández, V. eta Zelaia, A., UEU, 1995).                                                      1 Algoritmoa: soluzioa aurkitzeko errepikatzen den eragiketa-multzoa.  Harluxet hiztegi entziklopedikoa:  iz. MAT. eta INFORM. Problema baten ebazpenerako eman behar diren urratsen  deskribapen  formala.  Programazio- lengoaia  baten  bidez,  algoritmoa  ordenadore  batek  egikari  dezakeen  programa  bihur daiteke.   Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  5.- Dualtasunaren teoria  Programa  lineal  bati  lotuta,  bere  programa  duala  planteatu  dezakegu.  Primala  forma  kanonikoan  idatzita badago:  maximizatu   1 1 2 2 ... n n z c x c x c x = ⋅ + ⋅ + + ⋅       ondokoari lotuta:   11 1 12 2 1 1 21 1 22 2 2 2 1 1 2 2 ... ... .............................................. ... n n n n m m mn n m a x a x a x b a x a x a x b a x a x a x b ⋅ + ⋅ + + ⋅ ≤   ⋅ + ⋅ + + ⋅ ≤   ⋅ + ⋅ + + ⋅ ≤    1 2 0 , 0 ,..., 0 n x x x ≥ ≥ ≥   bere duala honela idatziko dugu:  minimizatu   m m u b u b u b z ⋅ + + ⋅ + ⋅ = ... ' 2 2 1 1       ondokoari lotuta:          ≥ ⋅ + + ⋅ + ⋅ ≥ ⋅ + + ⋅ + ⋅ ≥ ⋅ + + ⋅ + ⋅ n m mn n n m m m m c u a u a u a c u a u a u a c u a u a u a ... . .......... .......... .......... .......... .......... ... ... 2 2 1 1 2 2 2 22 1 12 1 1 2 21 1 11   0 , ... , 0 , 0 2 1 ≥ ≥ ≥ m u u u   Ikusten  denez,  primalaren  murrizketa  bakoitzeko  aldagai  dual  bat  sortzen  da,  eta  primalaren  aldagai bakoitzeko, murrizketa bat dago dualean.    Matrizialki, honela planteatzen dira:  primala  duala  max   x c z t ⋅ =   o.l.  b x A ≤ ⋅   0 ≥ x   min   u b z t ⋅ = '   o.l.  c u A t ≥ ⋅   0 ≥ u     Teorema:  Primalean  maximizatzen  dugun  z   helburu- funtzioak  beti  hartzen  ditu  dualaren  minimizatzeko  ' z   helburu- funtzioaren  baino  balio  txikiagoak,  programa  bakoitzeko  soluzio  egingarrientzat.  Frogapena:  Bitez  x  eta  u  primalaren eta dualaren soluzio egingarriak, hurrenez hurren.  (Kontutan  hartu  c u A t ≥ ⋅  desberdintza iraulita  t t c A u ≥ ⋅  dela, eta  u b z t ⋅ = '  beste hau:  b u z t ⋅ = ' ). Ondoko  erlazioa betetzen da:  ' z b u x A u x c z t t t = ⋅ ≤ ⋅ ⋅ ≤ ⋅ = , frogatu nahi genuen bezala.     Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  Emaitza  horren  lehen  ondorioa  zera  da:   programetako  bat  bornatu  gabea  bada,  besteak  ez  du  soluziorik.  Bestalde,  frogatu  daiteke  primalak  soluzioa  duenean  dualak  ere  edukiko  duela,  eta  bietan  helburu  funtzioaren  balioa  bera  izango  dela.  Hau  da,  * x   eta  * u   badira  primalaren  eta  dualaren hoberenak, hurrenez hurren, orduan:  '* * * * * * z b u x A u x c z t t t = ⋅ = ⋅ ⋅ = ⋅ = .    Lasaitze  osagarriaren  teorema:   primalak  eta  dualak  soluzio  hoberena  badute,  primalaren  murrizketa bat ase gabe badago hoberenean, dualean dagokion aldagaiaren balio hoberena zero da,  eta primalaren aldagai baten balio hoberena hertsiki positiboa bada, dualean dagokion murrizketa  ase dago hoberenean.  Era berean, dualaren murrizketa bat ase gabe badago hoberenean, primalean dagokion aldagaiaren  balio  hoberena  zero  da,  eta  dualaren  aldagai  baten  balio  hoberena  hertsiki  positiboa  bada,  primalean dagokion murrizketa ase dago hoberenean  Frogapena:  Bitez  * x  eta  * u  primalaren eta dualaren soluzio hoberenak, hurrenez hurren, honakoa beteko da:   '* * * * * * z b u x A u x c z t t t = ⋅ = ⋅ ⋅ = ⋅ = ,  eta  hemendik  honako  bi  berdintzak  erabiliko  ditugu:   * * * x A u x c t t ⋅ ⋅ = ⋅   alde batetik, eta  b u x A u t t ⋅ = ⋅ ⋅ * * *  bestetik.  •  * * * x A u x c t t ⋅ ⋅ = ⋅    ⇒    ( ) 0 * * = ⋅ ⋅ − x A u c t t  , eta biderkadura matrizial hau garatuko bagenu:  ( ) ( ( ) ( 0 * * ... * ... * * ... * 1 1 1 1 11 1 1 = ⋅ ⋅ + + ⋅ − + + ⋅ ⋅ + + ⋅ − n mn m n n m m x a u a u c x a u a u c   Murrizketa  dual  bakoitza  ( ) ( 0 * ... * 1 1 ≤ ⋅ + + ⋅ − mj m j j a u a u c   izango  da,  eta  aldagai  primal  bakoitza  0 * ≥ j x   ( n j ,..., 1 = ∀ ),  beraz,  baturak  zero  eman  dezan,  batugai  guztiek  zero  balio  behar dute:   o   Murrizketa  bat  ase  gabe  badago  dualean,  edo  beste  modu  batez  esanda,  forma  estandarrean  lasaitze-aldagaiaren  balio  hoberena  positiboa  bada,  ( ) ( 0 * ... * 1 1 < ⋅ + + ⋅ − mj m j j a u a u c , dagokion aldagai primalak  0 * = j x  bete beharko du.  o   Arrazoi beragatik, aldagai primal baten balio hoberena hertsiki positiboa bada:   0 * > j x ,  orduan dualean dagokion murrizketak  ( ) ( 0 * ... * 1 1 = ⋅ + + ⋅ − mj m j j a u a u c  balio beharko  du  (ase  egon,  edo  programa  estandarrean,  lasaitze- aldagaiaren  balio  hoberena  zero  izan).  •  b u x A u t t ⋅ = ⋅ ⋅ * * *    ⇒    ( ) 0 * * = − ⋅ ⋅ b x A u t  beteko da, eta emaitza hau garatuz:  ( ) ( ) ( ) ( ) 0 * ... * * ... * ... * * 1 1 1 1 1 11 1 = − ⋅ + + ⋅ ⋅ + + − ⋅ + + ⋅ ⋅ m n mn m m n n b x a x a u b x a x a u    Donostiako Enpresa-ikasketen Unibertsitate- Eskola                        ENPRESARAKO MATEMATIKAK II  Murrizketa  primal  bakoitza  ( ) ( ) 0 * ... * 1 1 1 ≤ − ⋅ + + ⋅ b x a x a n in i   izango  da,  eta  aldagai  dual  bakoitza  0 * ≥ i u   ( m i ,..., 1 = ∀ ),  beraz,  baturak  zero  eman  dezan,  batugai  guztiek  zero  balio  beharko dute:   o   Murrizketa bat ase gabe badago primalean  ( ) ( ) 0 * ... * 1 1 < − ⋅ + + ⋅ i n in i b x a x a , dagokion  aldagai dualak  0 * = i u  bete beharko du.   o   Era berean, aldagai dual baten balio hoberena hertsiki positiboa bada:  0 * > i u , orduan  primalean dagokion murrizketak  ( ) ( ) 0 * ... * 1 1 = − ⋅ + + ⋅ i n in i b x a x a  bete beharko du (ase  egon, edo forma estandarreko lasaitze-aldagaia nulua izan).    Emaitza  hau  erabiliz,  primalaren   (edo  dualaren)  soluzioa  ezagututa,  bestearen  soluzioa  aurki  dezakegu.    Dualaren soluzioaren esanahi ekonomikoa:   Hoberenean  '* * * * * * z b u x A u x c z t t t = ⋅ = ⋅ ⋅ = ⋅ =  egiaztatzen denez:  * * z u b ∂ = ∂     ⇒     * * i i z u b ∂ = ∂ ,  hau  da,  i-garren  aldagai  dualaren  balio  hoberenak  adierazten  digu  helburu-funtzioaren  aldaketa-tasa   (egoera  hoberenean),  bi  aldatzen  denean  (i.  murrizketaren  baldintza aldatzen denean).  Programa primala mozkinak maximizatzeko ariketa bat bada, hainbat murrizketa teknikori lotuta,  aldagai  dualek  adierazten  dute  murrizketa  tekniko  horiek  baldintzatzen  duten  prozesuetako  baliabideen  prezio  ezkutuak   (aukera  kostu  moduan  ere  azter  daitezkeenak,  edo  sarrera  marjinal  gisa).  Programa  kostuak  minimizatzeko  ariketa  izanik,  eskakizun  minimo  batzuk  hornitu  behar  direnean,  aldagai  dualen  balio  hoberenek  adierazten  dute  eskakizun  horietako  bakoitzaren  kostu  marjinalak.    6.- Ariketen ebazpena Lindo programa informatikoaren bidez  Programa  linealak  ebazteko  Simplex  metodoaz  gain,  antzeko  algoritmoek  erabiltzen  dituzte  hainbat  programa  informatikok,  esaterako,  Lindo  izenekoak   (Linear  Interactive  aNd  Discrete  Optimizer). Tamaina handiko ariketak ebazteko oso erabilgarria da.  Bertan, helburu- funtzioaren eta murrizketen koefizienteak sartu behar dira, eta programak soluzio  hoberena kalkulatzen du, hala nola programa dualaren soluzioa (lasaitze- aldagaien balioak barne).   
