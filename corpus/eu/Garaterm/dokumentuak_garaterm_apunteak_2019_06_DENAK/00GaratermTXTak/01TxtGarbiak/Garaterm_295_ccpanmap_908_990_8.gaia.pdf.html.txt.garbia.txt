   8.GAIA. ERREGRESIOA ETA KORRELAZIOA 1. Aldagai estatistiko bidimentsionalak. 1.1. Datuen antolaketa sarrera biko taula batean. 1.2. Bazter-banaketak. 1.3. Banaketa baldintzatuak. 1.4. Momentuak. 1.5. Adierazpide graﬁkoak. 2. Erregresioa. 2.1. Sarrera. 2.2. (x1, y1), (x2, y2), ..., (xn, yn) notazioa. 2.3. Erregresio lineala. 2.3.1. X-ren gaineko Y-ren erregresio-zuzena. 2.3.2. Y-ren gaineko X-ren erregresio-zuzena. 2.3.3. Erregresio-koeﬁzienteak. 2.4. Erregresio parabolikoa. 2.4.1. X-ren gaineko Y-ren erregresio parabolikoa. 2.4.2. Y-ren gaineko X-ren erregresio parabolikoa. 2.5. Erregresio esponentziala. 3. Korrelazioa. 3.1. Mugatze-koeﬁzientea edo determinazio-koeﬁzientea. 3.2. Korrelazio-koeﬁziente lineala. 3.2.1. Erregresio-koeﬁzienteen eta korrelazio-koeﬁziente linealaren arteko erlazioa. 3.2.2. Korrelazio zuzena eta alderantzizko korrelazioa. 3.2.3. korrelazio-koeﬁziente linealaren interpretazioa. 1  8.GAIA. ERREGRESIOA ETA KORRELAZIOA 1. ALDAGAI ESTATISTIKO BIDIMENTSIONALAK Lehenengo gaian aldagai bakar bat kontsideratu dugu. Hau da, ikusi ditugun fenomenoe- tan indibiduo bakoitzari aldagai estatistiko baten neurketa bat besterik ez diogu egin, baina populazio batean bi aldagai estatistiko desberdin batera kontsidera ditzakegu. Argi dago populazio baten banaketa X aldagaiaren edo Y aldagaiaren arabera aztertu deza- kegula eta horrela emandako informazioa ¯ x, ¯ y, σx, σy kalkulatuz laburtu dezakegula. Baina askotan interesgarria izan daiteke bi aldagaiak batera kontsideratzea bien arteko erlazio po- sibleak lortzeko. Gai honetan bi aldagai batera aztertuko ditugu, lagineko indibiduo bakoitzari bi neurketa egi- nez, bakoitza aldagai estatistiko bati dagokiona, eta balio- bikoteak lortuz. Adibidez, pertsona baten pisua eta adina neurtuz. Bi aldagai hauen modalitateek har ditzaketen balio desberdinek bikote multzo bat eratzen dute,  (X, Y ) ikurraren bidez adieraziko dugu eta aldagai estatistiko bidimentsionala esango diogu. 1.1. DATUEN ANTOLAKETA SARRERA BIKO TAULA BATEAN Suposa dezagun N indibiduoz osatutako lagin bat non X aldagai estatistikoak x1, x2, ..., xk balio desberdinak hartzen dituen eta Y beste aldagaiak y1, y2, ..., yp balio desberdinak. Or- duan (X, Y ) aldagai bidimentsionalak lagineko indibiduo bakoitzean balio- bikote bat hartzen du: (xi, yj) non i = 1, ..., k eta j = 1, ..., p diren. Datuak sarrera biko taula batean ordenatuko ditugu, non X aldagaiaren k balio desberdinak eta Y aldagaiaren p balio desberdinak agertzen diren. 2  X Y y1 y2 · · · yj · · · yp nx i x1 n11 n12 · · · n1j · · · n1p nx 1 x2 n21 n22 · · · n2j · · · n2p nx 2 .. . .. . .. . .. . .. . .. . xi ni1 ni2 · · · nij · · · nip nx i .. . .. . .. . .. . .. . .. . xk nk1 nk2 · · · nkj · · · nkp nx k ny j ny 1 ny 2 · · · ny j · · · ny p N nij : (xi, yj) balio-bikotearen maiztasun absolutua da eta laginean  (xi, yj) balio-bikotea hartzen duten indibiduoen kopurua da. Maiztasun absolutuen batura lagineko indibiduoen kopurua dela betetzen da k i=1 p j=1 nij = N. fij : (xi, yj) balio-bikotearen maiztasun erlatiboa da eta fij = nij N deﬁnitzen da. Maiztasun erlatiboen batura unitatea dela betetzen da k i=1 p j=1 fij = k i=1 p j=1 nij N = 1 N k i=1 p j=1 nij = N N = 1. 1.2. BAZTER-BANAKETAK Bazter- maiztasunen esangura bereziki azpimarratzea komeni zaigu. Ikus dezagun nola maiztasun absolutuen kopuruetatik  (aldagai bidimentsionalari dagozkionak), batuketa batzuk eginez, bazter- maiztasunen banaketak lortzen ditugun. Hau da, errenkadak batuz, aldagai batenak, eta zutabeak batuz, beste aldagaiarenak. Ohargarria da bazter- maiztasunen banaketak maiztasun bakunen banaketa batzuk beste- rik ez direla. Horrela, X aldagaiaren bazter- banaketa lortzeko, laginean xi balio bakoitza zenbat aldiz errepikatzen den jakin behar dugu, Y aldagaiaren balioak kontuan hartu gabe. Adibidez, x1 balioa hartzen duten indibiduoen kopurua, Y - ren balioak kontuan hartu gabe, ondokoa 3  izango da nx 1 = n11 + n12 + · · · + n1j + · · · + n1p = p j=1 n1j eta x1 balioaren bazter-maiztasun absolutua esango diogu. Orokorrean, xi balioaren bazter- maiztasun absolutua laginean xi balioa hartzen duten indibiduoen kopurua da eta sinbolikoki nx i ikurraren bidez adieraziko dugu nx i = ni1 + ni2 + · · · + nij + · · · + nip = p j=1 nij. Modu berean, Y aldagaiaren bazter- banaketa lortzeko, laginean yj balio bakoitza zenbat aldiz errepikatzen den jakin behar dugu, X aldagaiaren balioak kontuan hartu gabe. Adibidez, y1 balioa hartzen duten indibiduoen kopurua, X- ren balioak kontuan hartu gabe, ondokoa izango da ny 1 = n11 + n21 + · · · + ni1 + · · · + nk1 = k i=1 ni1 eta y1 balioaren bazter-maiztasun absolutua esaten zaio. Orokorrean, yj balioaren bazter- maiztasun absolutua laginean yj balioa hartzen duten indibiduoen kopurua da eta sinbolikoki ny j ikurraz adieraziko dugu ny j = n1j + n2j + · · · + nij + · · · + nkj = k i=1 nij. Beraz, taularen azken errenkadan eta azken zutabean bazter- maiztasun absolutuak agertzen dira. Maiztasunen bazter-banaketak ondokoak dira X Y xi nx i fx i x1 nx 1 nx 1 /N x2 nx 2 nx 2 /N .. . .. . .. . xi nx i nx i /N .. . .. . .. . xk nx k nx k /N yj ny j fy j y1 ny 1 ny 1 /N y2 ny 2 ny 2 /N .. . .. . .. . yj ny j ny j /N .. . .. . .. . yp ny p ny p /N 4  k i=1 nx i = p j=1 ny j = k i=1 p j=1 nij = N betetzen dela nabaria da. X eta Y aldagaien bazter- maiztasunak kontsideratuz, beraien batezbestekoak, bariantzak eta lehenengo gaian deﬁnitutako estatistiko guztiak deﬁni ditzakegu . ¯ x = k i=1 xinx i N ¯ y = p j=1 yjny j N (BAZTER-BATEZBESTEKOAK) σ 2 x = k i=1 (xi − ¯ x) 2n xi N σ 2 y = p j=1 (yj − ¯ y) 2n yj N (BAZTER-BARIANTZAK). Bestalde, k i=1 p j=1 xinij = k i=1 xinx i berdintza betetzen da, honako hau betetzen baita k i=1 p j=1 xinij = k i=1 (xini1 + xini2 + · · · + xinip) = k i=1 xi(ni1 + ni2 + · · · + nip) = k i=1 xinx i . Eta k i=1 p j=1 yjnij = k i=1 yjny j berdintza betetzen da, hurrengoa betetzen baita k i=1 p j=1 yjnij = p j=1 k i=1 yjnij = p j=1 (yjn1j+yjn2j+· · ·+yjnkj) = p j=1 yj(n1j+n2j+· · ·+nkj) = p j=1 yjny j . 1.3. BANAKETA BALDINTZATUAK (X, Y ) aldagai estatistiko bidimentsional baten banaketaren kasuan, Y aldagaiak y2 balioa hartzen badu, X aldagaiaren maiztasun- banaketa kontsidera daiteke. Banaketa berri honi, y2 balioak baldintzatutako X aldagaiaren banaketa esaten zaio eta X/ Y = y2 ikurraren bidez adierazten da. X/ Y = y2 aldagaiak x1, x2, ..., xi, ..., xk balioak hartzen ditu eta balio hauen 5  maiztasunak n12, n22, ..., ni2, ..., nk2 dira. Y aldagaiaren y2 balioak baldintzatutako X aldagaiaren maiztasun-banaketa X/Y = y2 n(X/Y = y2) f (X/Y = y2) x1 n12 n12/ny 2 x2 n22 n22/ny 2 .. . .. . .. . xi ni2 ni2/ny 2 .. . .. . .. . xk nk2 nk2/ny 2 Y aldagaiak hartzen dituen balio guztiak kontsideratuz, beste hainbeste X aldagaiaren banaketa baldintzatu edukiko ditugu. Orokorrean, yj balioak baldintzatutako X aldagaiaren maiztasun- banaketa ondokoa da X/Y = yj n(X/Y = yj) f (X/Y = yj) x1 n1j n1j/ny j x2 n2j n2j/ny j .. . .. . .. . xi nij nij/ny j .. . .. . .. . xk nkj nkj/ny j Modu berean, xi balioak baldintzatutako Y aldagaiaren maiztasun- banaketa ondokoa izan- go da 6  Y/X = xi n(Y/X = xi) f (Y/X = xi) y1 ni1 ni1/nx i y2 ni2 ni2/nx i .. . .. . .. . yj nij nij/nx i .. . .. . .. . yp nip nip/nx i 1.4. MOMENTUAK (p, q) balio-bikotearekiko r eta s ordenetako momentua honela deﬁnitzen da: Mr,s(p, q) = k i=1 p j=1 (xi − p) r (y j − q) sn ij N . • Jatorriarekiko momentuak. p = 0 eta q = 0 balioekiko momentuak dira. Jatorriarekiko r eta s ordenetako momentua honela deﬁnitzen da: ar,s = k i=1 p j=1 x r i y s j nij N . • Batezbestekoekiko momentuak edo momentu zentralak. p = ¯ x eta q = ¯ y balioekiko momentuak dira. Batezbestekoekiko r eta s ordenetako momentua honela deﬁnitzen da: mr,s = k i=1 p j=1 (xi − ¯ x) r (y j − ¯ y) sn ij N . • Momentu partikularrak. Geroko interesgarriak izango diren momentu partikular batzuk aipatuko ditugu a00 = k i=1 p j=1 x 0 i y 0 j nij N = k i=1 p j=1 nij N = N N = 1, 7  a10 = k i=1 p j=1 x 1 i y 0 j nij N = k i=1 p j=1 xinij N = k i=1 xinx i N = ¯ x, a01 = k i=1 p j=1 x 0 i y 1 j nij N = k i=1 p j=1 yjnij N = p j=1 yj k i=1 nij N = p j=1 yjny j N = ¯ y, a11 = k i=1 p j=1 xi yj nij N , a20 = k i=1 p j=1 x 2 i y 0 j nij N = k i=1 p j=1 x 2 i nij N = k i=1 x 2 i p j=1 nij N = k i=1 x 2 i nxi N . X aldagaiaren bazter-banaketa kontsideratuz, a20 X- ren bigarren ordenako jatorriare- kiko momentua da. a02 = k i=1 p j=1 x 0 i y 2 j nij N = k i=1 p j=1 y 2 j nij N = p j=1 y 2 j k i=1 nij N = p j=1 y 2 j nyj N . Y aldagaiaren bazter-banaketa kontsideratuz, a02 Y - ren bigarren ordenako jatorriare- kiko momentua da. m10 = k i=1 p j=1 (xi − ¯ x) 1(y j − ¯ y) 0n ij N = k i=1 p j=1 (xi − ¯ x)nij N = = k i=1 p j=1 xinij N − ¯ x k i=1 p j=1 nij N = k i=1 xinx i N − ¯ x N N = ¯ x − ¯ x = 0. Era berean, m01 = 0 berdintza betetzen dela froga dezakegu. 8  m11 = k i=1 p j=1 (xi − ¯ x)(yj − ¯ y)nij N KOBARIANTZA, m20 = k i=1 p j=1 (xi − ¯ x) 2(y j − ¯ y) 0n ij N = k i=1 p j=1 (xi − ¯ x) 2n ij N = = k i=1 (xi − ¯ x) 2 p j=1 nij N = k i=1 (xi − ¯ x) 2n xi N = σ 2 x, m02 = k i=1 p j=1 (xi − ¯ x) 0(y j − ¯ y) 2n ij N = k i=1 p j=1 (yj − ¯ y) 2n ij N = = p j=1 (yj − ¯ y) 2 k i=1 nij N = p j=1 (yj − ¯ y) 2n yj N = σ 2 y . Beraz, m20 eta m02 momentuak X eta Y aldagaien bariantzak dira, hurrenez hurren. Banaketa bakunetan gertatzen den bezala, banaketa bidimentsionaletan ere momen- tu zentratuak eta jatorriarekiko momentuak erlazionatzen dituzten erlazioak existitzen dira. Ondoko erlazioak betetzen dira: m11 = a11 − ¯ x ¯ y, m20 = σ 2 x = a20 − ¯ x 2, m02 = σ 2 y = a02 − ¯ y 2. 1.5. ADIERAZPIDE GRAFIKOAK Aldagai estatistiko bidimentsional baten maiztasun- banaketa ikusarazteko bi adierazpide graﬁko ditugu, sakabanatze-diagrama edo puntu-hodeia eta maiztasun-diagrama. 9  • Sakabanatze-diagrama edo puntu-hodeia. (X, Y ) aldagai estatistiko bidimentsionalaren balio desberdinak ardatz cartesiarreko sis- tema batean adierazten dira. Abzisa- ardatzean X aldagaiaren balioak adierazten dira eta ordenatu-ardatzean Y -renak, honela balio- bikote bakoitza XY planoko puntu baten bidez adierazita dago. Bi aldagaiak tartetan elkartuta badaude, diagrama laukien bidez lortuko dugu non lauki bakoitzean dagoen puntu-kopurua  (X, Y ) aldagaiaren tarteari dagokion maiztasun absolutua den. Aldagai bat tartetan elkartuta badago eta bestea ez, orduan tarte- ordezkariekin egingo dugu lana eta hasieran aipatutako diagrama lortuko dugu. E T q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q xi yj X Y E T q qqq q q q q X Y • Maiztasun-diagrama. Sakabanatze-diagrama batean balio- bikote bat zenbat aldiz errepikatzen den ez da oso argi ikusten. Kasu honetan, (X, Y )- ren hiru dimentsiotako adierazpide bat erabil deza- kegu. Bi dimentsio aldagai bidimentsionalarentzat dira eta dimentsio bat maiztasunak adierazteko. E T                 ©                                           nij X Y n 10  2. ERREGRESIOA 2.1. SARRERA Bi edo aldagai gehiago aztertzen dituen analisi estatistiko baten aurrean, horien elkar aldaketa oso garrantzitsua da. Zentzu honetan bi dependentzia mota kontsidera ditzakegu: dependentzia funtzionala eta dependentzia aleatorioa  (edo zorizko dependentzia). X eta Y aldagaiak erlazionatzen dituen funtzio matematiko bat existitzen denean, al- dagaien artean dependentzia funtzionala dagoela esango dugu. Adibidez, zirkunferentziaz osatutako lagin batean X erradioak eta Y luzerak neurtzen baditugu, badakigu X- en balioa ezagutuz gero Y - ren balioa ezagutu dezakegula, bi aldagaiak Y = 2π X adierazpenaren bidez lotuta baitaude. Aldiz, X eta Y aldagaiak lotzen dituen erlazio matematikorik existitzen ez bada X eta Y aldagaien artean zorizko dependentzia dagoela esango dugu. Adibidez, hiru eta hamabost urte bitarteko umez osatutako lagin batean X adina eta Y pisua neurtzen baditugu, ezin dugu X eta Y zehazki erlazionatzen dituen inolako adierazpen matematikorik lortu. Badira, hala ere, inolako dependentziarik ez duten aldagaiak, emandako kontzeptuak osa- garriak ez baitira. (X, Y ) aldagai estatistiko bidimentsionalaren balioak sakabanatze- diagrama edo puntu- hodei batean adieraz ditzakegu. X eta Y bi aldagai estatistikoen puntu- hodeiaren arabera beraien artean Y = f  (X) moduko erlazio funtzional bat dagoela pentsa dezakegu, horrela, X aldagai independentea edo azaltzailea izango litzateke eta Y , berriz, aldagai dependentea edo azaldua. Puntu-hodeiaren itxuraren arabera f  (X) funtzio bat edo beste aukeratuko dugu. 11  Aipatutako funtzio matematikoa hauetako bat izan daiteke: y = a + bx Zuzena y = kabx Esponentziala a > 0 y = a + bx + cx2 Parabola y = a + bx + cx2 + dx3 Kubikoa y = a + bx + · · · + lxn Polinomikoa y = 1 a + bx Hiperbola Erregresioaren helburua aldagai baten bidez bestea aurresateko posibilitatea lortzea da. Hau da, puntu- hodeiari funtzio matematiko ezagun bat doitu. Horrela, zuzen bat denean erregresio lineala izango dugu, parabola bat denean erregresio parabolikoa, eta abar. E T q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q 4 4 4 4 4 4 4 4 4 4 4 4 q q q q q q q q q q q q q q q q q q q q q q q q qq qq q q q q q q q q q q q q X Y E T q q q q q q q q q q q q q q q q qq qq q q q q q q q q q q q q q q q q q q q X Y E T q q q q q q q q q q q q q q q q q q q 4 4 4 4 4 4 q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q X Y Funtzioa aukeratu ondoren, dagozkion parametroak estimatu behar ditugu. Adibidez, funtzioa y = a + bx + cx2 modukoa baldin bada, orduan a, b eta c parametroak estimatu behar ditugu. 12  2.2. (x1, y1), (x2, y2), · · · , (xN , yN ) NOTAZIOA Kontsidera dezagun 7 indibiduoz osatutako lagin bat. Suposa dezagun lagin horretan X eta Y aldagaiak aztertzen ari garela eta lortutako emaitzak ondokoak direla: X 2 2 1 3 4 1 1 Y 3 4 6 5 5 2 2 Orain arte datu horiek adierazteko sarrera biko taulak erabili ditugu eta horrela egin dugu: X aldagai estatistikoak x1 = 1, x2 = 2, x3 = 3, x4 = 4 balioak hartzen ditu eta Y aldagai estatistikoak y1 = 2, y2 = 3, y3 = 4, y4 = 5, y5 = 6 balioak. (xi, yj) (i = 1, 2, 3, 4 eta j = 1, 2, 3, 4, 5) balio- bikote bakoitzaren maiztasuna kalkulatu ondoren, taula honela geratzen da: X Y y1 = 2 y2 = 3 y3 = 4 y4 = 5 y5 = 6 nx i x1 = 1 2 0 0 0 1 3 x2 = 2 0 1 1 0 0 2 x3 = 3 0 0 0 1 0 1 x4 = 4 0 0 0 1 0 1 ny j 2 1 1 1 1 7 ¯ x = 4 i=1 xinx i N = 2; a11 = 4 i=1 5 j=1 xi yj nij N = 59 7 ; · · · Baina erregresioa aztertzeko, datuak beste modu honetan adieraziko ditugu: X x1 = 2 x2 = 2 x3 = 1 x4 = 3 x5 = 4 x6 = 1 x7 = 1 Y y1 = 3 y2 = 4 y3 = 6 y4 = 5 y5 = 5 y6 = 2 y7 = 2 Orduan,  (X, Y ) aldagai estatistiko bidimentsionalak lagineko indibiduo bakoitzean balio- bikote bat hartzen du: (x1, y1), (x2, y2), (x3, y3), (x4, y4), (x5, y5), (x6, y6), (x7, y7) edo (xi, yi) i = 1, 2, · · · , 7. 13  Horrela balio- bikote bakoitza behin bakarrik agertzen dela suposatzen dugu eta balio- bikote bakoitzaren maiztasuna 1 da. Estatistiko desberdinak horrela lortuko ditugu: ¯ x = N i=1 xi N = 2 + 2 + 1 + 3 + 4 + 1 + 1 7 a11 = N i=1 xi yi N = 2 × 3 + 2 × 4 + 1 × 6 + 3 × 5 + 4 × 5 + 1 × 2 + 1 × 2 7 , . . . Balio berdinak lortzen ditugu lehenengo notazioa edo bigarrena erabiliz. Bi notazioak al- dagai estatistiko bidimentsional baten datuak adierazteko bi modu desberdin besterik ez dira. Orokortuz. Suposa dezagun N indibiduoz osatutako lagin batean X eta Y aldagaiak aztertzen ari garela. Orduan,  (X, Y ) aldagai estatistiko bidimentsionalak lagineko indibiduo bakoitzean balio-bikote bat hartzen du. Hots, (x1, y1), (x2, y2), · · · , (xN , yN ) edo (xi, yi) i = 1, 2, · · · , N . Beste modu bat: X aldagai estatistikoak x1, x2, · · · , xk balio desberdinak hartzen ditu. Y aldagai estatistikoak y1, y2, · · · , yp balio desberdinak hartzen ditu. Orduan, datuak sarrera biko taula batean adieraz ditzakegu: X Y y1 y2 · · · yj · · · yp x1 n11 n12 · · · n1j · · · n1p x2 n21 n22 · · · n2j · · · n2p .. . .. . .. . .. . .. . xi ni1 ni2 · · · nij · · · nip .. . .. . .. . .. . .. . xk nk1 nk2 · · · nkj · · · nkp non nij, laginean (xi, yj) balio-bikotea hartzen duten indibiduoen kopurua den. 14  2.3. ERREGRESIO LINEALA Erregresioa lineala izango da puntu- hodeiari doitzeko aukeratu dugun funtzio matemati- koa zuzen bat denean. 2.3.1. X-ren gaineko Y -ren erregresio-zuzena. Izan bedi (x1, y1), (x2, y2), · · · , (xN , yN ) puntu- hodeia. Izan bedi y = a + bx doikuntza egiteko aukeratutako funtzioa. a eta b parametroen balioak kalkulatu behar ditugu eta ho- rretarako karratu txikienen metodoa erabiliko dugu. X aldagaiaren xi balio bakoitzari Y -ren bi balio dagozkio: • puntu-hodeiko yi balio erreala (edo behatutako balioa). • y∗ i balio teorikoa  (edo estimatua). Puntu hau xi balioa y = a+bx zuzenean ordezkatuz lortzen dugun balioa da, hau da, y∗ i = a + bxi. y∗ i balio estimatuaren eta yi balio errealaren arteko diferentziari ERROREA edo HONDARRA deritzo eta ei izendatuko dugu, hots, ei = y ∗ i − yi, i = 1, 2, ..., N . E T 4 4 4 4 4 4 4 4 4 4 4 4 r } ei = y ∗ i − yi = a + bxi − yi xi y∗ i yi y = a + bx X Y Karratu txikienen metodoa erabiltzen dugunean erroreen karratuen batura minimoa egiten duten a eta b parametroak mugatu nahi ditugu. Beraz, a eta b kalkulatu behar ditugu non M = N i=1 e 2 i = N i=1 (y ∗ i − yi) 2 = N i=1 (a + bxi − yi) 2 minimoa den. M funtzioa minimoa izateko beharrezko baldintza a-rekiko eta b- rekiko deri- 15  batuak zero egitea da, hau da: ∂M ∂a = 0 ⇐⇒ 2 N i=1 (a + bxi − yi) = 0 ⇐⇒ a N i=1 1 + b N i=1 xi − N i=1 yi = 0 ⇐⇒ ⇐⇒ aN + bN ¯ x − N ¯ y = 0 ⇐⇒ ¯ y = a + b¯ x ∂M ∂b = 0 ⇐⇒ 2 N i=1 (a + bxi − yi)xi = 0 ⇐⇒ a N i=1 xi + b N i=1 x 2 i − N i=1 yixi = 0 ⇐⇒ ⇐⇒ aN ¯ x + bN a20 − N a11 = 0 ⇐⇒ a¯ x + b a20 − a11 = 0 a = ¯ y − b ¯ x bakanduz eta beste ekuazioan ordezkatuz, (¯ y − b ¯ x)¯ x + b a20 − a11 = 0 ⇐⇒ b(a20 − ¯ x 2) = a 11 − ¯ x¯ y ⇐⇒ b σ 2 x = m11 Beraz b = m11 σ2 x eta a = ¯ y − m11 σ2 x ¯ x. Lortu ditugun a eta b balioak y = a + bx ekuazioan ordezkatuz, ondokoa lortuko dugu: y = ¯ y − m11 σ2 x ¯ x + m11 σ2 x x, edo y − ¯ y = m11 σ2 x (x − ¯ x) X-ren gaineko Y -ren ERREGRESIO-ZUZENA da, eta m11 σ2 x balioari X-ren gaineko Y -ren erregresio-zuzenaren erregresio-koeﬁzientea esaten zaio. 2.3.2. Y -ren gaineko X-ren erregresio-zuzena. Izan bedi (x1, y1), (x2, y2), · · · , (xN , yN ) puntu- hodeia. Izan bedi x = a + by doikuntza egiteko aukeratutako funtzioa. a eta b parametroen balioak kalkulatu behar ditugu eta ho- rretarako karratu txikienen metodoa erabiliko dugu. Y aldagaiaren yi balio bakoitzari X-ren bi balio dagozkio: • puntu-hodeiko xi balio erreala (edo behatutako balioa). 16  • x∗ i balio teorikoa  (edo estimatua). Puntu hau yi balioa x = a + by zuzenean ordezkatuz lortzen dugun balioa da, hau da, x∗ i = a + byi. x∗ i balio estimatuaren eta xi balio errealaren arteko diferentziari ERROREA edo HONDARRA deritzo eta ei izendatuko dugu, hots, ei = x ∗ i − xi, i = 1, 2, ..., N . E T 4 4 4 4 4 4 4 4 4 4 4 4 r ei ei = x ∗ i − xi = a + byi − xi x∗ i = a + byi i = 1, 2, ..., N xi x ∗ i yi x = a + by X Y a eta b aurkitu behar ditugu non M = N i=1 e 2 i = N i=1 (x ∗ i − xi) 2 = N i=1 (a + byi − xi) 2 minimoa den. M minimoa izan dadin M -ren deribatuak a eta b- rekiko zero izatea beharrezko baldintza da. ∂M ∂a = 0 ⇐⇒ 2 N i=1 (a + byi − xi) = 0 ⇐⇒ ¯ x = a + b¯ y ∂M ∂b = 0 ⇐⇒ 2 N i=1 (a + byi − xi)yi = 0 ⇐⇒ a¯ y + b a02 − a11 = 0 a = ¯ x − b ¯ y bakanduz eta beste ekuazioan ordezkatuz (¯ x − b ¯ y)¯ y + b a02 − a11 = 0 ⇐⇒ b(a02 − ¯ y 2) = a 11 − ¯ x¯ y ⇐⇒ b σ 2 Y = m11. Beraz b = m11 σ2 y eta a = ¯ x − m11 σ2 y ¯ y. Lortutako a eta b balioak x = a+by ekuazioan ordezkatuz, Y -ren gaineko X- ren ERREGRESIO- ZUZENA lortuko dugu: x − ¯ x = m11 σ2 y (y − ¯ y) m11 σ2 y balioari, Y -ren gaineko X-ren erregresio-koeﬁzientea esaten zaio. 17  2.3.3. Erregresio-koeﬁzienteak. Erregresio-koeﬁziente linealak erregresio-zuzenen maldak dira. y − ¯ y = m11 σ2 x (x − ¯ x) βyx = m11 σ2 x x − ¯ x = m11 σ2 y (y − ¯ y) βxy = m11 σ2 y Bi erregresio-zuzenak (¯ x, ¯ y) puntuan ebakitzen dira, eta puntu honi banaketa bateratuaren grabitate-zentrua esaten zaio. βyx-ren zeinua, βxy-ren zeinua eta m11- ren zeinua berdinak direla betetzen da. Beraz, koba- riantza positiboa denean erregresio- koeﬁzienteak ere positiboak izango dira eta beraiei dagoz- kien erregresio- zuzenak gorakorrak. Modu berean, kobariantza negatiboa denean erregresio- koeﬁzienteak ere negatiboak izango dira eta beraiei dagozkien erregresio- zuzenak beherako- rrak. βyx = 0 eta βxy = 0 denean, erregresio- zuzenak koordenatu ardatzekiko paraleloak dira eta beraien artean perpendikularrak. E T 4 4 4 4 4 4 4 4 4 4 4 4 $$ $$ $$ $$ $$ $$ m11 > 0 ¯ x ¯ y E T                   m11 < 0 ¯ x ¯ y E T m11 = 0 ¯ x ¯ y 2.4. ERREGRESIO PARABOLIKOA 2.4.1. X-ren gaineko Y -ren erregresio parabolikoa. E T X Y y = a + bx + cx2 r } e i xi yi y∗ i y∗ i = a + bxi + cx 2 i ei = yi − y ∗ i , i = 1, 2, ..., N. 18  a, b eta c aurkitu behar ditugu M = N i=1 e 2 i = N i=1 (yi − y ∗ i ) 2 = N i=1 (yi − a − bxi − cx 2 i ) 2 minimoa izan dadin. ∂M ∂a = 0 ⇒ 2 N i=1 (yi − a − bxi − cx 2 i )(−1) = 0 ∂M ∂b = 0 ⇒ 2 N i=1 (yi − a − bxi − cx 2 i )(−xi) = 0 ∂M ∂c = 0 ⇒ 2 N i=1 (yi − a − bxi − cx 2 i )(−x 2 i ) = 0                      Ekuazio normalak 2.4.2. Y -ren gaineko X-ren erregresio parabolikoa. E T X Y x = a + by + cy2 r ei x∗ i yi xi x∗ i = a + byi + cy 2 i ei = xi − x ∗ i , i = 1, 2, ..., N. a, b eta c aurkitu behar ditugu M = N i=1 e 2 i = N i=1 (xi − x ∗ i ) 2 = N i=1 (xi − a − byi − cy 2 i ) 2 minimoa izan dadin. ∂M ∂a = 0 ⇒ 2 N i=1 (xi − a − byi − cy 2 i )(−1) = 0 ∂M ∂b = 0 ⇒ 2 N i=1 (xi − a − byi − cy 2 i )(−yi) = 0 ∂M ∂c = 0 ⇒ 2 N i=1 (xi − a − byi − cy 2 i )(−y 2 i ) = 0                      Ekuazio normalak 19  2.5. ERREGRESIO ESPONENTZIALA Esperimentu batzuetan, biologikoak gehienak, X eta Y aldagaien arteko dependentzia modu esponentzial batean doitzen da. Kasu hauetan puntu-hodeiari y = k abx  (k > 0 eta a > 0 ezaguna) funtzioa doitzea interesatzen zaigu. Beraz, k eta b determinatu behar diren parametroak dira. lg a y = lga ka bx ⇒ z = lg a k + bx lga a ⇒ z = α + bx . Modu honetan, gure problema erregresio linealeko problema bat bihurtu dugu. α eta b parametroak estimatu ondoren k-ren balioa k = aα eginez lortuko dugu. 3. KORRELAZIOA Erregresioaren arazoa lerro bat, zuzena ala kurba, puntu- hodei bati doitzea da; eta korre- lazioaren helburua doikuntza hori zenbateraino den ona determinatzea da. Aldagaien artean dagoen harreman-maila, behatutako yi balioen eta erregresio- lerroan lortutako y∗ i balioen arteko diferentzietatik ondorioztatzen da. Hauetariko diferentzia bakoitza nulua bada, lerroa puntu guztietatik pasatzen da eta, ondorioz, X eta Y aldagai estatistikoen artean dependentzia funtzional bat dago eta doikuntza osoa da. Diferentzia hauek txikiak direnean, doikuntza ona da eta lerroa oso adierazgarria da; aldiz, diferentziak handiak badira, doikuntza ez da ona. Beraz, dependentzia neurtzeko ei = y ∗ i − yi erroreak erabiliko ditugu, i = 1, 2, ..., N . 3.1. MUGATZE-KOEFIZIENTEA EDO DETERMINAZIO-KOEFIZIENTEA Erroreak konpentsatu ez daitezen erroreen karratuak erabiliko ditugu. Erroreen karratuen batezbestekoari, hondar bariantza deritzo. Beraz, σ 2 e = 1 N N i=1 e 2 i = N i=1 (y ∗ i − yi) 2. 20  Hondar bariantzak balio teoriko eta behatuen arteko desbideratzeak neurtzen ditu. Ba- riantza hau handia bada, erroreak, batez bestekoz, handiak izango dira, puntuak funtziotik urrun egongo dira eta dependentzia txikia izango da. Eta, berdin arrazoituz, hondar bariantza txikia bada, dependentzia sakona izango da. Hondar bariantzak gure helburuak bete ditzake, baina arazoa neurri- unitateek aurkezten dute. Horregatik, mugatze-koeﬁzientea deﬁnituko dugu. R 2 = 1 − σ2 e σ2 y 0 ≤ R2 ≤ 1 betetzen da. 3.2. KORRELAZIO-KOEFIZIENTE LINEALA Koeﬁziente honek X eta Y aldagaien artean dagoen erlazio linealaren maila neurtzen du, eta honela deﬁnitzen da: ρ = m11 σxσy . Kasu linealean R2 = ρ2 betetzen da. 0 ≤ R2 ≤ 1 betetzen denez, orduan −1 ≤ ρ ≤ 1 betetzen da. 3.2.1. Erregresio-koeﬁzienteen eta ρ korrelazio-koeﬁziente linealaren arteko erlazioa. βyx = m11 σ2 x ⇒ m11 = βyx σ2 x ρ = m11 σxσy ⇒ m11 = ρ σxσy      ⇒ βyx σ 2 x = ρ σxσy ⇒ βyx = ρ σy σx . βxy = m11 σ2 y ⇒ m11 = βxy σ2 y ρ = m11 σxσy ⇒ m11 = ρ σxσy        ⇒ βxy σ 2 y = ρ σxσy ⇒ βxy = ρ σx σy . Bestalde, βyxβxy = ρ σy σx ρ σx σy = ρ 2 ⇒ ρ 2 = β yxβxy . 21  3.2.2. Korrelazio zuzena eta alderantzizko korrelazioa. ρ > 0 ⇔ βyx > 0 ⇔ βxy > 0 Korrelazio zuzena edo korrelazio positiboa ρ < 0 ⇔ βyx < 0 ⇔ βxy < 0 Alderantzizko korrelazioa edo korrelazio negatiboa 3.2.3. ρ korrelazio-koeﬁziente linealaren interpretazioa. ρ = 1. Dependentzia funtzionala. Korrelazio zuzena. Hodeiko puntu guztiak zuzenaren gainean daude eta doikuntza osoa dela esango dugu. Kasu honetan, bi erregresio- zuzenek bat egiten dute eta zuzen hau gorakorra da, bere malda positiboa baita. ρ = −1. Dependentzia funtzionala. Alderantzizko korrelazioa. Doikuntza osoa da, bai- na negatiboa. Kasu honetan bi erregresio- zuzenek bat egiten dute eta zuzen hau beherakorra da, bere malda negatiboa delako. ρ = 0. Zero-korrelazioa edo zeroko korrelazioa. Bi erregresio- zuzenak elkartzutak dira, eta ondokoak dira: y − y = 0, x − x = 0. −1 < ρ < 0. Dependentzia aleatoria edo zorizko dependentzia. Korrelazioa negatiboa da eta erregresio-zuzenak, desberdinak eta beherakorrak izango dira. 0 < ρ < 1. Dependentzia aleatoria edo zorizko dependentzia. Korrelazioa positiboa da eta erregresio-zuzenak, desberdinak eta gorakorrak izango dira. 22
