   3. Kapitulua Dualtasuna Programazio linealaren teoriaren garapenean, dualtasuna kontzepturik garrantzi- tsuenetarikoa da, bai teorikoki eta bai ikuspuntu praktikotik ere. Eredu lineal bat izanik, dagokion eredu duala idatzi ahal izango da beti. Ikusiko dugun bezala, bi ereduetako bat ebatziz bietarako soluzioa lortuko da, ebatzitako ereduaren taula optimoan dagokion eredu dualaren soluzio optimoa ere agertuko baita. Dualtasu- na kontuan hartzea komenigarria da; hona hemen arrazoi batzuk. 1. Simplex algoritmoaren iterazio kopurua eredu linealak duen aldagai kopu- ruaren mende baino murrizketen mende dagoela kontuan izanik, eta eredu lineal bat ebazterakoan dagokion eredu dualaren soluzio optimoa ere lor- tuko denez, ereduen artean ebatzia izango dena aukera daiteke bietarako soluzioa lortzeko. 2. Dualtasunak problema linealaren interpretazio ekonomikoa ahalbidetzen du. Ikusiko dugun bezala, eredu dualaren soluzioak eredu primalaren soluzioari buruzko informazioa ematen du. 3. Dualtasunaren propietateak kontuan hartuz, algoritmo berri bat sortu da, simplex dual algoritmoa, zenbait eredu lineal ebazteko simplex algoritmoa baino eraginkorragoa dena. Gainera, algoritmo berri hori erabiliko da aurre- rago aztertuko ditugun sentikortasunaren analisian eta programazio osoan. 3.1 Problema duala 3.1.1 Deﬁnizioa. (Maximizatze-forma simetrikoa) Eredu lineala maximizatze- forma simetrikoan dagoela esaten da baldin 87  88 3. Dualtasuna • Helburua maximizatzea bada • Murrizketa guztiak ≤ modukoak badira • Aldagai guztiak ez-negatiboak badira Adibidea. Ondoko eredua maximizatze-forma simetrikoan idatziko dugu: max z = x1 − 3x2 + x3 hauen mende x1 + x2 + x3 ≥ 2 −x1 + 2x2 − x3 ≤ 3 x1 − x2 + 2x3 = −1 x1, x2, x3 ≥ 0 Maximizatze-forma simetrikoa honakoa da: max z = x1 − 3x2 + x3 hauen mende −x1 − x2 − x3 ≤ −2 −x1 + 2x2 − x3 ≤ 3 x1 − x2 + 2x3 ≤ −1 −x1 + x2 − 2x3 ≤ 1 x1, x2, x3 ≥ 0 2 3.1.2 Deﬁnizioa. (Minimizatze-forma simetrikoa) Eredu lineala minimizatze- forma simetrikoan dagoela esaten da baldin • Helburua minimizatzea bada • Murrizketa guztiak ≥ modukoak badira • Aldagai guztiak ez-negatiboak badira OpenCourseWare, UPV/EHU  3.1. Problema duala 89 Adibidea. Har dezagun honako eredu lineala: max z = x1 − x2 hauen mende 3x1 + 2x2 ≤ 1 x1 − 2x2 ≥ 3 x1, x2 ≥ 0 Minimizatze-forma simetrikoa honakoa da: min (−z) = −x1 + x2 hauen mende −3x1 − 2x2 ≥ −1 x1 − 2x2 ≥ 3 x1, x2 ≥ 0 2 3.1.1 Primal-dual erlazioa Har dezagun maximizatze-forma simetrikoan dagoen eredu lineala. max z = c T x hauen mende Ax ≤ b x ≥ 0 Eredu horri primal deituko diogu. Bere duala minimizatze-forma simetrikoan dagoen ondoko eredu lineala da: min G = b T y hauen mende A T y ≥ c y ≥ 0 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  90 3. Dualtasuna Adibidea. Har dezagun honako eredu lineala. max z = 2x1 − x2 + 3x3 hauen mende x1 − x2 + x3 ≤ 2 3x1 − x2 + 2x3 ≤ 1 x1, x2, x3 ≥ 0 Dagokion eredu duala honakoa da: min G = 2y1 + y2 hauen mende y1 + 3y2 ≥ 2 −y1 − y2 ≥ −1 y1 + 2y2 ≥ 3 y1, y2 ≥ 0 2 3.1.2 Eredu primalaren eta dualaren osagaiak Eredu lineal bat, primala, eta dagokion eredu duala izanik, bi eredu horien osa- gaien artean ondoko erlazioa dago. • Eredu primalaren A matrizea m × n tamainakoa bada, eredu primalak m murrizketa eta n aldagai ditu. Eredu dualaren koeﬁziente teknologikoen matrizea A T da, eta ondorioz, eredu dualak n murrizketa eta m aldagai izango ditu. • b bektorea problema primalaren baliabide-bektorea da eta problema duala- ren kostuen bektorea. • c bektorea problema primalaren kostu-bektorea da eta problema dualaren baliabide-bektorea. • Problema primalak duen murrizketa kopurua eta problema dualak duen al- dagai kopurua berdinak dira. • Problema primalak duen aldagai kopurua eta problema dualak duen murriz- keta kopurua berdinak dira. OpenCourseWare, UPV/EHU  3.1. Problema duala 91 3.1.3 Dualtasuna. Kasu orokorra Oro har, ereduaren murrizketak ≤, = edo ≥ modukoak izan daitezke. Dagokion eredu duala kalkulatzeko, eredua forma simetrikoan idatzi eta primal-dual erla- zioa erabil daiteke. Dena den, forma simetrikoan idatzi gabe 3.1. Taula erabiliz, kalkula daiteke maximizatze-forma simetrikoan ez dagoen eredu baten duala. Helburu funtzioa: max ⇐⇒ Helburu funtzioa: min i. murrizketa ≤ bi modukoa ⇐⇒ i. aldagaia ≥ 0 i. murrizketa = bi modukoa ⇐⇒ i. aldagaia ez-murriztua i. murrizketa ≥ bi modukoa ⇐⇒ i. aldagaia ≤ 0 i. aldagaia ≥ 0 ⇐⇒ i. murrizketa ≥ bi modukoa i. aldagaia ez-murriztua ⇐⇒ i. murrizketa = bi modukoa i. aldagaia ≤ 0 ⇐⇒ i. murrizketa ≤ bi modukoa 3.1. Taula: Primal-dual erlazioa Atal honetan taulako erlazio batzuk frogatuko ditugu; gainerakoak modu be- rean froga daitezke. 1. kasua. Helburu funtzioa maximizatze-forman duen eredu lineal batean mu- rrizketak ≥ modukoak badira, eredu dualaren aldagaiak zero baino txikia- goak edo berdinak dira ( ≤ 0, taulako hirugarren errenkadan adierazten den bezala). Hau da, eredu lineala: max z = c T x hauen mende Ax ≥ b x ≥ 0 izanik, dagokion duala ondokoa da: min G = b T y hauen mende A T y ≥ c y ≤ 0 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  92 3. Dualtasuna Froga. Hasteko, eredu primala maximizatze-forma simetrikoan idatziko dugu. max z = c T x hauen mende −Ax ≤ −b x ≥ 0 Aurreko 3.1.1. atalean emandako primal-dual erlazioa erabiliz, duala kal- kula dezakegu. min G = −b T y hauen mende −A T y ≥ cT y ≥ 0 y = −y aldagai-aldaketa eginez, honela geratuko da eredua: min G = b T y hauen mende A T y ≥ cT y ≤ 0 2 2. kasua. Eredu primalaren murrizketak = modukoak badira, dualaren alda- gaiak ez daude zeinuz murriztuak (ez-murriztuak, taulako bigarren errenka- dan adierazten den bezala). Hau da, eredu lineala max z = c T x hauen mende Ax = b x ≥ 0 izanik, dagokion duala ondokoa da: min G = b T y hauen mende A T y ≥ c y : ez-murriztua OpenCourseWare, UPV/EHU  3.1. Problema duala 93 Froga. Idatz dezagun eredua maximizatze-forma simetrikoan. max z = c T x hauen mende Ax ≤ b −Ax ≤ −b x ≥ 0 Dagokion eredu duala honakoa da: min G = (b T , −bT )   u v   hauen mende (A T , −AT )   u v   ≥ c u , v ≥ 0 u eta v bektoreek m osagai dituztelarik. Eredu duala beste modu honetan idatzia izan daiteke: min G = b T (u − v) hauen mende A T (u − v) ≥ c u , v ≥ 0 y = u − v aldagai-aldaketa eginez, honakoa lortuko da: min G = b T y hauen mende A T y ≥ c y : ez-murriztua y bektorearen osagaiak ez daude zeinuz murriztuta, osagai bakoitza bi al- dagai positiboren kenketa delako. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  94 3. Dualtasuna Adibidea. Izan bedi honako eredu primala. max z = x1 − 4x2 − x3 hauen mende x1 + x2 − x3 ≥ 4 2x1 + 3x2 − 5x3 ≤ 2 2x1 − x2 + 2x3 = 6 x1 ≤ 0, x2 ≥ 0, x3 : ez-murriztua 3.1. Taulako erlazioak erabiliz, dagokion duala kalkulatuko dugu. min G = 4y1 + 2y2 + 6y3 hauen mende y1 + 2y2 + 2y3 ≤ 1 y1 + 3y2 − y3 ≥ −4 −y1 − 5y2 + 2y3 = −1 y1 ≤ 0, y2 ≥ 0, y3 : ez-murriztua 2 3.2 Dualtasunerako teoremak Atal honetan aztertuko ditugun teoremek problema primalaren, dualaren eta beren soluzioen arteko erlazioak ezarriko dituzte. Teoremen enuntziatuak ereduen forma primal-dual simetrikoetarako ematen dira. Primala Duala max z = cT x min G = bT y hauen mende hauen mende Ax ≤ b AT y ≥ c x ≥ 0 y ≥ 0 3.2.1 Teorema. Problema dualaren duala problema primala da. OpenCourseWare, UPV/EHU  3.2. Dualtasunerako teoremak 95 Froga. Har dezagun problema primala. min G = b T y hauen mende A T y ≥ c y ≥ 0 Problemaren duala kalkulatzeko, eredua maximizatze-forma simetrikoan ida- tzi eta primal-dual erlazioa erabiliko dugu. − max (−G) = −b T y hauen mende −A T y ≤ −c y ≥ 0 Dagokion duala honakoa da: − min (−z) = −c T x hauen mende −Ax ≥ −b x ≥ 0 Beste forma baliokide honetan jarriz gero, daukagun problema primala dela ikusten dugu. max z = c T x hauen mende Ax ≤ b x ≥ 0 2 Aurreko teorematik hau ondoriozta daiteke: eredu primalaren helburua mini- mizatzea bada forma dual simetrikoan gertatzen den bezala, eredu dualaren hel- burua maximizatzea izango dela. Hori hala izanik, helburua minimizatzea duen eredu baten duala kalkulatzeko, 3.1. Taula erabil daiteke erlazioak eskuinetik ez- kerrera irakurriz. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  96 3. Dualtasuna Adibidea. Izan bedi honako eredu primala: min z = x1 − 4x2 − x3 hauen mende x1 + x2 − x3 ≥ 4 2x1 + 3x2 − 5x3 ≤ 2 2x1 − x2 + 2x3 = 6 x1 ≤ 0, x2 ≥ 0, x3 : ez-murriztua 3.1. Taula erabiliz, dagokion duala kalkulatuko dugu. max G = 4y1 + 2y2 + 6y3 hauen mende y1 + 2y2 + 2y3 ≥ 1 y1 + 3y2 − y3 ≤ −4 −y1 − 5y2 + 2y3 = −1 y1 ≥ 0, y2 ≤ 0, y3 : ez-murriztua 2 3.2.2 Teorema. (Dualtasun ahula) Izan bitez x eta y problema primalaren eta dualaren soluzio bideragarriak, hurrenez hurren. Honakoa betetzen da: z = c T x ≤ bT y = G. Froga. x primalaren soluzio bideragarria denez, Ax ≤ b eta x ≥ 0 betetzen dira. y dualaren soluzio bideragarria denez, A T y ≥ c eta y ≥ 0 betetzen dira. Ax ≤ b desberdintzaren bi atalak ezkerretik yT bektoreaz biderkatuz, eta AT y ≥ c desberdintzarenak xT bektoreaz, hau daukagu: y T Ax ≤ yT b = bT y. x T AT y ≥ xT c = cT x. xT AT y = yT Ax denez, hau beteko da: z = c T x ≤ yT Ax ≤ bT y = G. OpenCourseWare, UPV/EHU  3.2. Dualtasunerako teoremak 97 2 Aurreko teorematik hau ondoriozta daiteke: helburu primalaren balio maxi- moa helburu dualaren balio minimorako behe-bornea da. Eta, alderantziz, helbu- ru dualaren balio minimoa helburu primalaren balio maximorako goi-bornea da. Datozen emaitzak aurreko teoremen ondorioak dira. 3.2.1 Korolarioa. x ∗ eta y∗ soluzio bideragarriek cT x∗ = bT y∗ betetzen badute, x ∗ eta y∗ primalaren eta dualaren soluzio optimoak dira, hurrenez hurren. Froga. Dualtasun ahularen teoremak ziurtatzen du x eta y soluzioetarako hona- koa beteko dela: c T x ≤ bT y. y ∗ dualaren soluzioa hartzen badugu, cT x ≤ bT y∗ betetzen da. cT x∗ = bT y∗ betetzen denez, problema primalaren edozein x soluziotarako hau beteko da: c T x ≤ cT x∗. Hortik ondoriozta daiteke x ∗ problema primalaren soluzio optimoa dela. Modu berean, eta b T y∗ = cT x∗ ≤ bT y betetzen denez, problema dualaren edozein y soluziotarako hau beteko da: b T y∗ ≤ bT y. Hortik ondoriozta daiteke y ∗ problema dualaren soluzio optimoa dela. 2 3.2.2 Korolarioa. Problema primala bideragarria eta bornegabea bada, duala bideraezina da. Froga. Edozein x eta y soluziok cT x ≤ bT y betetzen dutela kontuan izanik, helburu primala bornegabea bada, ez da existitzen problema primalaren goi-borne izango den dualaren y soluziorik. Modu berean ondorioztatuko da ondoko emaitza. 3.2.3 Korolarioa. Problema duala bideragarria eta bornegabea bada, primala bideraezina da. Problema primala bideraezina bada, duala bideraezina edo bornegabea izan daiteke. Eta, problema duala bideraezina bada, primala bideraezina edo bornega- bea izan daiteke. Adibidea. Honako problema primalerako eta dualerako 3.2.2. Korolarioa betetzen dela ikus daiteke. Kasu honetan primala bornegabea da eta duala bide- raezina. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  98 3. Dualtasuna max z = 3x1 + 2x2 min G = 2y1 + 4y2 hauen mende hauen mende −2x1 + x2 ≤ 2 −2y1 + 2y2 ≥ 3 2x1 + x2 ≥ 4 y1 + y2 ≥ 2 x1, x2 ≥ 0 y1 ≥ 0, y2 ≤ 0 Problema primalaren ebazpen graﬁkoan bornegabea dela ikus daiteke. x1 x2 −2x1 + x2 = 2 2x1 + x2 = 4 max Dualaren bideragarritasun eskualdean ez dago punturik; bideraezina da. y1 y2 −2y1 + 2y2 = 3 y1 + y2 = 2 OpenCourseWare, UPV/EHU  3.3. Osagarrizko nasaitasunaren baldintzak 99 2 3.2.3 Teorema. (Dualtasunaren funtsezko printzipioa) Problema primalaren x ∗ soluzio optimoa existitzen bada, problema dualaren y ∗ soluzio optimoa existitzen da. Modu berean, problema dualaren y ∗ soluzio optimoa existitzen bada, pro- blema primalaren x ∗ soluzio optimoa existitzen da. Bi kasuetan z∗ = cT x∗ = bT y ∗ = G∗ betetzen da. Adibidea. Har ditzagun ondoko problema primala eta duala: max z = 2x1 + 3x2 min G = 2y1 + 3y2 + 5y3 hauen mende hauen mende x1 + x2 ≤ 2 y1 + 2y2 + y3 ≥ 2 2x1 − x2 ≤ 3 y1 − y2 + 3y3 ≥ 3 x1 + 3x2 ≤ 5 y1, y2, y3 ≥ 0 x1, x2 ≥ 0 Primalaren eta dualaren edozein bi soluzio hartuta z ≤ G betetzen da. Adi- bidez, xT = (1, 1) primalaren soluzio bideragarria da murrizketak betetzen di- tuelako, eta y T = (1, 1, 1) dualaren soluzio bideragarria da; z = 5 ≤ 10 = G betetzen da. Problema primalaren eta dualaren soluzio optimoak hauek dira: x ∗ T = ( 1 2 , 3 2 ), y ∗ T = ( 3 2 , 0, 1 2 ). Bi problemetarako helburu funtzioek balio bera hartuko dute soluzio opti- moan, z ∗ = 11 2 = G ∗ . 2 3.3 Osagarrizko nasaitasunaren baldintzak Osagarrizko nasaitasunaren baldintzei esker, primalaren soluzio optimotik abia- tuz dualaren soluzio optimoa kalkula daiteke, eta alderantziz. Baldintza horiek teorema honen ondorioak dira. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  100 3. Dualtasuna 3.3.1 Teorema. (Osagarrizko nasaitasunarena) x ∗ eta y∗ problema primalaren eta dualaren soluzio bideragarriak izanik, hurrenez hurren, optimoak izango dira baldin ondoko baldintza betetzen badute: x ∗ T (AT y∗ − c) + y∗T (b − Ax∗) = 0. Emaitza horren interpretaziotik lortuko dira osagarrizko nasaitasunaren bal- dintzak. Gogora dezagun ereduak primal-dual forma simetrikoan daudela. 3.3.1 Osagarrizko nasaitasunaren baldintzen interpretazioa x ∗ eta y∗ primalaren eta dualaren soluzio optimoak izanik, hurrenez hurren, bi problemen murrizketak honela idatz daitezke: b − Ax ∗ ≥ 0. A T y∗ − c ≥ 0. Bestalde, x ∗ eta y∗ primalaren eta dualaren soluzio optimoak osagai negati- borik gabeko bektoreak dira. Ondorioz, aurreko desberdintzaren bi atalak y ∗ T eta x ∗ T bektoreez ezkerretik biderkatzen baditugu, hurrenez hurren, desberdintzak honela geratuko dira: x ∗ T (AT y∗ − c) ≥ 0. y ∗ T (b − Ax∗) ≥ 0. Osagarrizko nasaitasunaren teoremak ziurtatzen du aurreko bi desberdintzen ezkerreko atalen batura zero dela. Bi batugaiak zero baino handiagoak edo ber- dinak direla kontuan izanik, ondoriozta daiteke biek zero izan behar dutela, hau da, x ∗ T (AT y∗ − c) = 0. y ∗ T (b − Ax∗) = 0. Aurreko bi ekuazioen arabera, bi biderkagai ez-negatiboren biderkadura zero da; biderkagaietako bat ez bada zero, besteak izan beharko du. Horrela, proble- ma baten soluzioa ezagututa beste problemaren soluzioa kalkulatzea ahalbidetuko duten ondoko ondorioak lortuko dira. OpenCourseWare, UPV/EHU  3.3. Osagarrizko nasaitasunaren baldintzak 101 1. Aldagai primal bat hertsiki positiboa bada, dagokion murrizketa duala ber- dintzaz betetzen da; ez du nasaitze-aldagai positiborik behar, hau da, x ∗ > 0 ⇒ AT y∗ − c = 0. 2. Primalaren murrizketa bat ez bada berdintzaz betetzen, dagokion aldagai dualak zero balioa hartuko du, hau da, Ax ∗ < b ⇒ y∗ = 0. 3. Aldagai dual bat hertsiki positiboa bada, dagokion murrizketa primala ber- dintzaz betetzen da, hau da, y ∗ > 0 ⇒ Ax∗ − b = 0. 4. Dualaren murrizketa bat ez bada berdintzaz betetzen, dagokion aldagai pri- malak zero balioa hartuko du, hau da, A T y∗ > c ⇒ x∗ = 0. Adibidea. Har dezagun ondoko problema lineala: max z = 3x1 + x2 − 2x3 hauen mende x1 + 2x2 + x3 ≤ 5 2x1 − x2 + 3x3 ≤ 4 x1, x2, x3 ≥ 0 Problemaren soluzio optimoa x ∗ T = ( 13 5 , 6 5 , 0) dela jakinda, osagarrizko na- saitasunaren teorema erabiliko dugu dualaren soluzio optimoa kalkulatzeko. Pro- blema duala honakoa da: min G = 5y1 + 4y2 hauen mende y1 + 2y2 ≥ 3 2y1 − y2 ≥ 1 y1 + 3y2 ≥ −2 y1, y2 ≥ 0 Nasaitze-aldagaiak kenduz, honela geratuko da: Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  102 3. Dualtasuna min G = 5y1 + 4y2 + 0y3 + 0y4 + 0y5 hauen mende y1 + 2y2 −y3 = 3 2y1 − y2 −y4 = 1 y1 + 3y2 −y5 = −2 y1, y2, y3, y4, y5 ≥ 0 Osagarrizko nasaitasunaren teoremaren ondorioak erabiliz, problema dualaren soluzio optimoa kalkulatuko dugu. Primalaren aldagaiak Dualaren murrizketak x ∗ 1 = 13 5 > 0 ⇒ y ∗ 1 + 2y ∗ 2 = 3 ⇒ y ∗ 3 = 0 x ∗ 2 = 6 5 > 0 ⇒ 2y ∗ 1 − y ∗ 2 = 1 ⇒ y ∗ 4 = 0 x ∗ 3 = 0 ⇒ y ∗ 1 + 3y ∗ 2 − y ∗ 5 = −2 Primalaren murrizketak Dualaren aldagaiak 13 5 + 2 × 6 5 = 5 ⇒ y ∗ 1 aldagaiaren balioa kalkulatu 2 × 13 5 − 6 5 = 4 ⇒ y ∗ 2 aldagaiaren balioa kalkulatu Dualaren murrizketen sisteman y ∗ 3 eta y ∗ 4 nasaitze-aldagaien zero balioak or- dezkatuz, sistema honela geratuko da: y ∗ 1 + 2y ∗ 2 = 3 2y ∗ 1 − y ∗ 2 = 1 y ∗ 1 + 3y ∗ 2 − y ∗ 5 = −2 Ekuazio-sistema ebatziz, eredu dualaren soluzio optimoa lortuko da. y ∗ 1 = 1, y ∗ 2 = 1, y ∗ 3 = 0, y ∗ 4 = 0, y ∗ 5 = 6. 2 OpenCourseWare, UPV/EHU  3.4. Soluzio dual optimoa 103 3.4 Soluzio dual optimoa 3.4.1 Teorema. Izan bitez bi eredu lineal primal-dual simetrikoak. B problema primalaren oinarri optimoa bada, y ∗ T = cT B B −1 problema dualaren soluzio opti- moa da. Froga. Forma simetriko primalari nasaitze-aldagaien xh bektorea gehituz, murrizketak honela geratuko dira: Ax + Ixh = b x , xh ≥ 0 B primalaren oinarri optimoa bada, eta xB oinarriko soluzio bideragarri opti- moa, A matrizeko aj bektore guztietarako zj − cj ≥ 0 betetzen da. zj = c T B yj = c T B B −1aj. B oinarri optimoa denez, zj ≥ cj betetzen da A matrizeko aj bektore guztie- tarako, hau da, c T B B −1A ≥ cT . Aurreko desberdintzaren atalak irauliz dualaren murrizketen sistema lortuko da: A T (cT B B −1)T ≥ c. Hortaz, y ∗ = (cT B B −1)T dualaren soluzioa da. Bideragarria den edo ez egiaztatzeko, I matrizeko bektoreei dagozkien balio adierazleak kalkulatuko ditugu. c T B B −1I ≥ cT I . xh bektoreko aldagaiak nasaitze-aldagaiak direnez, cI = 0 da eta hau beteko da: c T B B −1I = cT B B −1 ≥ 0T . Ondorioz, y ∗ = (cT B B −1)T bektorearen osagaiak ez-negatiboak dira. y ∗ optimoa dela egiaztatuko dugu orain, primalaren helburu funtzioaren balioa eta dualarena soluzio horretan berdinak direla egiaztatuz. z ∗ = cT B xB = c T B B −1b = bT (cT B B −1)T = bT y∗ = G∗. Bi problemen helburu funtzioaren balioa bera denez, y ∗ = (cT B B −1)T dualaren soluzio optimoa dela frogatuta geratuko da. 2 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  104 3. Dualtasuna 3.4.1 Soluzio dual optimoa taulan Ikus dezagun problema primal bat ebazterakoan, taula optimoan problema duala- ren optimoa ere lortzen dela. 3.4.1 Teoreman frogatu dugu problema primalaren oinarri optimoa B bada, eredu dualaren soluzio optimoa y ∗ T = cT B B −1 dela. Ikusiko dugu bektore hori taula optimoan agertzen dela, zj −cj balioen errenkadan, eta hasierako I matrizeko aj bektoreei dagozkien zutabeetan. zj − cj = c T B B −1aj − cj. I matrizeko bektore guztiei dagozkien zj − cj balio adierazleak batera kalku- latzen baditugu, honako bektorea lortuko dugu: c T B B −1I − cT I = c T B B −1 − cT I . Hortaz, dualaren soluzio optimoa den y ∗ T = cT B B −1 bektorea kalkulatzeko, hasierako taulako identitate matrizeari dagozkion zutabeetan taula optimoan dau- den balio adierazleei cT I gehitu besterik ez da egin behar. Bi kasu gerta daitezke. • I matrizea nasaitze-aldagaiez osaturik badago, cI = 0 da. • Hasierako I oinarrian aldagai artiﬁzialak badaude, helburu funtzioa zigor- tzeko erabili diren aldagai artiﬁzialen M balioak daude cI bektorean. Adibidea. 101. orrialdeko problema har dezagun. max z = 3x1 + x2 − 2x3 hauen mende x1 + 2x2 + x3 ≤ 5 2x1 − x2 + 3x3 ≤ 4 x1, x2, x3 ≥ 0 Nasaitze-aldagaiak gehitu ondoren, hasierako taula eraikiko da. x1 x2 x3 x4 x5 −3 −1 2 0 0 0 a4 1 2 1 1 0 5 a5 2 −1 3 0 1 4 OpenCourseWare, UPV/EHU  3.4. Soluzio dual optimoa 105 Simplex algoritmoa aplikatuz, honako taula optimoa lortuko da: x1 x2 x3 x4 x5 0 0 6 1 1 9 a2 0 1 − 1 5 2 5 − 1 5 6 5 a1 1 0 7 5 1 5 2 5 13 5 Primalaren soluzio optimoa honakoa da: x ∗ 1 = 13 5 , x ∗ 2 = 6 5 , x ∗ 3 = 0, z ∗ = 9. Kalkula dezagun dualaren soluzio optimoa primalaren taula optimotik abiatuz. Hasierako oinarria, B = I = (a4, a5), nasaitze-aldagaiez osaturik dago. Taula optimoan, x4 eta x5 aldagaiei dagozkien zutabeetan dago B −1 eta dualaren soluzio optimoa aldagai horiei dagozkien balio adierazleetan bilatu behar da. (z4 − c4, z5 − c5) = c T B B −1I − cT I = (1, 1) − c T I . cT I = (c4 , c5) = (0, 0) denez, problema dualaren soluzio optimoa honakoa da: y ∗ T = cT B B −1 = (1, 1). Problema dualaren helburu funtzioaren balioa G ∗ = 9 da. 2 Adibidea. Har dezagun honako eredu lineala. min z = x1 + 2x2 hauen mende 4x1 + 3x2 ≤ 12 x1 + 3x2 ≥ 6 2x1 + x2 ≥ 4 x1, x2 ≥ 0 Simplex algoritmoa aplikatzen hasteko, nasaitze-aldagaiak gehitzeaz gain, bi aldagai artiﬁzial gehitu behar dira, w1 eta w2. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  106 3. Dualtasuna max (−z) = −x1 − 2x2 + 0x3 + 0x4 + 0x5 − Mw1 − Mw2 hauen mende 4x1 + 3x2 +x3 = 12 x1 + 3x2 −x4 +w1 = 6 2x1 + x2 −x5 +w2 = 4 x1, x2, x3, x4, x5, w1, w2 ≥ 0 Hasierako oinarria B = I = (a3, aw1, aw2) da. x1 x2 x3 x4 x5 w1 w2 −3M + 1 −4M + 2 0 M M 0 0 −10M 0 a3 4 3 1 0 0 0 0 12 1 −M aw1 1 3 0 −1 0 1 0 6 −M aw2 2 1 0 0 −1 0 1 4 1 3 − 5 3 M + 1 3 0 0 − 1 3 M + 2 3 M 4 3 M − 2 3 0 −2M − 4 0 a3 3 0 1 1 0 −1 0 6 9 5 −2 a2 1 3 1 0 − 1 3 0 1 3 0 2 1 5 −M aw2 5 3 0 0 1 3 −1 − 1 3 1 2 0 0 0 3 5 1 5 M − 3 5 M − 1 5 − 22 5 0 a3 0 0 1 2 5 9 5 − 2 5 − 9 5 12 5 −2 a2 0 1 0 − 2 5 1 5 2 5 − 1 5 8 5 −1 a1 1 0 0 1 5 − 3 5 − 1 5 3 5 6 5 Problema primalaren soluzio optimoa honakoa da: x ∗ 1 = 6 5 , x ∗ 2 = 8 5 , −z ∗ = − 22 5 ⇒ z ∗ = 22 5 . Kalkula dezagun dualaren soluzio optimoa primalaren taula optimotik abia- tuz. Hasierako taulan, x3, w1 eta w2 aldagaiei dagozkien zutabeetan dago identi- tate matrizea. Taula optimoan, zutabe horietan berberetan dago B −1 eta dualaren OpenCourseWare, UPV/EHU  3.5. Dualtasunaren interpretazio ekonomikoa 107 soluzio optimoa zutabe horietako balio adierazleetan bilatu behar da. (z3 − c3, zw 1 − cw1 , zw2 − cw2 ) = c T B B −1I − cT I = (0, M − 3 5 , M − 1 5 ). cT I = (c3 , cw1 , cw2 ) = (0, −M, −M ) dela kontuan izanik, y ∗ T = cT B B −1 − cT I + c T I = (0, M − 3 5 , M − 1 5 ) + (0, −M, −M). Hasiera batean, problema dualaren soluzio optimoa hau dela esan genezake: y ∗ T = (0, − 3 5 , − 1 5 ). Hala ere, aldagaien zeinua zuzena den edo ez egiaztatu behar da. Adibideko problemari dagokion duala kalkulatzen badugu, y2 eta y3 aldagaiek ez-negatibo izan behar dutela ikusten da. Kasu honetan, aldagai horietarako taulatik lortu di- tugun balioak negatiboak dira. Horren arrazoia hau da: simplex algoritmoa apli- katu ahal izateko ereduaren helburu funtzioari egindako aldaketak eragina sortzen duela taulako balio adierazleen errenkadan. Adibide honetan, hasierako helbu- rua minimizatzea da eta maximizatzera egokitu dugu; horregatik ez dira zuzenak aldagaietarako zeinuak. Hortaz, problema dualaren soluzio optimoa honakoa da: y ∗ 1 = 0, y ∗ 2 = 3 5 , y ∗ 3 = 1 5 , G ∗ = 22 5 . 2 Simplex algoritmoa aplikatzen hasi baino lehen, ereduaren murrizketaren ba- ten noranzkoa aldatzeak aldagai dualei egokituko zaien taulako balioren baten zeinua okerra izatea eragingo du. 91. orrialdeko 3.1. Taulako primal-dual erla- zioak aztertuz azaldu daiteke zeinuak aldatzearen arrazoia. Baiezta daiteke cT B B −1 bektorearen osagaien balio absolutuak bat datozela aldagai dual optimoen balio absolutuekin. 3.5 Dualtasunaren interpretazio ekonomikoa Eredu lineal baten soluzio optimoak mugatuta dauden baliabideen esleipen opti- moa zehazten du. Ikusiko dugun bezala, aldagai dualen balio optimoek baliabi- deen kopurua aldatzea komeni den ala ez adierazten dute. Informazio hori ondoko atalean aztertuko ditugun itzal-prezioek ematen dute. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  108 3. Dualtasuna 3.5.1 Itzal-prezioak Izan bedi eredu lineal bat, eta B oinarri optimoa. Oinarri optimo horri problema primalaren x ∗ soluzio optimoa eta z∗ balio optimoa dagozkio, baita dualaren y∗ soluzio optimoa eta G ∗ balio optimoa ere. Demagun b baliabide-bektorea b + ∆b izatera aldatzen dela. Ikus dezagun aldaketa horrek zein eragin sortzen duen B oinarriari dagokion taulako kalkuluen gain, bideragarritasun primala galtzen ez bada. • Oinarri optimoari eta baliabide-bektore berriari dagokien soluzio primala honakoa da: ∧ xB= B −1(b + ∆b) = xB + B− 1∆b. • Baliabide-bektorearen aldaketak ez du eraginik sortuko balio adierazleen errenkadan. zj − cj = c T B B −1aj − cj. • Helburu funtzio primalaren eta dualaren balioak aldatu egiten dira, baliabide- bektorearen gehikuntzaren arabera. ∧ G ∗ = y ∗ T (b + ∆b) = y∗T b + y∗T ∆b = G∗ + y∗T ∆b = z∗ + y∗T ∆b. Ondorioz, bideragarritasun primalaren galera eragiten ez duen b baliabide- bektorearen aldaketak problemaren soluzioan ondoko aldaketak eragiten ditu: • Dualaren soluzio optimoaren osagaiak mantendu egiten dira. • Primalaren soluzioaren osagaiak aldatu egiten dira B −1∆b kantitatea. • Helburu funtzio primalaren eta dualaren balioa y ∗ T ∆b kantitatea aldatuko dira. Laburbilduz, baliabide-bektorea aldatu eta ∧ xB= B −1(b + ∆b) ≥ 0 betetzen bada, ∧ xB problema primalaren soluzio optimoa da eta dualaren y ∗ soluzioak opti- mo izaten jarraituko du. Bi helburuen balio optimoa y ∗ T ∆b kantitatea handituko da. OpenCourseWare, UPV/EHU  3.5. Dualtasunaren interpretazio ekonomikoa 109 Aldagai dual bakoitzaren esanahia interpretatu ahal izateko, demagun ∆bi = 1 dela eta gainerakoak zero direla. Orduan, helburuaren gehikuntza honakoa da: y ∗ T ∆b = (y∗ 1 , . . . , y ∗ i , . . . , y ∗ m)            0 .. . 1 .. . 0            = y ∗ i . Hau da, i. baliabidea unitate bat handitzen bada eta gainerako baliabideak bere horretan mantentzen badira, y ∗ i aldagai dualaren balio optimoak helburu funtzioa- ren balioaren gehikuntza adierazten du. 3.5.1 Deﬁnizioa. (Itzal-prezioa) y ∗ i , i = 1, . . . , m, aldagai dual optimoa i. ba- liabidearen itzal-prezioa dela esaten da, baldin i. baliabidean unitate bateko aldaketa egitean eta gainerako baliabideak bere horretan mantentzean ez bada bideragarritasun primala galtzen. Adibidea. Har dezagun 104. orrialdeko adibidea, eta ikus dezagun ea duala- ren soluzio optimo diren y ∗ 1 = 1 eta y ∗ 2 = 1 balioak b1 eta b2 baliabideen itzal- prezioak diren. • b1 = 5 balioa b1 + ∆b1 = 6 balioaz ordezkatuz gero, hau da, ∆b1 = 1, ∧ xB= B −1(b + ∆b) =   2 5 − 1 5 1 5 2 5     6 4   =   8 5 14 5   Ez da bideragarritasun primala galdu, ∧ xB≥ 0 betetzen delako. Esan dezake- gu b1 baliabidearen itzal-prezioa y ∗ 1 dela. Helburu funtzioaren balio optimo berria honakoa da: ∧ z ∗ = z ∗ + y∗ 1 = 9 + 1 = 10. • b2 baliabiderako interpretazio bera egingo dugu. Kasu honetan, demagun b2 = 4 balioa b2 + ∆b2 = 3 balioaz ordezkatzen dugula. ∧ xB= B −1(b + ∆b) =   2 5 − 1 5 1 5 2 5     5 3   =   7 5 11 5   Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  110 3. Dualtasuna Ez da bideragarritasun primala galdu, ∧ xB≥ 0 betetzen delako. Esan dezake- gu b2 baliabidearen itzal-prezioa y ∗ 2 dela. Helburu funtzioaren balio optimo berria honakoa da: ∧ z ∗ = z ∗ − y∗ 2 = 9 − 1 = 8. Kasu honetan, helburu funtzioaren balio optimoa y ∗ 2 itzal-prezioak adierazi adina txikituko da, bigarren baliabidearen gehikuntza negatiboa delako. 2 Adibidea. Har dezagun 105. orrialdeko adibidea. Problema dualaren soluzio optimoa honakoa da: y ∗ 1 = 0 , y ∗ 2 = 3 5 , y ∗ 3 = 1 5 . Demagun lehenengo baliabidearen kopurua unitate bat handitzen dela, b1 = 12 izatetik b1 + ∆b1 = 13 izatera pasatzen dela. ∧ xB= B −1(b + ∆b) =      1 − 2 5 − 9 5 0 2 5 − 1 5 0 − 1 5 3 5           13 6 4      =      17 5 8 5 6 5      ≥ 0. Bideragarritasun primala mantendu egiten denez, y ∗ 1 aldagaia lehenengo balia- bidearen itzal-prezioa dela esan dezakegu. Dena den, helburu funtzioaren balioa ez dela aldatuko ikusten dugu, itzal-prezioa y ∗ 1 = 0 delako. ∧ z ∗ = z ∗ + y∗ 1 = 22 5 + 0 = 22 5 . Lehenengo baliabidearen itzal-prezioa zero dela ikustearekin batera, hau egiaz- ta daiteke: eredu primalaren lehenengo murrizketa desberdintzaz betetzen dela. Ordezka ditzagun x ∗ 1 = 6 5 , x ∗ 2 = 8 5 balio optimoak 4x1 + 3x2 ≤ 12 murrizketan: 4 × 6 5 + 3 × 8 5 < 12. Horrek esan nahi du lehenengo baliabidea kantitate handiegian dagoela, eta ondorioz, lehenengo baliabidearen kantitatea handitzeak ez du inolako eraginik sortuko helburu funtzioaren balio optimoan. Kasu honetan, baliabide horren kan- titatea txikitzearen aukera aztertu beharko genuke. 2 OpenCourseWare, UPV/EHU  3.5. Dualtasunaren interpretazio ekonomikoa 111 3.5.2 Aldagai primalen kostu ekonomikoa eta simplex meto- doaren interpretazioa Primalaren aldagaien kostu ekonomikoa ulertzeko modu erraz bat adibide baten bidez aztertzea da. Enpresa batean lau produktu mota ekoizten dira: 1, 2, 3 eta 4. Produktuen ekoizpenean hiru baliabide erabiliko dira: A, B eta C. Produktu unitate bakoitza- ren ekoizpenerako behar diren baliabideen kantitateak, baliabideen erabilgarrita- suna eta produktu unitate bakoitzetik lortuko den irabazia ondoko taulan adieraz- ten dira: Produktuak Baliabide Baliabidea 1 2 3 4 erabilgarria A 2 3 3 2 4 300 B 2 4 3 1 500 C 5 1 2 2 250 Irabazia 4 3 6 2 Izan bedi xj: ekoitziko den j produktu unitate kopurua, j = 1, 2, 3, 4. Ekoizpen- problema adierazteko ondoko eredu lineala plantea dezakegu: max z = 4x1 + 3x2 + 6x3 + 2x4 hauen mende 2x1 + 3x2 + 3 2 x3 + 4x4 ≤ 300 2x1 + 4x2 + 3x3 + x4 ≤ 500 5x1 + x2 + 2x3 + 2x4 ≤ 250 x1, x2, x3, x4 ≥ 0 Demagun orain enpresa lehiakide batek b1 = 300, b2 = 500 eta b3 = 250 ba- liabideak erosi nahi dizkiola. Bigarren enpresa horren helburua baliabideak ahalik eta kosturik txikienean lortzea da; A, B eta C baliabideen unitate bakoitzagatik y1, y2 eta y3 aldagaiek adierazitako prezioa ordaintzen badu, hurrenez hurren, hel- burua honakoa izango da: min G = 300y1 + 500y2 + 250y3 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  112 3. Dualtasuna Pentsa dezakegu lehenengo enpresak baliabideen erabilpenetik lortutakoa (ira- bazia) baino txikiagoa izango den prezioan (kostu ekonomikoan) ez dizkiola sal- duko bigarrenari. 1 produktuaren unitate bat ekoizteko, lehenengo enpresak 2 unitate A baliabi- de, 2 unitate B baliabide eta 5 unitate C baliabide erabiliko ditu, eta ekoizpenetik lortuko duen irabazia 4 unitatekoa da. Baliabideen unitate horiek bigarren en- presari saltzen badizkio, 2y1 + 2y2 + 5y3 unitateko irabazia lortuko du; hori da 1 jardueraren kostu ekonomikoa. Hortaz, enpresa baliabideak bigarren enpresari saltzeko prest egongo litzateke jarduera aurrera eramateak sortutako kostu ekono- mikoa irabazia baino handiagoa balitz, hau da, ondoko murrizketa beteko balitz (eredu dualaren lehenengo murrizketa). 2y1 + 2y2 + 5y3 ≥ 4 Beste hiru produktuetarako interpretazio bera eginez, ekoizpen-problemari da- gokion eredu duala lortuko dugu. min G = 300y1 + 500y2 + 250y3 hauen mende 2y1 + 2y2 + 5y3 ≥ 4 3y1 + 4y2 + y3 ≥ 3 3 2 y1 + 3y2 + 2y3 ≥ 6 4y1 + y2 + 2y3 ≥ 2 y1, y2, y3 ≥ 0 Simplex algoritmoan, oinarrikoa ez den xj aldagai bat oinarriko izatera pasa daiteke algoritmoaren hurrengo iterazio batean, bere zj −cj balio adierazlea nega- tiboa bada. Baldintza horren arrazoia da xj aldagaiaren balio adierazlea problema dualaren j. murrizketa dela; balio adierazlea negatiboa denean, j. jardueraren kostu ekonomikoa lortutako irabazia baino txikiagoa da, ekoizpena errentagarria gertatzen delarik. Arrazonamendu hori ondoko formuletan ikus daiteke: zj − cj = c T B B −1aj − cj = y T a j − cj = m i=1 aijyi − cj. Ondorioz, baldin zj − cj < 0 betetzen bada, m i=1 aijyi < cj. OpenCourseWare, UPV/EHU  3.6. Simplex dual metodoa 113 Hau da, j. jardueraren kostu ekonomikoa jardueraren ekoizpenari dagokion cj irabazia baino txikiagoa da. 3.6 Simplex dual metodoa 2. Kapituluan ikusi dugunez, simplex algoritmoa aplikatzean soluzio primal bide- ragarri bat kalkulatzeko, hasierako oinarri moduan identitate matrizea aukeratuko da, behar izanez gero aldagai artiﬁzialak erabiliko direlarik. Algoritmoaren ondoz ondoko iterazioetan oinarriko soluzio bideragarri batetik beste oinarriko soluzio bideragarri batera pasako da optimoa lortuko den arte, hau da, taulan zj − cj ≥ 0 beteko den arte A matrizeko aj bektore guztietarako. Baldintza hori eredu duala- ren bideragarritasunarekin erlazionatuta dago. Hau da, simplex algoritmoa soluzio primal bideragarri batean hasten da eta dualarentzako bideragarritasuna lortzen denean amaituko da. Metodo horri simplex primal deituko diogu aurrerantzean. Atal honetan simplex dual algoritmoa aurkeztuko dugu. Algoritmo hau ere hasierako oinarri moduan I matrizea aukeratuz hasten da, eta nasaitze-aldagaiez osaturik egongo da beti. Lehen urratsa eredu lineala maximizatze-forma sime- trikoan idaztea eta murrizketa bakoitzean nasaitze-aldagai bat gehitzea da. Ha- sierako taulan bideragarritasun duala badago, beharrezko diren iterazio guztiak egingo dira bideragarritasun primala ere lortuko den arte (problemak soluziorik badu). Hasierako taulan hasierako oinarria horrela aukeratuz ez badago bideraga- rritasun dualik, ereduari murrizketa artiﬁzial bat gehitzea beharrezkoa izango da, 3.7 atalean ikusiko dugun bezala. 3.6.1 Simplex dual algoritmoa Helburua maximizatzea da. Hasierako B = I oinarria nasaitze-aldagaiez osatuta- ko matrizea izango da. 1. urratsa. Hasierako taula eraiki, non zj − cj ≥ 0 beteko den A matrizeko aj bektore guztietarako. 2. urratsa. Bideragarritasun primalarekiko bi kasu gerta daitezke. • xBi ≥ 0, i = 1, . . . , m, bada, soluzioa optimoa da. Amaitu. • Existitzen bada xBi < 0, soluzioa hobe daiteke. 3. urratsera joan. 3. urratsa. Oinarri aldaketa. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  114 3. Dualtasuna • Ondoko baldintza betetzen duen ar bektorea irtengo da oinarritik. xBr = min i { xBi / xBi < 0 } r. errenkada pibot-errenkada da. • Ondoko baldintza betetzen duen ak bektorea sartuko da oinarrian. zk − ck yrk = max j zj − cj yrj / yrj < 0 k. zutabea pibot-zutabea da. yrk elementua pibota da. yrj, j = 1, . . . , n, negatiborik ez bada existitzen, problema bideraezina da. Amaitu. 4. urratsa. Taula berria kalkulatu simplex algoritmoan deﬁnitu diren oinarriz- ko eragiketa berberen bidez. 2. urratsera joan. Adibidea. Izan bedi honako eredu lineala: min z = 3x1 + 2x2 hauen mende x1 + 2x2 ≥ 3 −2x1 + x2 ≥ 2 x1 + 4x2 ≥ 7 x1, x2 ≥ 0 Eredua maximizatze-forma simetrikoan idatziko dugu simplex dual algorit- moa aplikatu aurretik. max (−z) = −3x1 − 2x2 hauen mende −x1 − 2x2 ≤ −3 2x1 − x2 ≤ −2 −x1 − 4x2 ≤ −7 x1, x2 ≥ 0 OpenCourseWare, UPV/EHU  3.6. Simplex dual metodoa 115 Murrizketak berdintzaz idazteko, bakoitzean nasaitze-aldagai bat gehituko dugu. max (−z) = −3x1 − 2x2 + 0x3 + 0x4 + 0x5 hauen mende −x1 − 2x2 + x3 = −3 2x1 − x2 + x4 = −2 −x1 − 4x2 + x5 = −7 x1, x2, x3, x4, x5 ≥ 0 1. urratsa. Hasierako taula eraiki. zj − cj guztiak ez-negatiboak dira, hau da, bideragarritasun duala dago. x1 x2 x3 x4 x5 3 2 0 0 0 0 − 1 2 a3 −1 −2 1 0 0 −3 1 2 a4 2 −1 0 1 0 −2 1 4 a5 −1 −4 0 0 1 −7 2. urratsa. Taula horretan ez dago bideragarritasun primalik. Ondorioz, solu- zioa hobe daiteke. xB =      −3 −2 −7      ≥ 0 3. urratsa. Oinarri aldaketa. xB3 = min{−3, −2, −7} = −7 a5 bektorea irtengo da oinarritik. 3. errenkada pibot-errenkada da. zk − ck yik = max 3 −1 , 2 −4 = − 1 2 = z2 − c2 y22 a2 bektorea sartuko da oinarrian. 2. zutabea pibot-zutabea da. Pibota −4 balioa da. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  116 3. Dualtasuna 4. urratsa. Taula berria kalkulatu. Lehenengo errenkadarako biderkatzailea 1 2 da, bigarren errenkadarako biderkatzailea 1 4 da eta balio adierazleen erren- kadarako biderkatzailea − 1 2 da. Errenkaden artean oinarrizko eragiketak eginez, ondoko taula lortuko da: x1 x2 x3 x4 x5 5 2 0 0 0 1 2 − 7 2 −2 0 a3 − 1 2 0 1 0 − 1 2 1 2 2 0 a4 9 4 0 0 1 − 1 4 − 1 4 −2 a2 1 4 1 0 0 − 1 4 7 4 1 2. urratsera bueltatzean, taulan bideragarritasun primalik ez dagoela ikusten dugu. Hortaz, algoritmoaren beste iterazio bat egin beharko dugu. a4 bektorea irtengo da oinarritik eta a5 bektorea sartu. Taula berria honakoa da: x1 x2 x3 x4 x5 7 0 0 2 0 −4 0 a3 −4 0 1 −2 0 1 0 a5 −9 0 0 −4 1 1 −2 a2 −2 1 0 −1 0 2 Berriro ere, 2. urratsera bueltatzean, taula horretan bideragarritasun primala badagoela egiaztatuko dugu eta, ondorioz, taula optimoa da. Problemaren soluzio optimoa x ∗ 1 = 0 eta x ∗ 2 = 2 da, eta helburu funtzioaren balio optimoa z ∗ = 4. 2 3.7 Murrizketa artiﬁzialaren metodoa Simplex dual algoritmoa aplikatu ahal izateko, beharrezkoa da hasierako taulan bideragarritasun duala izatea, eta hori ez da horrela eredu lineal guztietarako. Ho- rregatik, algoritmoaren aplikazioa murriztua geratzen da. Edozein eredu lineal simplex dual algoritmoaren bidez ebaztea posible egiten duen algoritmoaren he- dapen bat murrizketa artiﬁzialaren metodoa da. OpenCourseWare, UPV/EHU  3.7. Murrizketa artiﬁzialaren metodoa 117 Hasierako taulan bideragarritasun dualik ez dagoenean, ebatziko den eredu linealari murrizketa artiﬁzial bat gehitzean datza metodoa. Murrizketa artiﬁzial horrek ez luke problemaren bideragarritasun eskualdea aldatu beharko. Taulan bideragarritasun duala lortzeko helburuarekin gehituko da murrizketa artiﬁziala, eta hortik aurrera simplex dual algoritmoaren aplikazioarekin segi ahal izango da. Ereduari gehituko zaion murrizketa artiﬁziala honakoa da: j∈N xj ≤ M. non N izango den hasierako taulan zj − cj negatiboa duten aldagaiek osatzen duten multzoa. Ereduari gehitutako murrizketa artiﬁzialak soluzioen eskualdea alda ez dezan, M balio positibo oso handia izango da. Adibidea. Har dezagun honako eredu lineala: max z = x1 + 6x2 hauen mende x1 + 2x2 ≤ 20 x1 + 1 2 x2 ≥ 1 2 x1, x2 ≥ 0 Eredua maximizatze-forma simetrikoan idatziko dugu, eta murrizketa bakoi- tzean nasaitze-aldagai bat gehituko dugu. max z = x1 + 6x2 + 0x3 + 0x4 hauen mende x1 + 2x2 + x3 = 20 −x1 − 1 2 x2 + x4 = − 1 2 x1, x2, x3, x4 ≥ 0 B = I = (a3, a4) oinarria aukeratu eta hasierako taula eraikiko dugu. x1 x2 x3 x4 −1 −6 0 0 0 a3 1 2 1 0 20 a4 −1 − 1 2 0 1 − 1 2 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  118 3. Dualtasuna Hasierako taula horretan ez dago simplex dual algoritmoa aplikatu ahal izateko behar dugun bideragarritasun duala. Horretarako ondoko murrizketa artiﬁziala gehituko diogu ereduari: x1 + x2 ≤ M. Murrizketa artiﬁzialari nasaitze- aldagai bat gehituz, horrela geratuko da eredua: max z = x1 + 6x2 + 0x3 + 0x4 + 0x5 hauen mende x1 + 2x2 + x3 = 20 −x1 − 1 2 x2 + x4 = − 1 2 x1 + x2 + x5 = M x1, x2, x3, x4, x5 ≥ 0 B = I = (a3, a4, a5) oinarria aukeratu eta murrizketa artiﬁziala duen ere- duari dagokion hasierako taula eraikiko dugu. x1 x2 x3 x4 x5 −1 −6 0 0 0 0 −6 0 a3 1 2 1 0 0 20 2 0 a4 −1 − 1 2 0 1 0 − 1 2 − 1 2 0 a5 1 1 0 0 1 M Geroago ikusiko dugun murrizketa artiﬁzialaren kasurako simplex dual algo- ritmoan zehaztuko dugu zein den hasierako taula horretan egin behar den oinarri- aldaketa, bideragarritasun duala duen taula bat lortzeko. 2 3.7.1 Murrizketa artiﬁzialaren eragina Modu laburrean esanda, murrizketa artiﬁzialaren metodoak simplex dual algo- ritmoa osatu egiten du, hala behar den kasuetan. Baina, problemari murrizketa artiﬁzial bat gehitzeak ez du soluzioen eskualdearen gain inolako eraginik sortu behar, eta horretarako M balioak behar bezain handia izan behar du. Ondoko graﬁkoan ikus daiteke murrizketa artiﬁzialaren M balioa nahiko han- dia bada, honek ez duela problemaren soluzioen eskualdean eraginik sortuko, gri- sez margotutako poligonoan alegia. OpenCourseWare, UPV/EHU  3.7. Murrizketa artiﬁzialaren metodoa 119 x1 x2 x1 + x2 = M opt (x ∗ 1, x ∗ 2 ) Baina, M balioa ez bada nahiko handia, hurrengo graﬁkoan ikus daitekeen bezala, soluzioen eskualdeko puntu batzuk galdu egiten dira; poligono grisean dauden baina marratuan ez dauden puntuak ez dira x1 + x2 ≤ M murrizketa artiﬁziala gehitu ondoreneko problemaren soluzioen eskualdekoak. x1 x2 x1 + x2 = M (x ∗ 1, x ∗ 2 ) opt Amaitzeko, problemaren bideragarritasun eskualdea bornegabea den kasuan murrizketa artiﬁziala gehitzen dugunean, M balioa oso handia izanda ere, bidera- garritasun eskualdeak puntuak galdu egingo ditu. Ondoko graﬁkoan ikus daiteke kasu hau. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  120 3. Dualtasuna x1 x2 x1 + x2 = M opt Aurreko bi kasuen ondorio gisa esan dezakegu murrizketa artiﬁzialaren nasaitze- aldagaia oinarri optimoan ez dagoenean, bi arrazoirengatik izan daitekeela: M balioa behar bezain handia ez delako edo soluzioa bornegabea delako. 3.7.2 Simplex dual algoritmoa murrizketa artiﬁzialarekin Helburua maximizatzea da. Nasaitze-aldagaiez osatutako hasierako B = I oina- rria aukeratu. 1. urratsa. Hasierako taula eraiki. 2. urratsa. Murrizketa artiﬁzialari dagokionez, • A matrizeko aj bektore guztietarako zj − cj ≥ 0 betetzen bada, 3. urratsera joan. • A matrizean zj − cj < 0 duen aj bektoreren bat existitzen bada, ere- duari murrizketa artiﬁziala gehitu, eredu berriarentzat hasierako tau- la eraiki eta ondoko oinarri aldaketa egin: Oinarrian sartuko da ondoko baldintza betetzen duen ak bektorea: zk − ck = min j { zj − cj / zj − cj < 0 }. Murrizketa artiﬁzialaren nasaitze-bektorea irtengo da oinarritik. Oinarrizko eragiketak egin errenkaden artean eta taulan bideragarrita- sun duala lortuko da. 3. urratsera joan. OpenCourseWare, UPV/EHU  3.7. Murrizketa artiﬁzialaren metodoa 121 3. urratsa. Bideragarritasun primala. • Murrizketa artiﬁzialik ez badago, – xBi ≥ 0, i = 1, . . . , m, bada, soluzioa optimoa da. Amaitu. – xBi < 0, i = 1, . . . , m, existitzen bada, soluzioa hobe daiteke. 4. urratsera joan. • Murrizketa artiﬁziala baldin badago,. – xBi ≥ 0, i = 1, . . . , m, bada, eta murrizketa artiﬁzialaren nasaitze- aldagaia oinarrian badago balio positiboz, soluzioa optimoa da. Amaitu. – xBi ≥ 0, i = 1, . . . , m, bada, eta murrizketa artiﬁzialaren nasaitze- aldagaia oinarrian ez badago edo oinarrian egonik zero balioa har- tzen badu, problema bornegabea da. Amaitu. – xBi < 0, i = 1, . . . , m, existitzen bada, soluzioa hobe daiteke. 4. urratsera joan. 4. urratsa. Oinarri-aldaketa. • Oinarritik irtengo da ondoko baldintza betetzen duen ar bektorea: xBr = min i { xBi / xBi < 0 }. r. errenkada pibot-errenkada da. • Oinarrian sartuko da ondoko baldintza betetzen duen ak bektorea: zk − ck yrk = max j { zj − cj yrj / yrj < 0 }. k. zutabea pibot-zutabea da. yrk elementua pibota da. 5. urratsera joan. r. errenkadan yrj negatiborik ez bada existitzen, problema biderae- zina da. Amaitu. 5. urratsa. Taula berria kalkulatu errenkaden artean oinarrizko eragiketak egi- nez. 3. urratsera joan. Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  122 3. Dualtasuna 3.8 Eredu linealen ebazpena Atal honetan, simplex dual aplikatu ahal izateko, murrizketa artiﬁzialaren erabil- pena beharrezkoa duten hiru adibide ebatziko ditugu. Adibidea. (Problema bideragarria.) 117. orrialdeko adibidea har dezagun. Ikusi dugu nasaitze- aldagaiez osatutako oinarri kanonikorako hasierako taulan ez dagoela ez bideragarritasun primalik, ezta dualik ere. Hortaz, beharrezkoa gerta- tuko da, simplex dual aplikatu ahal izateko, x1 + x2 ≤ M murrizketa artiﬁziala gehitzea. Lehenengo iterazioa. Hasierako taula eraikiko dugu (ikus 117. orrialdean). x1 x2 x3 x4 x5 −1 −6 0 0 0 0 0 a3 1 2 1 0 0 20 2 0 a4 −1 − 1 2 0 1 0 − 1 2 − 1 2 0 a5 1 1 0 0 1 M Bideragarritasun duala lortzeko, ondoko oinarri aldaketa egingo dugu. Oi- narrian sartuko da zj − cj negatiboen artean minimoari dagokion bektorea, a2, eta oinarritik irtengo da murrizketa artiﬁzialari dagokion nasaitze- bektorea, a5. Errenkaden artean oinarrizko eragiketak eginez, ondoko taula lortuko dugu: x1 x2 x3 x4 x5 5 0 0 0 6 6M 0 a3 −1 0 1 0 −2 −2M + 20 0 a4 − 1 2 0 0 1 1 2 1 2 M − 1 2 6 a2 1 1 0 0 1 M Egiazta daiteke taulan bideragarritasun duala lortu dela eta, orain, simplex dual algoritmoaren urratsekin jarrai daiteke. Oinarritik a3 bektorea irtengo da eta a5 bektorea sartuko da, eta oinarrizko eragiketak eginez, ondoko taula lortuko da: OpenCourseWare, UPV/EHU  3.8. Eredu linealen ebazpena 123 x1 x2 x3 x4 x5 2 0 3 0 0 60 0 a5 1 2 0 − 1 2 0 1 M − 10 0 a4 − 3 4 0 1 4 1 0 9 2 6 a2 1 2 1 1 2 0 0 10 Taula honetan bideragarritasun primala izatea lortu da, xB ≥ 0, eta murrizke- ta artiﬁzialaren nasaitze-bektorea oinarrian dago, x ∗ 5 = M − 10 balioa hartzen duelarik. Hortaz, taulan ageri den soluzio optimoa jatorrizko ereduari dagokio. Problemaren soluzio optimoa x ∗ 1 = 0, x ∗ 2 = 10 da, eta z ∗ = 60. 2 Adibidea. (Soluzio bornegabeko problema.) Izan bedi eredu lineal hau: max z = −4x1 + 5x2 hauen mende 2x1 + 2x2 ≥ 4 x1 − x2 ≥ 3 x1, x2 ≥ 0 Eredua maximizatze-forma simetrikoan idatzi ondoren, nasaitze-aldagaiak eta x2 ≤ M murrizketa artiﬁziala gehituko dizkiogu, eta honela geratuko da: max z = −4x1 + 5x2 + 0x3 + 0x4 + 0x5 hauen mende −2x1 − 2x2 + x3 = −4 −x1 + x2 + x4 = −3 x2 + x5 = M x1, x2, x3, x4, x5 ≥ 0 Simplex dual algoritmoa aplikatuz, ondoko taulak kalkulatuko ditugu: Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  124 3. Dualtasuna x1 x2 x3 x4 x5 4 −5 0 0 0 0 0 a3 −2 −2 1 0 0 −4 −2 0 a4 −1 1 0 1 0 −3 1 0 a5 0 1 0 0 1 M 4 0 0 0 5 5M 0 a3 −2 0 1 0 2 2M − 4 2 0 a4 -1 0 0 1 −1 −M − 3 5 a2 0 1 0 0 1 M 0 0 0 0 4 1 M − 12 0 a3 0 0 1 −2 4 4M + 2 −4 a1 1 0 0 −1 1 M + 3 5 a2 0 1 0 0 1 M Azkenengo taulan bideragarritasun primala eta duala daudenez, taula optimoa da. Dena den, murrizketa artiﬁzialaren nasaitze- bektorea, a5, ez dago oinarri op- timoan. Horrek esan nahi du problema bornegabea dela. 2 Adibidea. (Problema bideraezina.) Izan bedi ondoko eredu lineala: max z = 2x1 + x2 hauen mende x1 + x2 ≤ 2 −3x1 + x2 ≥ 3 x1, x2 ≥ 0 Ereduaren maximizatze-forma simetrikoari nasaitze-aldagaiak eta murrizketa artiﬁziala, x1 + x2 ≤ M, gehituz, honela geratuko da: OpenCourseWare, UPV/EHU  3.8. Eredu linealen ebazpena 125 max z = 2x1 + x2 + 0x3 + 0x4 + 0x5 hauen mende x1 + x2 +x3 = 2 3x1 − x2 +x4 = −3 x1 + x2 +x5 = M x1, x2, x3, x4, x5 ≥ 0 Ondoko taulan agertuko dira soluzio optimora iritsi arteko iterazioetan egin- dako kalkuluak: x1 x2 x3 x4 x5 −2 −1 0 0 0 0 0 a3 1 1 1 0 0 2 1 0 a4 3 −1 0 1 0 −3 3 0 a5 1 1 0 0 1 M 0 1 0 0 2 2M 0 a3 0 0 1 0 −1 −M + 2 0 0 a4 0 −4 0 1 −3 −3M − 3 2 a1 1 1 0 0 1 M − 1 4 0 0 0 1 4 5 4 5 4 M − 3 4 0 a3 0 0 1 0 −1 −M + 2 1 a2 0 1 0 − 1 4 3 4 3 4 M + 3 4 − 3 4 2 a1 1 0 0 1 4 1 4 1 4 M − 3 4 − 1 4 Ikastaroa: Ikerkuntza Operatiboa. Programazio Lineala  126 3. Dualtasuna x1 x2 x3 x4 x5 0 0 5 4 1 4 0 7 4 0 a5 0 0 −1 0 1 M − 2 1 a2 0 1 3 4 − 1 4 0 9 4 2 a1 1 0 1 4 1 4 0 − 1 4 Simplex dual algoritmoaren arabera, a1 bektoreak oinarritik irten beharko lu- ke, baina ez dago pibotik. Hortaz, ez da lortu xB ≥ 0 bideragarritasun primalik. Problema bideraezina da. 2 OpenCourseWare, UPV/EHU
