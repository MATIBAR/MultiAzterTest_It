   3 Gr¨ obnerren oinarriak 3.1. Ordena monomialak Indeterminatu bakar bateko polinomioak erabiltzen ditugunean, era natural batean ordenatzen ditugu: monomioen mailaren arabera. Adibidez, f (X) = X5 + 2X3 + X2 − 1 idatzi ohi dugu, eta ez f (X) = X2 + 2X3 − 1 + X5. Monomioak horrela ordenatzea funtsezkoa da zatiketaren algoritmoa aplikatzen dugunean. In- determinatu batekin baino gehiagorekin aritu nahi badugu, ordea, ez dago hain garbi zein prozedura jarraitu behar genuke monomioak ordenatzeko. Hori izango da hurrengo deﬁnizioaren helburua. Aurretik, notazio apur bat ﬁnkatuko dugu. Hemendik aurrera, X1, . . . , Xn indeterminatuekin eratu daitezkeen monomio guztien multzoa adierazteko Mon(X1, . . . , Xn) ikurra erabiliko dugu. Hau da, Mon(X1, . . . , Xn) = {X α1 1 . . . X αn n | αi ∈ N ∪ {0}, i = 1, . . . , n guztietarako}. Bereziki, 1 polinomio konstantea monomio modura ikusten ari gara, α1 = · · · = αn = 0 aukeratuz. Bestetik, α = (α1, . . . , αn) zenbaki oso ez- negatiboen tupla bat bada, X α1 1 . . . Xαn n monomioa laburkiago idazteko, X α ikurra erabiliko dugu. Ohartu notazio horrekin X αXβ = Xα+β dugula. 3.1. Deﬁnizioa. Izan bedi > Mon(X1, . . . , Xn) multzoaren gainean deﬁnituriko ordena-erlazio bat. Orduan, > ordena monomiala dela esaten dugu, hiru baldintza hauek betetzen badira: (OM1) Ordena osoa da: X α eta Xβ bi edozein monomio izanik, Xα > Xβ edo X β > Xα dugu. (OM2) Ordena ez da aldatzen monomio batez biderkatzean: X α > Xβ betetzen bada, eta X γ beste monomio bat bada, orduan XαXγ > XβXγ dugu. (OM3) Ordena ona da: monomioen edozein azpimultzo ez-hutsek elementu minimo bat du. Nabaria da, > ordena-erlazioa iragankorra izateagatik, (OM2)-ren bertsio oro- korrago hau betetzen dela: X α > Xβ eta Xγ > Xδ bada, orduan XαXγ > X β Xδ dugu. 78  3.1. ORDENA MONOMIALAK 79 Adibidez, X indeterminatu bakar batekin lan egiten ari bagara, orduan Xα monomioak α mailaren arabera ordenatzea ordena monomiala da. 3.2. Notazioa. Multzo batean > ordena-erlazio bat badugu, orduan: (i) a < b idatziko dugu, b > a dela beste modu batean adierazteko. (ii) a ≥ b idatziko dugu, a > b edo a = b dela adierazteko. (iii) a ≤ b idatziko dugu, a < b edo a = b dela adierazteko. 3.3. Lema. Izan bedi > ordena monomiala. Orduan: (i) X α ≥ 1 dugu, Xα monomio guztietarako. (ii) Baldin eta αi ≥ βi bada, i = 1, . . . , n guztietarako, orduan X α ≥ Xβ dugu. Froga. (i) Ordena monomialaren (OM3) propietatearengatik, Mon(X1, . . . , Xn) multzoak X β elementu minimo bat du. Garbi dago nahikoa dela Xβ ≥ 1 froga- tzea. Absurdora eramanez, demagun ez dela X β ≥ 1 betetzen. Horrek esan nahi du, (OM1) kontuan hartuz, X β < 1 dela. Orduan, desberdintza hori Xβ mono- mioaz biderkatuz, eta (OM2) propietatea erabiliz, X 2β < Xβ lortzen dugu. Hori kontraesan bat da, X β monomiorik txikiena da eta. (ii) Jarri γi = αi − βi ≥ 0, i guztietarako. Aurreko atalaren arabera, X γ ≥ 1 dugu. Desberdintza hori X β monomioaz biderkatuz, Xα ≥ Xβ ondorioztatzen dugu. Ohartu (ii) frogatzeko bakarrik erabili ditugula (OM2) propietatea eta monomio guztietarako X α ≥ 1 betetzen dela. 3.4. Proposizioa. Indeterminatu bakarra badugu, orduan ordena monomial ba- karra dago, mailaren araberakoa, alegia. Hau da, α, β ∈ N ∪ {0} badugu, orduan Xα > Xβ dugu baldin eta soilik baldin α > β bada. Froga. Izan bedi > ordena monomiala Mon(X) multzoaren gainean. Aurreko lemaren arabera, α ≥ β bada, Xα ≥ Xβ dugu. Beraz, > mailaren araberako ordena monomiala da. Emandako ordena-erlazio bat ordena monomiala dela frogatzean, zailena (OM3) ziurtatzea izaten da. Ondorengo teorema bereziki erabilgarria da, esaten baitigu nahikoa dela askoz baldintza errazago bat egiaztatzea. 3.5. Teorema. Ordena monomialaren deﬁnizioan, (OM3) baldintza beste honekin ordezka daiteke: (OM3) X α ≥ 1 betetzen da, Xα monomio guztietarako. Froga. Alde batetik, 3.3 lemaren arabera, badakigu (OM3) betetzen dela ordena monomial bat dugunean. Beraz, nahikoa da ikustea (OM3) propietatea (OM1), (OM2) eta (OM3) baldintzen ondorioa dela. Hori indeterminatuen kopuruaren gaineko indukzioa erabiliz frogatuko dugu. Hasi baino lehen, kontuan izan 3.3 Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.1. ORDENA MONOMIALAK 80 lemako (ii) propietatea egiazkoa dela ari garen baldintzetan  (ikusi lemaren frogaren osteko oharra). Erreferentziak errazteko asmoz, dei diezaiogun  (P) propietate horri froga honetan zehar. Lehenengo eta behin, demagun X indeterminatu bakarra dugula. Orduan, (P) propietateagatik, α ≥ β bada Xα ≥ Xβ dugu, eta > erlazioa mailaren araberako ordena monomiala da. Azter dezagun orain kasu orokorra. Ohartu > erlazioa Mon(X1, . . . , Xn−1) multzoaren gainean ere deﬁniturik dagoela eta, indukzio-hipotesiagatik, multzo horretan ordena monomiala dela. Ikusteko (OM3) betetzen dela, har dezagun S ⊆ Mon(X1, . . . , Xn) azpimultzo orokor bat. Deﬁni ditzagun ϕ : Mon(X1, . . . , Xn) −→ Mon(X1, . . . , Xn−1) X α1 1 . . . Xαn n −→ X α1 1 . . . X αn−1 n−1 eta ψ : Mon(X1, . . . , Xn) −→ Mon(Xn) X α1 1 . . . Xαn n −→ Xαn n aplikazioak. Orduan, ϕ(S) multzoak elementu minimo bat du, X γ1 1 . . . X γn−1 n−1 . Mo- nomio hori S-ko monomio batetik dator; demagun q = X γ1 1 . . . Xγn n dela monomio hori. Laburtzeagatik, jarri k = γn. Orain, 0 ≤ i ≤ k − 1 bakoitzeko, izan bedi Si = ψ −1(Xi n) ∩ S. Bestela esanda, Xn-ren berretura X i n-ren berdina duten S-ko monomioek osatzen dute Si multzoa. Izan bedi pi ∈ Mon(X1, . . . , Xn−1) mono- mioa ϕ(Si) multzoko minimoa, eta jarri qi = piX i n. Orduan, > erlazioa ordena osoa denez, {q0, . . . , qk−1, q} multzo ﬁnituak m monomio minimo bat du. Ikus dezagun m S-ko minimoa dela. Horretarako, hartu edozein monomio s = X α1 1 . . . Xαn n ∈ S. Jarri i = αn. Baldin eta i ≤ k − 1 bada, orduan Si multzoa deﬁniturik dago eta s ∈ Si dugu. Orduan, ϕ(s) ≥ pi betetzen da eta, (OM2) propietatea erabiliz, s = ϕ(s)Xi n ≥ piX i n = qi ≥ m dugu. Demagun orain i ≥ k dela. Orduan, (P) propietateagatik, Xi n ≥ X k n dugu. Desberdintza hori eta X α1 1 . . . X αn−1 n−1 ≥ X γ1 1 . . . X γn−1 n−1 biderkatuz (horretarako (OM2) baino ez dugu behar), s ≥ q ≥ m lortzen dugu. Laburbilduz, edozein kasutan s ≥ m dugu, eta horrek m S-ko monomio minimoa dela frogatzen du. Teorema horren arabera, ordena monomialaren deﬁnizioa (OM1), (OM2) eta (OM3) propietateak eskatuz ere eman ahal genuen. Hala ere, (OM3) propietatea esplizituki eskura izatea oso garrantzitsua da, horrek ziurtatuko baitu ondoren- go orrialdeetan garatuko ditugun algoritmoak amaitu egingo direla. Horretarako, proposizio hau behar dugu. 3.6. Proposizioa. Izan bedi > ordena monomiala. Orduan, ez da existitzen mo- nomioen kate hertsiki beherakor inﬁniturik. Froga. Demagun {X αi } i≥1 monomioen kate hertsiki beherakor inﬁnitu bat dela. Orduan, ordena monomialaren deﬁnizioko (OM3) propietatearen arabera, existitzen da elementu minimo bat kate horretan, demagun X αm dela. Hori kontraesan bat da, X αm > Xαm+1 da eta. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.1. ORDENA MONOMIALAK 81 Orain, ordena monomialen adibide nagusiak emateko moduan gaude. 3.7. Adibideak. 1) Ordena lexikograﬁkoa (lex; ingelesez, lexicographic order ): X α > Xβ ⇐⇒ ∃i ∈ {1, . . . , n} non α1 = β1, . . . , αi−1 = βi−1, αi > βi. Bestela esanda, bi monomio konparatzeko, ezkerraldetik hasten gara begiratzen Xi bakoitzaren berretzailea bi monomioetan, eta berretzaile desberdinak lehenengo aldiz topatzen ditugunean, berretzaile handienekoa besteari inposatzen zaio. Espli- zituki adierazi nahi dugunean lex ordena erabiltzen ari garela, >lex idatziko dugu > ikurraren ordez. 2) Ordena lexikograﬁko mailakatua (grlex; ingelesez, graded lexicographic or- der ). Kasu honetan, bi monomio konparatzeko honela jokatzen dugu: (i) Lehenengo, monomioen maila osoari begiratzen diogu: desberdinak badira, maila osorik altuena duena handiagoa da. (ii) Bi monomioek maila oso bera dutenean, lex ordena erabiltzen dugu mono- mioak ordenatzeko. Esplizituki adierazi nahi dugunean grlex ordena erabiltzen ari garela, >grlex idatziko dugu > ikurraren ordez. 3) Alderantzizko ordena lexikograﬁko mailakatua (grevlex; ingelesez, graded re- verse lexicographic order ). Kasu honetan, bi monomio konparatzeko honela joka- tzen dugu: (i) Lehenengo, monomioen maila osoari begiratzen diogu: desberdinak badira, maila osorik altuena duena handiagoa da. (ii) Bi monomioek maila oso bera dutenean, honela desegiten dugu berdinketa: X α > Xβ ⇐⇒ ∃i ∈ {1, . . . , n} non αn = βn, . . . , αi+1 = βi+1, αi < βi. Bestela esanda, bi monomio konparatzeko, eskuinaldetik hasten gara begi- ratzen Xi bakoitzaren berretzailea bi monomioetan, eta berretzaile desber- dinak lehenengo aldiz topatzen ditugunean, berretzaile txikienekoa besteari inposatzen zaio. Esplizituki adierazi nahi dugunean grevlex ordena erabiltzen ari garela, >grevlex idatziko dugu > ikurraren ordez. Adibide horietan, zein monomio den handiagoa erabakitzeko, eskuinaldetik edo ezkerraldetik irakurtzen ditugu eta, hortaz, garrantzitsua da monomioak X α1 1 . . . Xαn n moduan idazten ditugula: X1-en berretura lehenengo, gero X2-rena, eta horre- la jarraituz, azkenik Xn-rena. Bereziki, aurreko ordena monomial guztietarako X1 > X2 > · · · > Xn dugu. Monomioak idazteko orduan indeterminatuak beste modu batean ordenatzen baditugu, hau da, indeterminatuen arteko ordena alda- tzen badugu, orduan lex, grlex eta grevlex ordenen beste aldera batzuk lortzen ditugu. Kontuan izanik n indeterminatuak ordenatzeko n! aukera ditugula, beste horrenbeste posibilitate ditugu lex, grlex edo grevlex ordenak deﬁnitzeko orduan. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.1. ORDENA MONOMIALAK 82 3.8. Adibideak. 1) Hartzen badugu X > Y > Z, orduan XZ >lex Y 2, XZ >grlex Y 2, Y 2 > grevlex X Z, XZ >lex Y 3, Y 3 > grlex X Z, Y 3 > grevlex X Z. 2) Hala ere, Y > Z > X hartuz gero, Y 2 > XZ eta Y 3 > XZ dugu beti, > ordena lex, grlex edo grevlex denean. Ez da pentsatu behar grevlex, alderantzizko ordena lexikograﬁko mailakatua, grlex ! ordena mailakatuarekin bat datorrela, indeterminatuak alderantzizko ordenan  (hau da, Xn > · · · > X1) jarriz gero. Adibidez, X > Y > Z hartuta, Y 2 >grevlex XZ dugu, eta Z > Y > X hartuta, berriz, XZ >grlex Y 2. Ordena monomial bat behin ezarrita, polinomio bat osatzen duten monomioak ordena horren arabera idatz ditzakegu eta, horrela, zentzua du polinomio baten gai nagusiari buruz edo antzeko kontzeptuei buruz hitz egiteak. Hemendik aurrera, gai honetan K gorputza izango da. 3.9. Deﬁnizioa. Izan bitez > ordena monomiala eta f ∈ K -ren ideala. Ikus dezagun ea f = Y − X2 eta g = Z − X3 polinomioek a-ren Gr¨ obnerren oinarri bat osatzen duten. Dakigunez, kontzeptu hori erlatiboa da, eta erantzuna aukeratzen dugun ordena monomialaren araberakoa izan daiteke. Bi kasu aztertuko ditugu: (i) Ordena monomiala lex bada, X > Y > Z harturik. Orduan, LM(f ) = X2 eta LM(g) = X3 dugu. Beraz, S(f, g) = −Xf + g = −XY + Z. Zatitu dezagun S-polinomio hau (f, g) tuplaz: −XY + Z −X2 + Y −XY Z −X3 + Z Z 0 Beraz, zatiketaren hondarra −XY + Z = 0 da, eta {f, g} ez da kasu honetan Gr¨ obnerren oinarria. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.4. S-IRIZPIDEA ETA BUCHBERGERREN ALGORITMOA 101 (ii) Ordena monomiala lex bada, Z > Y > X harturik. Kasu horretan, LM(f ) = Y eta LM(g) = Z dugu. Ondorioz, S(f, g) = Zf − Y g = −X 2Z + X3Y. Berriro ere, S-polinomioa (f, g) tuplaz zatitu behar dugu: −X2Z + X3Y Y − X2 −X2Z + X5 X3 X3Y − X5 Z − X3 X3Y − X5 −X2 0 Beraz, zatiketaren hondarra 0 da, eta {f, g} Gr¨ obnerren oinarria da aipatu dugun ordena monomialarekiko. Dakusagunez, gerta daiteke multzo bat Gr¨ obnerren izatea ordena monomial bate- kiko, eta ez izatea beste batekiko. Adibide honekin, berriro ere azpimarratu nahi dugu Gr¨ obnerren oinarria izateko propietatea erlatiboa dela. Dagoeneko, atal honen hasieran egindako lehenengo galderari erantzun diogu, eta badugu irizpide bat sistema sortzaile bat Gr¨ obnerren oinarria den edo ez jakite- ko. Hurrengo teoreman, bigarren galderaz arduratuko gara:  sistema sortzaile hori Gr¨ obnerren oinarria ez bada, nola lor dezakegu Gr¨ obnerren oinarri bat emandako sistema sortzailea erabiliz? Ideia ondorengo lematik ateratzen dugu. 3.29. Lema. Demagun f polinomioa (f1, . . . , fs)- rekin zatitzeko hondarra r dela. Orduan, f (f1, . . . , fs, r)-rekin zatitzen dugunean 0 hondarra lortzen dugu. Froga. Notazioa sinpliﬁkatzearren, jarri F =  (f1, . . . , fs). Lehenengo eta behin, beste emaitza hau frogatuko dugu: f − r polinomioa F -rekin zatitzeko hondarra 0 dela. Absurdora eramanez, demagun faltsua dela. Aukera dezagun kontradibide bat, LM(f ) monomioa minimoa den moduan. Izan bedi r = 0, f − r polinomioa F -rekin zatituz lortzen den hondarra. Orain, bi kasu bereizten ditugu: (i) LT(f − r) = LT(f ). Hori gertatzen da baldin eta soilik baldin LM(r) < LM(f ) bada. (Gogoan izan zatiketaren algoritmo orokortuaren funtzio- namendua.) Kontuan hartzen badugu LT(r) dela, f F -rekin zatitzean, hondarrera eramaten den lehenengo gaia, ondorioztatzen dugu zatiketa ho- rren lehenengo pausoan LT(f ) LT(fi)-ren batekin zatigarria dela. Orduan, LT(f ) = qiLT(fi) bada, zatiketa egiten jarraituko dugu g = f − qifi zati- kizun berriarekin. Bestalde, LT(f − r) = LT(f ) denez, f − r polinomioa F -rekin zatitzeko, lehenengo pausoa berbera da eta (f − r) − qifi = g − r zatikizun berria lortuko dugu. Orain, g F -rekin zatitzen badugu, hondarra r da. (Azken batean, f -rekin egiten dugun zatiketa bera da, baina pauso bat geroago hasita.) Era berean, g − r F -rekin zatituz r = 0 hondarra lortzen dugu. Hori kontraesan bat da, g polinomioa ez delako frogatu nahi dugun emaitzaren kontradibide bat, LM(g) < LM(f ) izateagatik. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.4. S-IRIZPIDEA ETA BUCHBERGERREN ALGORITMOA 102 (ii) LT(f − r) = LT(f ). Hori gertatzen da baldin eta soilik baldin LM(r) = LM(f ) bada. Orduan, f -ren zatiketan lehenengo pausoa eman eta gero, lortzen dugun zatikizun berria g = f − LT(r) da, LT(r) hondarrera doa eta. Ohartu, gainera, g F -rekin zatitzeko hondarra r = r − LT(r) dela. (Hori, berriro ere, f -ren zatiketaren parte bat da.) Orain, kontuan hartuz LM(g) < LM(f ) dela eta f kontradibide minimoa dela, ondorioztatzen dugu g − r -ek 0 hondarra ematen duela F -rekin zatitzean. Baina, g − r = (f − LT(r)) − (r − LT(r)) = f − r denez, horrek esan nahi luke f ez dela kontradibide bat. Horrenbestez, emaitza laguntzailea frogaturik gelditzen da. Orain, erraz ikus deza- kegu enuntziatuko propietatea betetzen dela. Izan ere, demagun {f (i)} dela f - ren zatiketan agertzen diren zatikizunen segida. Orduan, f  (j) baldin bada gai nagusia hondarrera eramaten duen lehenengo zatikizuna, konturatzen gara f (j) F - rekin za- tituz r hondarra lortzen dugula. Aurreko paragrafoko emaitzaren arabera, f (j) −r-k 0 hondarra ematen du F - rekin zatitzean. Ikus dezagun, beste alde batetik, zer ger- tatzen den f polinomioa  (f1, . . . , fs, r) tupla luzatuaz zatitzen badugu. Orduan, lehenengo j − 1 pausoetan fi polinomioak erabil ditzakegu zatikizunen gai nagusiak ezabatzeko eta, beraz, j. zatikizuna f  (j) da. Esan dugun bezala, polinomio horren gai nagusia hondarrera doa F -rekin zatitzean. Beraz, LT(f (j)) = LT (r) dugu eta zatiketaren ondorengo pausoan r polinomioa erabiliko dugu LT(f (j)) ezabatzeko. Beraz, hurrengo zatikizuna f (j) − r da. Ikusi dugunez, f (j) − r- k 0 hondarra ematen du F - rekin zatitzean. Horrek esan nahi du zatiketak aurrera egin ahala, zatikizu- nen gai nagusiak beti izango direla LT(fi)-ren batez zatigarriak. Ondorioz, f (j) − r (f1, . . . , fs, r)- rekin zatituz gero, inoiz ez gara helduko r erabiltzera. Horrela, tupla luzatuaz zatituz ere f (j) − r-k 0 hondarra ematen du. Azkenik, f  (j) − r polinomioa f -ren zatiketan zatikizun modura agertzen denez, f (f1, . . . , fs, r)- rekin zatitzean lortzen den hondarra ere 0 da. 3.30. Teorema (Buchbergerren algoritmoa). Izan bitez a polinomioen ideal ez- nulua, eta {f1, . . . , fs} a-ren sistema sortzailea. Jarri G0 = ∅ eta G1 =  (f1, . . . , fs), eta errepikatu ondorengo pausoak i ≥ 1 guztietarako: (BA1) Deﬁnitu Gi+1 = Gi. (BA2) f ∈ Gi Gi−1 eta g ∈ Gi guztietarako, kalkulatu S(f, g) polinomioa eta zatitu Gi-rekin, Gi-ko polinomioak nahi dugun bezala zerrendatuz. (Nahi izanez gero, zerrendatzeko modu desberdinak aukera ditzakegu (f, g) bikote desberdinetarako.) (BA3) Aurreko ataleko zatiketaren hondarra 0 ez den kasu guztietan, birdeﬁnitu Gi+1 tupla, hondar hori azken posizioan gehituz. Orduan, existitzen da m, halakoa non Gm = Gm+1 baita (hau da, (BA2) pausoan S-polinomio guztiek 0 hondarra ematen dute), eta Gm a-ren Gr¨ obnerren oinarria da. Froga. Alde batetik, Gi+1-en deﬁnizioagatik, Gi ⊆ Gi+1 dugu. Kontuan izanik G1 = (f1, . . . , fs) a-ren sistema sortzailea dela, Gi ere a- ren sistema sortzailea da i ≥ 1 guztietarako. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.4. S-IRIZPIDEA ETA BUCHBERGERREN ALGORITMOA 103 Ikus dezagun algoritmoa gelditzen dela, hau da, badagoela m, non Gm = Gm+1 baita. Absurdora eramanez, demagun Gi Gi+1 dela i guztietarako. Orduan, exis- titzen da S(f, g) polinomio bat, f, g ∈ Gi izanik, halakoa non h = S(f, g) Gi honda- rra 0-ren desberdina baita. Horrela, h-ren gai nagusia ez da Gi- ko polinomioen gai nagusiaz zatigarria eta, 3.15 teoremaren arabera, LT(h) ∈ (LT(Gi)) dugu. Beraz, (LT(Gi)) (LT(Gi+1)) partekotasun hertsia dugu. Orduan, (LT (G1)) · · · (LT(Gi)) (LT(Gi+1)) · · · idealen kate hertsiki gorakor inﬁnitu bat dugu. Baina hori ezinezkoa da, Hilberten oinarriaren teoremaren arabera. Azkenik, ikus dezagun Gm a-ren Gr¨ obnerren oinarria dela. Aplikatzen badugu S-irizpidea, hori frogatzeko S(f, g) Gm = 0 dela egiaztatu behar dugu f, g ∈ Gm guz- tietarako. Orain, Gm = Gm+1 izateagatik eta Gm+1-en eraikuntzagatik, hondarra 0 da f ∈ Gm Gm−1 edo g ∈ Gm Gm−1 denean. (Gogoratu S(g, f ) = −S(f, g) dela.) Beste alde batetik, f, g ∈ Gm−1 bada, har dezagun i ∈  {1, . . . , m − 1} ahal den txikiena, non f, g ∈ Gi baita. Beraz, polinomioetako bat Gi Gi−1-en dago. Orduan, bi kasu bereizten ditugu: (i) S(f, g) Gi = 0. Orduan, S(f, g) Gm-rekin zatitzeko, zerrenda ditzagun Gm- ko elementuak modu honetan: hasieran, Gi-koak (S(f, g) Gi = 0 lortzen genuen ordena berean), eta gero gainerako guztiak. Horrela, zatiketaren algoritmoaren prozeduragatik, garbi dago S(f, g) Gm = 0 dugula. (ii) S(f, g) Gi = 0. Beraz, Gi+1 eraikitzen dugunean, Gi multzoari r = S(f, g) Gi polinomioa gehituko diogu. Orduan, S(f, g) Gm-rekin zatitzeko, zerrenda ditzagun Gm-ko elementuak modu honetan: hasieran, Gi-koak (S(f, g)-k r hondarra ematen duen ordena berean), gero r, eta azkenik Gm-ko gainerako polinomio guztiak. Aurreko lemaren arabera, zatiketa Gi ∪ {r} multzoare- kin (r azken posizioan izanik) bakarrik egiten badugu, orduan S(f, g)-k 0 hondarra ematen du. Ondorioz, zatiketaren algoritmo orokortuaren funtzio- namendua kontuan izanik, S(f, g) Gm = 0 ere lortzen dugu. Aurreko teoremaren frogan, oso garrantzitsua izan da, Gi multzoaz zatitzean, polinomioak edozein modutan zerrenda ditzakegula. Hori praktikan ere oso lagun- garria da. Adibidez, S(f, g) polinomioa kalkulatu eta gero, konturatzen bagara h ∈ Gi polinomio baten multiploa dela, orduan S-polinomio horrek ez du ekarpe- nik izango Gi+1 multzoan: izan ere, S(f, g) Gi- rekin zatitzeko orduan h lehenengo posizioan jartzen badugu, orduan zuzenean lortzen dugu zatiketaren hondarra 0 dela. 3.31. Adibidea. Gogoratu {Y − X2, Z − X3} sistema sortzailea ez dela a = (Y − X2, Z − X3) idealaren Gr¨ obnerren oinarria lex ordenarekiko, X > Y > Z hartuz gero. Aplika diezaiogun Burchbergerren algoritmoa sistema sortzaile horri, Gr¨ obnerren oinarri bat lortzeko. Hasteko, jarri f1 = −X 2 + Y eta f2 = −X3 + Z (ohartu polinomioak emandako ordena monomialarekiko ordenatu ditugula), eta Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 104 jarri G1 = {f1, f2}. Hauek dira eman behar diren pausoak (ez ditugu kalkuluak idatziko, errazak dira eta): (P1) S(f1, f2) = −Xf1 + f2 = −XY + Z eta f3 = S(f1, f2) G1 = −XY + Z dugu. Jarri G2 = {f1, f2, f3}. (P2) S(f1, f3) = −Y f1 + Xf3 = XZ − Y 2 eta f4 = S(f1, f3) G2 = XZ − Y 2 dugu. Beste alde batetik, S(f2, f3) = −Y f2 + X 2f3 = X2Z − Y Z = −Zf1 denez, badakigu S-polinomio horren hondarra 0 izango dela. Jarri G3 = {f1, f2, f3, f4}. (P3) S(f1, f4) = −Zf1 − Xf4 = XY 2 − Y Z = −Y f3 denez, S-polinomio horre- tatik ez dugu ezer lortzen. Beste alde batetik, S(f2, f4) = −Zf2 − X 2f4 = X2Y 2 − Z2 dugu eta, zatiketa eginez, f5 = S(f2, f4) G3 = Y 3 − Z2. Azkenik, S(f3, f4) = −Zf3 − Y f4 = Y 3 − Z2 eta S(f3, f4) G3 = Y 3 − Z2 aurreko berbera da. Jarri G4 = {f1, f2, f3, f4, f5}. (P4) S(f1, f5) = −Y 3f1 − X2f5 = X2Z2 − Y 4 eta S(f1, f5) G4 = 0 dugu. Era berean, S(f2, f5) = −Y 3f2 − X3f5 = X3Z2 − Y 3Z eta S(f2, f5) G4 = 0 dugu. Ohartu S(f3, f5) = −Y 2f3 − Xf5 = XZ2 − Y 2Z = Zf4 dela; beraz, S-polinomio hori ez dugu kontuan hartu behar. Bukatzeko, S(f4, f5) = Y 3f4 − XZf5 = XZ 3 − Y 5 eta S(f4, f5) G4 = 0 dugu. Azken pausoan S-polinomio guztien hondarra 0 denez, G5 = G4 dugu eta G4 = {−X2 + Y, −X3 + Z, −XY + Z, XZ − Y 2, Y 3 − Z2} a-ren Gr¨ obnerren oinarria da. 3.5. Gr¨ obnerren oinarri minimalak eta laburtuak Eman dugun azken adibideak erakusten duenez, Buchbergerren algoritmoa apli- katzen dugunean, lortzen dugun Gr¨ obnerren oinarria hasierako sistema sortzailea baino askoz luzeagoa izan daiteke. Hala ere, batzuetan, polinomio batzuk ken di- tzakegu, Gr¨ obnerren oinarria izateko propietatea galdu gabe. 3.32. Lema. Izan bedi G a-ren Gr¨ obnerren oinarria. Demagun existitzen dire- la g, h ∈ G desberdinak, non LT(g) | LT(h) baita. Orduan, G {h} ere a-ren Gr¨ obnerren oinarria da. Froga. Izan bedi f ∈ a ez-nulua. Orduan, nahikoa da LT(f ) gai nagusia G {h}- ko polinomio baten gai nagusiaz zatigarria dela ikustea, 3.21 teoremaren arabera. Kontuan hartzen badugu G a-ren Gr¨ obnerren oinarria dela, badakigu existitzen dela q ∈ G, non LT(q) | LT(f ) baita. Orain bi aukera daude: (i) q ∈ G {h}. (ii) q = h. Orduan, LT(g) | LT(h) | LT(f ) dugu, eta g ∈ G {h}. Edozein kasutan, nahi genuen emaitza betetzen da. Esate baterako, 3.31 adibidean, {−X2 + Y, −X3 + Z, −XY + Z, XZ − Y 2, Y 3 − Z2} Gr¨ obnerren oinarria lortu dugu (lex ordenarekin, X > Y > Z harturik), eta Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 105 konturatzen gara −X2 +Y polinomiaren gai nagusiak −X3 +Z-rena zatitzen duela. Azken lemaren arabera, −X3 +Z polinomioa ezaba dezakegu eta {−X2 +Y, −XY + Z, XZ − Y 2, Y 3 − Z2} ere emandako idealaren Gr¨ obnerren oinarria da. Jarraian ikusten dugunez, Gr¨ obnerren oinarririk txikienak lortzeko, nahikoa da aurreko lema behin eta berriz aplikatzea. 3.33. Deﬁnizioa. Izan bitez a polinomioen ideal ez-nulua eta G a-ren Gr¨ obnerren oinarria. Orduan, G a-ren Gr¨ obnerren oinarri minimala dela esango dugu, G-ren azpimultzo propioen artean ez badago a-ren Gr¨ obnerren oinarririk. Beste testuliburu batzuetan, Gr¨ obnerren oinarri minimalaren deﬁnizioan, po- linomio guztien koeﬁziente nagusia 1 izateko eskatzen da. Hala ere, guk ez dugu baldintza hori exijituko. Hurrengo teoremak dioenez, begirada soil batekin jakin dezakegu Gr¨ obnerren oinarri bat minimala den edo ez. 3.34. Teorema. Izan bedi G = {g1, . . . , gt} a-ren Gr¨ obnerren oinarria. Orduan, G Gr¨ obnerren oinarri minimala da baldin eta soilik baldin propietate hau betetzen badu: gi, gj ∈ G desberdinak badira, orduan LT(gi)-k ez du LT(gj) zatitzen. Froga. Izan bedi G Gr¨ obnerren oinarri minimala, eta demagun existitzen direla gi, gj ∈ G desberdinak, non LT(gi) | LT (gj) baita. Orduan, 3.32 lemaren arabera, G {gj} ere a-ren Gr¨obnerren oinarria da. Hori ezinezkoa da, G oinarri minimala izateagatik. Beraz, LT(gi) LT(gj) dugu i = j guztietarako. Orain, frogatu dezagun alderantzizko inplikazioa. Demagun G-ko polinomioen gai nagusiek enuntziatuko propietatea betetzen dutela, eta ikus dezagun G oinarri minimala dela. Horrela ez balitz, G oinarriari gj polinomio bat ken geniezaioke, eta oraindik ere Gr¨ obnerren oinarri bat izango genuke. Baina, orduan, 3.21 teore- maren arabera, existituko litzateke gi ∈ G {gj}, non LT(gi) | LT(gj) baita. Hori hipotesiaren kontra doa. Beraz, {−X2 + Y, −XY + Z, XZ − Y 2, Y 3 − Z2} multzoa a = (Y − X2, Z − X3) idealaren Gr¨ obnerren oinarri minimala da lex ordenarekiko, X > Y > Z harturik. Polinomioen ideal baten G Gr¨ obnerren oinarri bat ez bada minimala, garbi dago G-ren barruan oinarri minimal bat topa dezakegula: nahikoa da, Gr¨ obne- rren oinarriak diren G- ren azpimultzoen artean, elementu kopururik txikiena duen bat aukeratzea. Aurreko teoremak metodo azkarrago bat ematen digu oinarri mi- nimal hori lortzeko. Izan ere, G ez bada Gr¨ obnerren oinarria, h ∈ G polinomio baten gai nagusia g ∈ G beste baten gai nagusiaz zatigarria da, eta h G-tik ken dezakegu, oraindik ere Gr¨ obnerren oinarri bat izanik. Prozedura hori behin eta berriz errepikatuz, joango gara polinomioak banan- banan kenduz, gai nagusien ar- teko zatigarritasun guztiak ezabatu arte. Orduan, gelditzen zaizkigun polinomioek Gr¨ obnerren oinarri minimal bat osatuko dute. Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 106 3.35. Teorema. Izan bedi G a-ren Gr¨ obnerren oinarri minimala. Orduan, G a -ren Gr¨ obnerren beste oinarri bat bada (ordena monomial berarekiko), baliokideak dira: (i) G ere Gr¨ obnerren oinarri minimala da. (ii) |G | = |G|. Froga. (i)⇒ (ii). Kasu honetan, G eta G oinarri minimalak dira eta, egoeraren si- metriagatik, |G| = |G | dela frogatzeko, nahikoa da |G| ≤ |G | desberdintza ikustea. Gogoratu, G Gr¨ obnerren oinarria izateagatik, g ∈ G bakoitzerako existitzen dela g ∈ G , non LT(g ) | LT(g) baita. Ikusten badugu g, h ∈ G bi elementu desberdi- nei g , h ∈ G desberdinak dagozkiela, orduan |G| ≤ |G | lortuko dugu zuzenean. Absurdora eramanez, demagun g = h dela. Orain, G Gr¨ obnerren oinarria dela erabiliz, badago f ∈ G, non LT(f ) | LT(g ) = LT(h ) baita. Ondorioz, LT(f )-k bai LT(g) bai LT(h) zatitzen ditu. Kontuan hartzen badugu g eta h desberdinak direla, f = g edo f = h izan beharko dugu. Beraz, G- ko polinomio baten gai nagu- siak G-ko beste polinomio baten gai nagusia zatitzen du. Baina, 3.34 teoremaren arabera, hori ezinezkoa da, G oinarri minimala da eta. (ii)⇒(i). Badakigu G -en barruan G oinarri minimal bat aurki dezakegula. Ikus dezagun G = G dela. Horretarako, ohartu |G | = |G| dugula, (i) atalaren arabera, eta |G | = |G| dela, hipotesiaren arabera. Ondorioz, |G | = |G | dugu, eta G G -en azpimultzoa denez, G = G dela ondorioztatzen dugu. Beraz, polinomioen ideal baten Gr¨ obnerren oinarri minimal guztiek elementu kopuru bera dute (ordena monomial berarekiko hartzen baditugu, jakina). Adi- bidez, lex ordenarekiko, X > Y > Z harturik, a = (Y − X2, Z − X3) idealaren Gr¨ obnerren oinarri guztiek launa elementu dituzte gutxienez, a bi polinomiorekin sor daitekeen arren. Ordena monomial desberdinak erabiliz gero, oinarri minimalek elementu kopuru ! desberdinak izan ditzakete. Aurretik ikusi dugun bezala, {Y −X2, Z −X3} multzoa a = (Y − X2, Z − X3) idealaren Gr¨ obnerren oinarria da lex ordenarekiko, Z > Y > X harturik. Garbi dago, gainera, oinarri minimala dela. Hala ere, 2 elementu baino ez ditu, eta ez 4, lex ordena X > Y > Z jarrita hartzen dugun kasuan bezala. Garrantzitsua da azpimarratzea polinomioen ideal batek ez duela, oro har, Gr¨ obnerren oinarri minimal bakar bat (ordena monomiala ﬁnkatu eta gero), nahiz eta oinarriko polinomioei monikoak izateko eskatu. Adibide bat emateko, ondoren- go lema lagungarria da. 3.36. Lema. Izan bedi G a-ren Gr¨ obnerren oinarria, eta demagun G ⊆ a multzoak LM(G ) = LM(G) betetzen duela. (Hori beteko da, bereziki, LT(G ) = LT(G) bada.) Orduan, G ere a-ren Gr¨ obnerren oinarria da. Froga. Izan bedi f ∈ a ez-nulua. Orduan, G a-ren Gr¨ obnerren oinarria izatea- gatik, existitzen da g ∈ G, non LT(g) | LT(f ) baita. Orain, LM(G) = LM(G ) Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 107 baldintza betetzen denez, badago g ∈ G , non LM(g ) = LM(g) baita. Beraz, LT(g )-en eta LT(g)-ren arteko diferentzia bakarra faktore konstante ez- nulu bat da. Horrenbestez, LT(g ) | LT(f ) dugu eta, 3.21 teoremaren arabera, G ere a- ren Gr¨ obnerren oinarria da. Adibidez, hartu lex ordena, Z > Y > X izanik, eta jarri a = (Y − X2, Z − X3). Badakigunez, G = {Y − X2, Z − X3} a-ren Gr¨ obnerren oinarri minimala da. Kentzen badiogu G-ko bigarren polinomioari lehenengoa bider X, orduan G = {Y − X2, Z − XY } multzo berria lortzen dugu. Azken lemaren arabera, G a-ren Gr¨ obnerren oinarria da, G ⊆ a eta LT(G ) = LT(G) delako (bigarren polinomioa aldatu dugu, baina haren gai nagusia, ez). Gainera, G oinarri minimala da, 2 elementu baititu, G oinarri minimalak beste. Gai hau bukatzeko, Gr¨ obnerren oinarrien artean mota bat bereiziko dugu, oi- narri laburtuak. Ikusiko dugunez, ideal bakoitzak oinarri laburtu bakarra izango du, oinarri minimalekin gertatzen den ez bezala. 3.37. Deﬁnizioa. Izan bitez a polinomioen ideal ez-nulua eta G a-ren Gr¨ obne- rren oinarria. Orduan, G a-ren Gr¨ obnerren oinarri laburtua dela esango dugu, bi baldintza hauek betetzen badira: (i) h ∈ G edozein harturik, h-ren gai bat ere ez da LT(g) gai nagusi batez zatigarria, g ∈ G eta g = h izanik. (ii) G-ko polinomio guztien koeﬁziente nagusia 1 da. Garbi dago oinarri laburtuak minimalak direla, bereziki. Izan ere, polinomioen koeﬁziente nagusien gaineko baldintza alde batera utzirik, hau da oinarri mini- mal baten eta oinarri laburtu baten arteko diferentzia:  lehenengo kasuan, bakarrik eskatzen dugu h- ren gai nagusia ez izatea zatigarria g beste polinomio baten gai nagusiaz; bigarrenean, berriz, h- ren gai guztiek bete behar dute baldintza hori. 3.38. Adibidea. Har dezagun lex ordena monomiala Mon(X, Y, Z) multzoan, Z > Y > X izanik. Lehenago ikusi dugun bezala, G = {Y − X2, Z − X3} eta G = {Y − X2, Z − XY } multzoak a = (Y − X2, Z − X3) idealaren Gr¨ obnerren oinarri minimalak dira. Orain, G laburtua da, eta G ez da: ohartu Z − XY polinomioan, −XY gaia Y − X2 beste polinomioaren gai nagusiaz zatigarria dela. Orain, galdera batzuk sortzen zaizkigu. Ba al dute polinomioen ideal ez-nulu guztiek Gr¨ obnerren oinarri laburturik? Hala bada, zein modutan lor dezakegu oinarri laburtu bat? Erantzuna hurrengo teoreman ematen dugu. 3.39. Lema. Izan bitez G eta G a-ren Gr¨ obnerren bi oinarri minimal, ordena monomial berarekiko. Orduan, LM(G) = LM(G ) dugu. Froga. Simetriagatik, nahikoa da LM(G) ⊆ LM(G ) partekotasuna frogatzea. Izan bedi g ∈ G edozein. Orduan, g ∈ a denez eta G a-ren Gr¨ obnerren oinarria Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 108 denez, existitzen da g ∈ G , non LM(g ) | LM(g) baita. Argudio hori alderan- tziz aplikatuz, existitzen da h ∈ G, non LM(h) | LM(g ) baita. Baina, orduan, LM(h) | LM (g) ondorioztatzen dugu eta, G oinarri minimala denez, hori gertatzeko posibilitate bakarra h = g izatea da. Beraz, LM(g) eta LM(g ) monomioek elkar zatitzen dute eta, hortaz, LM(g) = LM(g ) dugu. 3.40. Teorema. Izan bedi a polinomioen ideal ez-nulua. Orduan, a-k Gr¨ obnerren oinarri laburtu bakar bat du ordena monomial bakoitzeko. Gainera, G =  {g1, . . . , gt} a -ren Gr¨ obnerren oinarri minimala bada, eta g i bada gi polinomioa G {gi}-rekin zatitzeko hondarra (polinomio horiek edozein modutan zerrendaturik), orduan G = {g 1, . . . , gt} a-ren Gr¨ obnerren oinarri laburtua da. Froga. Lehenengo eta behin, ikus dezagun G oinarri laburtua dela. Hasteko, G a -ren Gr¨ obnerren oinarria dela frogatuko dugu. Kontuan izanik G ⊆ a dela, nahi- koa dugu ikustea LT(g i) = LT(gi) dela i = 1, . . . , t guztietarako. Ohartu LT(gi) ez dela LT(gj)- z zatigarria i = j denean, G oinarri minimala izateagatik. Hori dela eta, gi polinomioa G {gi} multzoaz zatitzen dugunean, LT(gi) koeﬁziente nagusia g i hondarrera doa zuzenean. Beraz, LT(gi) = LT(gi) dugu, eta G a-ren Gr¨ obnerren oinarria da. Orain, absurdora eramanez, demagun G ez dela laburtua. Orduan, existituko da g i polinomio bat, halakoa non gi-en gaietako bat gj beste polinomio baten gai nagusiaz zatigarria baita. Baina, LT(g j ) = LT(gj ) denez, gi-en gai hori LT(gj)-z zatigarria da. Gogoratu zatiketaren algoritmo orokortuan hondarrak ho- nako ezaugarri hau duela:  bere gaietako bat ere ez dela zatitzaileen gai nagusiez zatigarria. Gure kasuan, g i hondarra ematen duen zatiketan, gj zatitzaileen artean agertzen da. Beraz, LT(gj)-k ezin du gi- en gai bat ere zatitu. Kontraesan horrek G oinarri laburtua dela frogatzen du. Frogatu dezagun orain oinarri laburtu bakarra dagoela. Hartzen baditugu G1 eta G2 bi oinarri laburtu, orduan, simetriagatik, nahikoa da g1 ∈ G1 polinomio bakoitza G2-n ere badagoela ikustea. Badakigu, 3.39 lema aplikatuz, LM(G1) = LM(G2) dugula. Beraz, badago g2 ∈ G2, non LM(g1) = LM(g2) baita. Kontuan izanik g1-en eta g2-ren koeﬁziente nagusiak 1 direla, horrek esan nahi du LT (g1) = LT(g2) dela. Ikus dezagun g1 = g2 dela. Horretarako, zatitu dezagun g1 − g2 kendura G1- ekin. Alde batetik, badakigu zatiketaren hondarra 0 dela, g1 − g2 ∈ a izateagatik eta G1 a-ren Gr¨ obnerren oinarria izateagatik. Beste alde batetik, g1 −g2 egitean g1-en eta g2- ren gai nagusiak elkarrekin deuseztatzen dira. Beraz, g1 − g2- ren monomio bat g1-en monomio batekin edo g2-ren monomio batekin bat dator, baina ez monomio nagusiekin bat. Horregatik, eta G1 eta G2 oinarri laburtuak direlako eta LM(G1) = LM(G2) delako, g1 − g2 kendura G1-ekin zatitzean, gai guztiak hondarrera doaz. Hori dela eta, zatiketaren hondarra g1 − g2 bera da. Ondorioz, g1 − g2 = 0 dugu, eta g1 = g2 ∈ G2, nahi bezala. 3.41. Adibidea. Aurretik esan dugu G = {Y − X2, Z − XY } multzoa a = (Y − X2, Z − X3)-ren Gr¨ obnerren oinarri minimala dela, baina ez laburtua, lex ordena monomiala hartzen badugu, Z > Y > X izanik. Eman dezagun a-ren oinarri laburtu bat, azken teoremako metodoa G oinarriari aplikatuz. Horretarako, Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU  3.5. GR ¨ OBNERREN OINARRI MINIMALAK ETA LABURTUAK 109 Y − X2 polinomioa Z − XY -rekin eta Z − XY polinomioa Y − X2-rekin zatitu behar ditugu, eta hondarrekin gelditu behar dugu. Horrela, {Y − X2, Z − X3} oinarri laburtua lortzen dugu. Bagenekien hori a- ren oinarri laburtua dela, eta ezin genuen beste emaitzarik lortu, a-k oinarri laburtu bakarra du eta. Gr¨ obnerren oinarri batetik oinarri minimal bat lortu nahi badugu, ikusten dugu- ! nean oinarriko polinomio baten gai nagusia beste baten gai nagusiaz zatigarria dela, lehenengo polinomio hori oinarritik kentzen dugu. Oinarri minimaletik laburtua atera nahi badugu, ordea, oinarriko polinomio baten edozein gai beste polinomio baten gai nagusiaz zatigarria bada, orduan gai hori desagertzea lor dezakegu, baina ez gai hori besterik gabe ezabatuz, baizik eta polinomio hori oinarriko besteez zati- tuz. Azaldu dezagun hori azken adibidea erabiliz. Horretan, G = {Y −X2, Z −XY } a -ren oinarri minimala da. Konturatzen garenean Z −XY polinomioaren −XY gaia Y −X2- ren gai nagusiaz zatigarria dela, ez da zuzena −XY besterik gabe ezabatzea eta  {Y − X2, Z} oinarri laburtua dela esatea. Izan ere, azken multzoa ezin da inola ere a-ren Gr¨ obnerren oinarria izan, Z polinomioa ez baitago a-ren barruan. (Hori ikusteko, nahikoa da Z G-rekin zatitzea eta ikustea hondarra X3 = 0 dela.) Geometria Aljebraikoa. Gustavo A. Fern´ andez Alcober. UPV/EHU
