





5.Gaia:
Erregresioa
Cristina Alcalde - Arantxa Zatarain
Donostiako Unibertsitate Eskola Politeknikoa - UPV/EHU
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
1 / 17

Bi dimentsiotako aldagaiak
Multzo bateko osagaien bi atributu aztertzen ditugunean bi dimentsiotako
aldagaia dugu. n elementuz, (x1, y1), (x2, y2), . . . , (xn, yn), osatutako
laginaren osagaiak elkarzut diren ardatz sisteman adierazten ditugunen
sakabanatze-diagrama lortzen dugu, bi atributuen arteko dependentzia
estatistikoa ager daiteke eta hortik erlazio funtzionala atera daiteke.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
2 / 17

Adibidea
Aita-semea edo ama-alaba eran osatutako 12 bikoteen altuerak ditugu
taulan.
X
Y
162.5
170
157.5
165
167.5
170
160
162.5
170
172.5
155
165
175
170
165
162.5
170
177.5
167.5
167.5
172.5
170
177.5
175
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
3 / 17

Adibidea
Datu horien adierazpen graﬁkoa egiten dugunean dispertsio diagrama
lortzen dugu.
 $ 
 $  
 $ "
 $ $
 $ &
 % 
 %  
 % "
 % $
 % &
 & 
 # 
 # #
 $ 
 $ #
 % 
 % #
 & 
:
;
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
4 / 17

Doiketa lortzeko prozesua
Demagun datu kopurua inﬁnitua dela eta x balio bakoitzari dagozkien y
balioen batezbestekoa E (x, y ) dela, (x, E (x, y )) puntu guztietatik
pasatzen den lerroa x-gaineko y -ren erregresio lerroa da.
Lerro hori ezagutzen denean x balioentzat y balioa lor dezakegu.
Erregresioa aztertzerakoan hiru pausu egin behar ditugu:
1
Erregresio-lerroaren mota aukeratu. Hau puntu-multzoa edo
sakabanatze-diagrama aztertuz egiten da.
2
Erregresio-lerroaren parametroak lortu. Parametroak lortzeko karratu
minimoen metodoa erabiliko dugu.
3
Doiketaren kritika. Parametroak beste lagin batez lortzen direnean
aldaketa handiak badira lortutako erregresio-lerroa ez da praktikoa
izango.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
5 / 17

Karratu minimoen metodoa
Demagun (x1, y1), (x2, y2), . . . , (xn, yn) laginaren puntu-multzoa dela eta
y
= f (x) funtzioa aukeratu dugula erregresio-lerroaren adierazpen
analitikoa bezala, funtzio horretan parametro batzuk azalduko dira,
adibidez, y = a + bx zuzena aukeratzen badugu bi parametro ﬁnkatu
behar ditugu, y = ax2 + bx + d parabolaren kasuan 3 parametro, eta bi
parametro lortu beharko genituzke y = aebx esponentzialaren kasuan eta
y
= axb potentzialaren kasuan.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
6 / 17

Karratu minimoen metodoa
Parametroak lortzeko
F
(a, b, . . .) =
n
i
=1
(yi − f (xi ))
2
funtzioa deﬁnitzen dugu, hau da lagineko yi eta f (xi ) funtzioaren bidez
lortzen diren balioen arteko diferentzien karratuen batura.
Parametroen balioak lortzen ditugu F (a, b, . . .) funtzio hau minimoa izan
dadin. Horretarako
∂F
∂a
= 0,
∂F
∂b
= 0, . . .
baldintzak bete behar dira. Lortutako ekuazio-sistema ebatziz parametroen
balioak lortzen dira.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
7 / 17

Erregresio lineala
Demagun erregresio-lerro bezala y = a + bx zuzena aukeratu dugula.
F
(a, b) funtzioa era honetan gelditzen zaigu,
F
(a, b) =
n
i
=1
(yi − a − bxi )
2.
Funtzioa minimoa izan dadin
∂F
∂a
= 0,
∂F
∂b
= 0
bete behar dira. Beraz,
∂F
∂a
= 2
n
i
=1
[(yi − a − bxi )(−1)] = 0
∂F
∂b
= 2
n
i
=1
[(yi − a − bxi )(−xi )] = 0
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
8 / 17

Erregresio lineala
Bi ekuazio horietan banatze, elkartze eta trukatze propietateak erabiliz,
sistema hau lortzen dugu
n
i
=1 yi
−
n
i
=1 a
−
n
i
=1 bxi
= 0
n
i
=1(yi · xi )
−
n
i
=1 axi
−
n
i
=1 bx
2
i
= 0
=⇒
na
+b
n
i
=1 xi
=
n
i
=1 yi
a
n
i
=1 xi
+b
n
i
=1 x
2
i
=
n
i
=1(yi · xi )
.
Sistema honen ekuazioak Gauss-en ekuazio normalak deitzen dira.
Bx =
n
1=1
xi ,
Bxx =
n
1=1
x2
i
By =
n
1=1
yi ,
Bxy =
n
1=1
xi
· yi
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
9 / 17

Erregresio lineala
eta sistemaren soluzioa
a
=
By
Bx
Bxy
Bxx
n
Bx
Bx
Bxx
b
=
n
By
Bx
Bxy
n
Bx
Bx
Bxx
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
10 / 17

Kobariantza
b
=
n
By
Bx
Bxy
n
Bx
Bx
Bxx
=
nBxy
− BxBy
nBxx
− (Bx)2
Frakzioaren izendatzailea eta zenbatzailea n2-z zatituz
b
=
Bxy
n
−
Bx
n
By
n
Bxx
n
−
(Bx )2
n2
Zenbatzailean dugun adierazpena bi dimentsioetako laginaren kobariantza
deitzen da eta izendatzailean duguna x laginaren bariantza da.
Kob
(x, y ) = ¯
xy
− ¯x¯y =
n
i
=1(xi · yi )
n
−
n
i
=1(xi )
n
n
i
=1(yi )
n
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
11 / 17

Erregresio zuzena
b
balioa y -ren x-kiko erregresio-koeﬁzientea da.
a
=
By Bxx
− BxBxy
nBxx
− (Bx)2
b
-ren balioa sistemaren lehenengo ekuazioan ordezkatzen badugu, a ren
balioa era honetan lor dezakegu
a
=
By
n
− b
Bx
n
= ¯
y
− b¯x
Erregresio-zuzena (¯
x,
¯
y
) puntutik pasatzen da eta puntu hau diagramaren
grabitate-zentroa da.
y
= a + bx ⇒ y = ¯y − b¯x + bx
beraz
y
− ¯y = b(x − ¯x)
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
12 / 17

Korrelazio koeﬁzientea
Bi dimentsiotako laginen korrelazio linealaren koeﬁzientea era honetan
deﬁnitzen da,
r
=
Sxy
Sx
· Sy
=
Kob
(x, y )
√
Barx
√
Bary
r
koeﬁzientearen balioak [−1, 1] tartean daude eta x eta y-en arteko
dependentzia lineala neurtzen du, |r|-ren balioa 1-ari hurbiltzen denean
dependentzia handia da eta zeinuak zuzenaren maldaren zeinua adierazten
du.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
13 / 17

Kurba esponentzialen doiketa
Aldagaien arteko erlazioa esponentziala denean y = Aebx erako funtzioa
dugu. Logaritmo nepertarrak harturik
ln y = ln A + bx
lortzen dugu eta, u = ln y eta a = ln A aldaketak egiten u = a + bx zuzena
lortzen dugu. Doiketa egiteko, erregresio linealaren metodoa erabiltzen
dugu (x1, ln y1), (x2, ln y2), . . . , (xn, ln yn) puntu-multzoekin.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
14 / 17

Kurba potentzialen doiketa
Aldagaien arteko erlazioa potentziala denean y = Ax B erako funtzioa
dugu. Berriro logaritmo nepertarrak hartuz
ln y = ln A + B ln x
lortzen dugu, v = ln y , a = ln A eta u = ln x aldaketak egiten
v
= a + bu
zuzena lortzen dugu, eta parametroak lortzeko erregresio linealaren
metodoa erabiltzen dugu (ln x1, ln y1), (ln x2, ln y2), . . . , (ln xn, ln yn)
puntu-multzoekin.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
15 / 17

Parabolen doiketa
x
eta y aldagaien arteko erlazioa bigarren mailako polinomio baten bidez
adierazten da.
y
= a + bx + dx2
Parametroak lortzeko,
F
(a, b, c) =
n
i
=1
(yi − a − bxi − dx
2
i )
2
funtzioaren minimoak bilatzen ditugu zuzenaren kasuan bezala
parametroekiko deribatu partzialak zero eginaz.
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
16 / 17

Parabolen doiketa
∂F
∂a
= 2
n
i
=1
(yi − a − bxi − dx
2
i )(
−1) = 0
∂F
∂b
= 2
n
i
=1
(yi − a − bxi − dx
2
i )(
−xi ) = 0
∂F
∂d
= 2
n
i
=1
(yi − a − bxi − dx
2
i )(
−x
2
i ) = 0
Hiru ekuazio horietatik sistema hau lortzen da, eta ebatzi behar dugu



a
· n
+b · Bx
+d · Bxx
= By
a
· Bx
+b · Bxx
+d · Bxxx
= Bxy
a
· Bxx +b · Bxxx +d · Bxxxx = Bxxy
C.Alcalde - A.Zatarain (Donostiako UEP )
Erregresioa
17 / 17
****** Document Outline ******
    * Erregresioa,_Korrelazioa
    * Bi_dimentsioetako_aldagaiak 
    * Karratu_minimoen_bidezko_doiketa
    * Erregresio_lineala
    * Korrelazio_koefizientea
    * Erregresio_ez_linealak
===============================================================================
