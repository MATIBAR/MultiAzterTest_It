   MARKOV KATEAK 1 Sarrera Esan bezala, Markov kateak, berritze teoriarekin batera, konputagailu eta komunikazio teknologiako hainbat eredu probabilistikotan erabiltzen dira. Eredu batzuk analizatzeko nahikoa dugu berritze teoria, baina beste askotan beharrezkoa da Markov kate bat deﬁnitzea. Berritze teorian oinarrituz azter- tuko ditugu Markov kateak. Ondoren deﬁnituko dugun Markov propietatea erlazionatuta dago Poisson prozesuaren oroimengabetasunarekin, prozesu es- tokastiko orokorragoetara zabalduko dugu propietate hau, lehenik denbora diskretuko prozesuetara. Prozesu estokastiko batek Markov propietatea be- tetzen duenean, bere analisia egitea erraza izango zaigu. Kontsidera dezagun {Xn, n = 0, 1, . . .} denbora diskretuko prozesu esto- kastikoa. Ohikoa denez, baldin Xn = j esango dugu prozesua j estatu edo egoeran dagoela n denboran. Estatu posibleen multzoa zenbakigarria izango da : normalean estatuak 0,1,2,. . .izango dira, edo hauen azpimultzoa. Hone- lako prozesuari Markov katea deitzen zaio baldin : P {Xn+1 = j | X0, . . . , Xn−1, Xn} = P {Xn+1 = j | Xn} edozein denbora n eta estatu j-rako. Berdintza hau honela interpretatzen dugu : Xn emanik Xn+1 independentea da X0, . . ., Xn−1-ekiko, hau da, jakina bada “oraingo estatua” prozesuaren “hurrengo estatua” independentea da “iraganeko estatuetatik”. Trantsizio probabilitatea deituko diogu probabilitate baldintzatu honi, n denboraren menpekoa izango ez den probabilitate honi : P {Xn+1 = j | Xn = i} = Pij Beraz Pij trantsizio probabilitatea, prozesua i estatuan dagoela pauso baten ondoren j estaturako trantsizioa egiteko probabilitatea da. Trantsizio proba- bilitateen matrizea osatuko dugu trantsizio desberdinak kontsideratuz, eta 1  lerroak eta zutabeak estatuen arabera zenbakituz : P =       P00 P01 P02 · · · P10 P11 P12 · · · P20 P21 P22 · · · .. . .. . .. . . ..       Orain estatu batetik bertarako trantsizioak ere gerta daitezke. Nabaria denez, P matrizearen sarrerak ez negatiboak dira, eta bestalde edozein lerro i-ko sarreren batura 1 da, j Pij = 1. Adibidea 1 Deﬁnitu eguraldiaren iragarpenerako eredu erraz bat, Markov katearen bidez. Adibidea 2 Demagun apustu batean euro bat irabazten dela p probabilita- tearekin eta euro bat galdu 1 − p probabilitatearekin. Apustulariak jokatzeari uzten dio dirurik gabe geratzen denean edo N euroko dirutza lortzen duenean. Deﬁnitu dagokion Markov katea. Esan dugunez Pij pauso bateko trantsizio probabilitatea da, eta kalkulatu nahi genuke n pausoko trantsizio probabilitatea. Propietatea 1 P {Xm+n = j | Xm = i} = (P n) ij Froga. Indukzioz frogatuko dugu n-ren gainean. Baldin n = 1, Pij dugu bi aldeetan. Eman dezagun n pausorako betetzen dela berdintza. Azter dezagun n + 1 pausorako : P {Xm+n+1 = j | Xm = i} = = k P {Xm+n+1 = j | Xm = i, Xm+n = k} · P {Xm+n = k | Xm = i} = k P {Xm+n+1 = j | Xm+n = k} · (P n) ik = k (P n) ik Pkj = P n+1 ij Hasieran probabilitate totalaren teorema erabili dugu n pausorako estatu po- sibleen gainean baldintzatuz, ondoren adierazpena sinpliﬁkatu dugu Markov propietatea eta indukzio hipotesiaren bidez, eta azkeneko berdintza matrize 2  biderkaketaren deﬁniziotik daukagu. ♦ Beraz i estatuan dagoen prozesua n pauso ondoren j estatuan izateko pro- babilitatea P n matrizearen (i, j) sarrera da. P n ij idatziko dugu n pausoko trantsizio probabilitatea adierazteko. Trantsizio probabilitateak probabilitate baldintzatuak dira, baina n den- boran izan ditzakegun estatuen probabilitate ez baldintzatuak ere interesatzen zaizkigu. Horretarako trantsizio probabilitateetaz gain, hasierako estatu po- sibleen probabilitateak behar ditugu, i bakoitzerako : αi = P {X0 = i} Nahikoa da, n denboran j estatuan izateko probabilitatea kalkulatzeko, ha- sierako estatu posibleen gainean baldintzatzea (probabilitate totalaren teo- remari jarraituz), P {Xn = j} = i P {Xn = j | X0 = i} · P {X0 = i}, beraz : P {Xn = j} = i αiP n ij j estatu bakoitzerako. Adibidea 3 Eguraldiaren iragarpenerako eredua. 2 Estatuen sailkapena Markov katearen estatuak sailkatuko ditugu denbora diskretuko prozesu estokastiko honen bilakaera karakterizatzeko. Sailkapen hau erabilgarria izan- go da limiteko probabilitateak aztertzerakoan ere. Har dezagun i estatua eta eman dezagun prozesuaren hasierako estatua dela. Prozesua berriz i estatura itzuliko den denbora Ti aldagaiak adieraziko digu. Inoiz ez balitz itzuliko Ti = ∞. Izan bedi fi = P {Ti < ∞ | X0 = i}, prozesua i estatura noizbait itzultzeko probabilitatea. Honela sailkatuko dugu i estatua : – errekurrentea da baldin fi = 1, hau da, prozesua i-tik abiatuz i-ra itzultzen bada beti (1 probabilitatearekin), – iragankorra da baldin fi < 1, hau da, prozesua i-tik abiatuz i-ra ez itzultzeko probabilitate positiboa badago (1 − fi > 0). Estatua errekurrentea bada, prozesua behin eta berriz itzuliko da estatura ; aldiz, iragankorra bada, egonaldi batzuk egin ondoren ez da inoiz itzuliko1. 1Beste aldagai hau dugu : Ni, prozesuak i- tik abiatuz zenbat egonaldi egiten dituen i estatuan. Estatua errekurrentea denean 1 probabilitatearekin Ni = ∞, izan ere, prozesua 3  Estatuak sailkatzerakoan beste irizpidea periodikotasuna da. Esango dugu i estatu errekurrentea periodikoa dela, d ≥ 2 periododuna, baldin P n ii = 0 bada n ez denean d-ren multiploa, d izanik propietate hau betetzen duen osoko handiena. Ez badago honelako osokorik, edo i iragankorra bada, esango dugu estatua aperiodikoa dela. Beraz i estatuak d ≥ 2 periodoa badu, pro- zesua i-tik abiatuz estatu honetan egon daitekeen uneak d, 2d, 3d, . . .dira, denbora hauetan bakarrik egon daiteke i estatuan, ez denbora guzti hauetan nahitaez, baina ezin daiteke egon i estatuan d-ren multiploa ez den denbora batean (eta d da honelako handiena). Ikusiko dugunez Markov katearen estatuen multzoan partizioa deﬁni dai- teke, klase bateko estatuak mota berdinekoak izango direlarik. Lehenik esta- tuen arteko erlazio bat deﬁnituko dugu, i → j idatziz, i estatutik j estatura heldu ahal izatea : i → j baldin badago n-ren bat P n ij > 0 izanik Erlazio hau trantsitiboa da : baldin i → j eta j → k orduan i → k, erraz frogatuko dugunez. Hipotesiaren arabera badaude m eta n-ren bat, P m ij > 0 eta P n jk > 0 izanik. Bestalde P m+n ik ≥ P m ij · P n jk daukagu, beraz P m+n ik > 0. Beste erlazioa deﬁnituko dugu : i eta j estatuak komunikatzen dira, i ↔ j idatziz, baldin batetik bestera hel badaiteke : i ↔ j baldin i → j eta j → i (Eta i ↔ i edozein estaturako.) Komunikazio erlazioa baliokidetasun erlazioa da : bihurkorra eta simetrikoa da nabarmena denez, eta baita trantsitiboa ere, “→” erlazioa honelakoa denez. Komunikazio erlazioari dagozkion balio- kidetasun klaseek estatuen multzoaren partizioa deﬁnitzen dute. Markov katea laburtezina dela esango dugu komunikazio klase bakarra badu, hau da, estatu denak elkarren artean komunikatzen badira. Bestalde, komunikazio klase bat itxia dela esango dugu baldin klaseko estatuetatik ezin badaiteke hel klasean ez dagoen inongo estatura. Klase itxi batean estatu bakarra badago estatu honi xurgatzailea deitzen zaio. Markov kate laburtezinaren klase bakarra itxia da. Markov katea nolana- hikoa izanik, prozesua klase itxi bateko estatura heltzen denean, klase horre- tatik ez da irtetzen eta klase horretako estatuek deﬁnitzen duten Markov kate laburtezinaren arabera jarraitzen du. Estatu xurgatzailera erortzen bada ez da hortik irtengo. i estatura itzuliko da behin eta berriz 1 probabilitatearekin. Estatua iragankorra denean 1 probabilitatearekin Ni < ∞, egonaldi kopuru ﬁnitua dugu ; kopuru honen banaketa aldagai geometrikoak ematen digu, Ni = k izango da f k−1 i (1 − fi) probabilitatearekin. 4  Adibidea 4 Markov kateko trantsizio probabilitateen matrizea emanik, mar- raztu pauso bateko trantsizioen diagrama eta kalkulatu komunikazio klaseak. Propietatea 2 Komunikazio klase ez itxiko estatuak iragankorrak dira. Kla- se itxian estatu denak errekurrenteak dira baldin estatu kopurua ﬁnitua bada ; estatu kopurua ez bada ﬁnitua2, estatu denak errekurrenteak edo denak ira- gankorrak izango dira. Azkenik, klase batean estatu denak aperiodikoak dira, edo bestela denak periodikoak dira, denak periodo berdinekoak. Markov kate laburtezinean estatu denak mota berdinekoak dira, propieta- tearen arabera, errekurrenteak estatu kopurua ﬁnitua bada. Markov kate laburtezinari aperiodikoa deitzen diogu estatuak honelakoak badira. Amaitzeko, periodikotasuna aztertzeko irizpide bat emango dugu : baldin Pii > 0 orduan i estatua aperiodikoa da. Kontuan izan baldintza hau aperio- dikoa izateko nahikoa dela baina ez beharrezkoa. Bestalde, gogoratu behar dugu klase batean estatuek periodikotasun bera dutela. Adibidea 5 Sailkatu aurreko adibideko Markov katearen estatuak. Adibidea 6 Sailkatu apustulariari zegokion Markov katearen estatuak. 3 Limiteko probabilitateak Berritze teorian oinarrituko gara limiteko probabilitateak lortzeko. Mar- kov kateari dagokion denbora jarraituko prozesu estokastikoa deﬁnitzea er- raza da, nahikoa dugu denbora diskretuko prozesuan pausoaren iraupena kontsideratzea. Izan bedi Markov kate laburtezina, estatu kopuru ﬁnitukoa, P izanik trantsizio probabilitateen matrizea. Estatu batetik abiatuz, denbora jarrai- tuan prozesu birsortzailea dagokio, estatuak errekurrenteak direnez, eta ho- nek baditu limiteko probabilitateak3. Balantza ekuazioetatik4 kalkulatuko 2Estatu errekurrenteak bi motakoak dira, estatura itzultzeko denboraren arabera :  er- rekurrente positiboak dira baldin E   matrizea idatziko dugu, non qij sarrerak estatua i deneko trantsizio tasak diren, eta qii diagonaleko sarrerak egonaldi denboren parametroak ikur negatiboaz : qij = νiPij baldin i = j −νi baldin i = j Ohartzen gara j νiPij = νi dela, beraz qii = − j=i qij Baldin ρ = P0 P1 . . . idazten badugu honela geratzen zaizkigu ekua- zioak : ρ Q = 0 ρ 1 = 1 8Baldintza zehatzak hauek dira. DJMK prozesuari dagokion denbora diskretuko Mar- kov katea laburtezina izan behar du ; gainera bornatuta egon behar dira egonaldi denboren νi parametroak eta 1/ νi itxarotako balioak. Orduan DJMK birsortzailea da baldin eta soi- lik baldin denbora diskretuko Markov katearen estatuak errekurrente positiboak badira. Honela bada denbora jarraituko prozesuaren limiteko banaketa ekuazioetatik dugu. 9  Jaiotza eta heriotza prozesuak : M/M/1 kola Jaiotza eta heriotza prozesua deitzen diogu DJMK prozesu bati non es- tatuak sistema bateko jende kopurua adierazten duen. Estatu trantsizioa izango dugu jaiotza edo heriotza gertatzen den bakoitzean. Jaiotza eta he- riotza prozesua deﬁnitzeko, sisteman n ≥ 0 banako daudeneko jaiotza eta heriotza tasak eman ditzakegu, λn = qn,n+1 eta µn = qn,n−1 hurrenez hurren. Q matrizea osatzeko qnn = −(qn,n−1 + qn,n+1) dugu dakigunez, beraz n bana- korako egonaldi denboraren parametroa νn = λn + µn da, n ≥ 0. Ondorioz trantsizio probabilitateak Pn,n+1 = λn/(λn + µn) eta Pn,n−1 = µn/(λn + µn) dira. Oinarrizko adibidea M/M/1 kola da. Sistemara bezeroak iristen dira λ tasako Poisson prozesua jarraituz eta sisteman zerbitzari bat dago, zerbitzu denborak µ parametroko banaketa esponentziala duelarik. Kolaren X(t) ta- maina sisteman dauden bezeroen kopurua da. Bezero berria heltzen denean jaiotza dugu eta zerbitzua jasotzen ari den bezeroak amaitzen duenean he- riotza. Etorrerarteko denborak eta zerbitzuak esponentzialak dira, beraz oroi- mengabeak, honek esan nahi du {X(t), t ≥ 0} prozesua DJMK dela, jaiotza eta heriotza prozesua hain zuzen. Dagozkion parametroak kalkulatuko di- tugu. Eman dezagun une batean prozesua n estatuan dagoela eta har dit- zagun Xj eta Xh aldagaiak, hurrengo jaiotza eta heriotza bitartean igaroko diren denborak. Aldagai esponentzialen oroimengabetasuna kontuan izanik, Pn,n+1 = P {X j < Xh} = λ λ + µ Pn,n−1 = P {X h < Xj} = µ λ + µ Bestalde min(Xj, Xh) esponentziala da, λ + µ parametrokoa, beraz egonaldi denboraren parametroa hau da : νn = λ + µ Kasu berezia dugu kola husten denean, P0,1 = 1 eta ν0 = λ. Erraz arrazoitu dezakegunez prozesua birsortzailea da λ < µ denean. Kasu honetan balantza ekuazioetatik lortuko ditugu limiteko probabilitateak, eta hauek dira bere- hala egiaztatu dezakegunez : Pn = λ µ n 1 − λ µ 10  Ikusten dugunez P0 = 1 − U , non U = λ/µ erabilera den ; gainera probabili- tatea kola luzeraren funtzio esponentzial beherakorra da. Badira beste kola eredu batzuk ere jaiotza eta heriotza prozesuak direnak, beraz eredu esponentzialak (hau da DJMK prozesuak). Adibidez M/M/K kola, non K zerbitzari ditugun. Eta M/M/1/K kola, honek zerbitzari ba- karra du eta sisteman K bezerorentzako lekua dago bakarrik, sistema beteta dagoela bezero berria badator hau galdu egiten da sistemara sartu aurretik. Azken kola honen analisia oso erraza da, estatu kopuru ﬁnitua dugunez. Etorrera teorema : sistema oroimengabeak Kontsidera dezagun gune batzuek osatutako sistema, bezeroak guneeta- tik zehar dabiltzalarik. Gune baten estatua bertan dauden bezeroen kopurua izango da. Sistemaren estatua gune desberdinen estatuek deﬁnituko dute. Eman dezagun hauek denak DJMK prozesuak direla eta gainera prozesu birsortzaileak. (Sistemara kanpotik bezeroak badatoz Poisson prozesua jar- raituko dute.) Sistema irekia dugu kanpotik bezeroak etortzen badira eta sistematik kanpora irteten badira ; sistema itxia da kanpotik ez bada sart- zen bezerorik ezta kanpora irteten ere, sistemako bezeroak berak dira den- boran zehar, guztira N . Sistemako gune bat hartuko dugu, X(t) izanik gu- nean dauden bezeroen kopurua t unean. Honek limiteko probabilitateak ditu, limt→∞ P {X(t) = n}, n desberdinetarako : sistema irekia denean Pn idatziko dugu, ohi bezala, eta sistema itxia denean Pn(N ), probabilitateak N -ren funtziotzat hartuz. Beste probabilitate hauek deﬁnituko ditugu. An izango da bezero bat gunera sartzeko unean gunean n bezero aurkitzeko probabilitatea. Sare itxi- aren kasuan An(N ) idatziko dugu. Hau da etorrera teoremak esaten diguna, edozein n-rako : – sistema irekian An = Pn – sistema itxian An(N ) = Pn(N − 1) Semi-Markov prozesuak Denbora jarraituko prozesu estokastiko bat semi-Markov prozesua dela esango dugu baldin DJMK prozesuaren egitura probabilistiko bera badu baina egonaldi denboren banaketa edozein izan daitekeelarik, ez nahitaez es- ponentziala. (Egonaldi denboraren banaketa orokor hau, dagokion estatuaren 11  menpekoa izan daiteke ; bestalde, egonaldi denborak elkarren artean indepen- denteak diren aldagai aleatorioak izan behar dira.) Semi-Markov prozesua analizatzeko Pij trantsizio probabilitateak eta si egonaldi denboren itxaro- tako balioak behar ditugu. Hortik aurrera DJMK prozesuaren analisi berare- kin jarraituko dugu limiteko probabilitateak kalkulatzeko balantza ekuazioen bidez. Nabarmentzen dugu egonaldi denboraren itxarotako balioak bakarrik duela eragina limiteko probabilitateetan, ez bariantzak edo banaketa funtzio motak. M/G/1 kola azter dezakegu semi-Markov prozesu egoki baten bidez. Kola honetara bezeroak Poisson prozesua jarraituz etortzen dira eta zerbitzari ba- karra dugu, zerbitzu denboraren banaketa funtzioa edozein motakoa izanik. Prozesuaren estatua era honetan deﬁnitzen da : azkena zerbitzatua izan den bezeroa irten ondoren sisteman geratu diren bezeroen kopurua (estatu bere- zia dugu kola hustean). Etorrerarteko denborak oroimengabeak direnez, es- tatuen arteko trantsizioek denbora diskretuko Markov katea jarraitzen dute. Limiteko probabilitateak aurkitzeko balantza ekuazioak ditugu baina diment- sio inﬁnituko sistema dugu eta teknika bereziak erabili behar dira ; ez dugu arazo hau M/G/1/K kolan, non gehienez K bezero ditugun sisteman. Dena dela, ez dugu limiteko probabilitateen beharrik L kola luzeraren batez bes- tekoa eta W bezeroek sisteman egingo duten denboraren itxarotako balioa lortzeko, prozesu birsortzaileen kostu ekuazioan oinarritutako analisi batetik deduzitzen dira Pollaczek-Khinchine formulak : W = λ(σ2 + m2) 2(1 − λm) + m eta L = λW = λ2(σ2 + m2)/2(1 − λm) + λm. Formuletan m eta σ2, zerbitzu denboraren itxarotako balioa eta bariantza dira, λ berriz etorrera tasa. 12
