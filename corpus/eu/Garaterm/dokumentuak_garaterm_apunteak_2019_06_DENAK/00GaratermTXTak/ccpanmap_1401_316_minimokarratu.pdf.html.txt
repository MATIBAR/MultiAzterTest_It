


Kapitulua 4
MINIMO KARRATUEN METODOA
4.1
Minimo Karratuen Problema, Hastapena.
4.1.1
Ekuazio linealetako sistema baldintzatuegiak.
Askotan fenomeno ﬁsikoen eredu matematikoek ondoko gisako ekuazio linealetako sistema bal-
dintzatuegiak aurkezten dituzte, Ax = b, non x ∈ Rm, b ∈ Rn eta A ∈ Mn×m 
(n > m)
diren. Nabaria denez m ezezagun kopurua edo problemaren askatasun maila n ekuazio linealki
askeen kopurua baino txikiagoa bada, orduan ezezagun sorta horrek x = 
{x1, ..., xm} ezin
izango du baldintza guztiak bete eta soluzioa ezinezkoa da. Algebra linealaren hizkuntzaz,
[A :
 b] sistemaren matrize hedatuaren heina m + 1 denean sistemak ez dauka soluziorik.
Egoera honenpean beste erantzun mota onargarriak aurkitzea pentsatu beharko dugu.
Demagun ondoko sistema lineala,
E1: a11x1 + · · ·
+ a1mxm = b1,
...
...
...
...
En: an1x1 + · · ·
+ anmxm = bn.
Problema honen soluzioaren existentzia eta bakartasuna ezezagun kopurua eta problemak hala-
behartzen dituen baldintzen 
(ekuazio linealki askeen kopurua) arteko erlazioaz ﬁnkatuta dago.
Baldin ezezagun kopurua ekuazio linealki askeen kopurua baino handiagoa bada, orduan sis-
temak inﬁnitu soluzio ezberdin dauzka. Bi kopuruak berdinak direnean, orduan soluzio bakar
bat existitzen da. Azkenik, baldin ezezagun kopurua ekuazio linealki askeena baino txikiagoa
bada, orduan ezezagun multzoa ez da nahikoa baldintza guztiak betetzeko eta problemaren
soluziorik ez dago. Ondoko adibidean hiru mota hauetako sistemak aztertuko ditugu,
1

Adibidea 4.1.1 Azter ditzagun ondoko hiru ezezagunekiko ekuazio linealen sistemen soluzioak,
hurrenez-hurren bi, hiru eta lau ekuazio linealki askekoak dira,
a)
−x − 3y − z = 6
5x + y − 2z = −2
b)



−x − 3y − z = 6
5x + y − 2z = −2
2x − 2y + 4z = −8
d)







−x − 3y − z = 6
5x + y − 2z = −2
2x − 2y + 4z = −8
−4x − y − 2z = 1
Soluzioa:
 Lehenengo sistemaren matrizearen heina 2 da eta beronen soluzioa 1 dimentsiodun
espazio bat da, R3-ko zuzen hau: 
(t, −t − 2, 2t), t ∈ R. Bigarrenaren matrizearen heina
3 da eta soluzioa R3-ko puntu bakar bat da, 
(−1, −1, −2) hain zuzen. Amaitzeko, azken
sistema baldintzatuegiaren matrizearen heina 3 da baina matrize hedatuaren heina 4 da
eta ondorioz ez daude soluziorik.
Deﬁnizioa 4.1.1 Baldin Ax = b sistema linealaren A ∈ Mn×m 
(n ≥ m) matrizearen heina
m bada, orduan matrizea heina osokoa dela diogu.
4.1.2
Hondar-bektorea eta minimo karratuen problema.
Ikusi dugunez sistema baldintzatuegiaren ekuazio guztiak betetzen dituen 
(x1, ..., xm) ∈ Rm bek-
torerik ez dago. Honek esan nahi du ez dagoela bi − 
(ai1x1 + · · · + aimxm) kopurua 0 egiten
duen soluziorik, i = 1, ..., n guztietarako. Hala ere itxaropenik ez dugu galdu behar eta soluzio
zehatza aurkitzeko aukerarik ez egon arren, agian aurreko erlazioak ahal den txikienak egiten
dituen x ∈ Rm bektorea kalkulatzea ez da erantzun txarra.
Lehenbizian ondoko kenduraz deﬁnituko dugu sistema linealaren hondar-bektorea,
(4.1)
r = b − Ax ∈ Rn non ri = bi − (ai1x1 + · · · + aimxm),
i = 1, ..., n,
diren.
Noski, (x1, ..., xm)t balioen hautaketaren arabera hondar-
bektorearen osagai batzuk haziko dira
besteak gutxitzen diren bitartean. Gure helburua neurri txikieneko r derrigortzen duen x bek-
torea aurkitzea da. Horretarako deﬁnitu behar dugun lehenengo kontzeptua neurria da eta
hau norma baten bitartez egingo dugu. Norma L2 biderkadura eskalarraren atzetik dagoenez
eta ezaugarri honek ondorengo eragiketak erraztuko dizkigunez, r-
ren tamainua neurtzeko dis-
tantzia naturala edo euklidearra deﬁnitzen duen norma darabilgu. Beraz minimo karratuaren
problemaren helburua ondoko norma minimizatzean datza,
(4.2)
r 2
2 =
n
i=1
|bi − (ai1x1 + · · · + aimxm)|2.
2

Minimo karratuen metodoak ondoko ohiko problemaren erantzun erabilgarria ematen du:
neurri experimentalek ematen duten odei-
puntu edo puntu ugarien multzo bat polinomio baten
bitartez hurbiltzea. Adibidez {(xi, yi)}ni=1 ⊂ R2 (n >> m + 1) puntu-
multzoa ahal den
modu zehatzenaz m mailako polinomioaz hurbiltzeko minimo karratuen metodoa darabilgu.
Noski, metodo honek eskeinitako polinomioa ez da pasako puntu guzti horietatik baina ahal den
gertuenetik pasako da. Baldin polinomioaren adierazpena P 
(x) = amxm + · · · + a1x + a0 bada,
polinomio mota horietarako oinarria 
{1, x, x2, ..., xm} izanik, orduan matrizialki, polinomio
horrek xi puntu bakoitzean yi balioa edukitzea honela idatziko genuke,
(4.3)





1 x1 x21 · · · xm
1
1 x2 x22 · · · xm
2
... ... ... ... ...
1 xn x2n · · · xm
n










a0
a1
...
am





=





y1
y2
...
yn





Sistema honen m + 1 ezezagunak 
{a0, a1, ..., am} koeﬁziente errealak dira eta argi dago
askatasun maila horrek ezin duela hainbeste baldintzak bete. Horregatik konformatu beharko
dugu ondoko bektorea minimizatzen duten koeﬁzienteak aurkitzeaz,
(4.4)
r 2
2 =
n
i=1
|yi − (a0 + a1xi + a2x2i + · · · + amx
m
i )|
2,
non xi eta yi puntuen koordenatu ezagunak diren.
4.2
Ekuazio Normalak.
Demagun Ax = b heina osoko matrizearekiko sistema lineal baldintzatuegia non b ∈ Rn eta
A ∈ Mn×m 
(n > m) diren. Baldin x sistema beronen soluzioa bada, orduan AtAx = Atb sis-
temaren soluzioa da erebai, non matrize iraulia At ∈ Mm×n dagoen eta AtA ∈ Mm×m ma-
trize karratua den. Orain ondorioztatutako sistema berriak m ekuazio eta m ezezagun ditu eta
gainera simetrikoa eta positibo deﬁnitua da, beraz soluzio bakar bat daukala ziurta dezakegu.
Noski, sistema hau eta jatorrizkoa ez dira baliokideak eta azken honen soluzioaren existentziak
ez digu adierazten jatorrizko sistemak soluzioa eduki behar duenik. Hala ere, zorionez on-
dorengo teoremak sistema simetriko berri honen soluzioa eta minimo karratuaren soluzioaren
baliokidetasuna ziurtatzen du, izan ere,
(4.5)
x non min
x∈Rm
Ax − b 2 ⇐⇒ x non AtAx = Atb den.
AtAx = Atb sistema lineal simetrikoari ekuazio normalak esaten zaio eta Cholesky-
ren
bezelako faktorizazioaren bitartez aska dezakegu.
3

Teorema 4.2.1 Izan bedi A ∈ Mn×m (n ≥ m) heina osoko matrizea, orduan AtAx =
Atb sistema lineala eta minx∈Rm Ax − b 2 minimo karratuaren eskema problema baliokideak
dira eta bien soluzioa x bektore berdina da.
frog: Baldin x At
(Ax−b) = 0 bada eta aldiberean minimo karratuaren problemaren soluzioa
bada, orduan Rm-ko z = −At(Ax − b) = 0 bektorea hartuko dugu. Orain ∀α ∈ R,
x + αz bektoreari dagokion hondar-bektorearen normaren berbidura hauxe da,
(4.6)
A(x + αz) − b 2
2 =
Ax − b 2
2 + 2αz
tAt(Ax − b) + α2 Az 2
2.
ztAt(Ax − b) < 0 da, beraz α txikia hartuz ondorio absurdua beteko litzateke,
(4.7)
A(x + αz) − b 2
2 <
Ax − b 2
2.
Absurdua!
Aldiberean kontrako norabidean ondorioztapenak betetzen dira, beraz teoremak aurkezten
duen baliokidetasuna betetzen da.
Ondoko adibidearen minimo karratuaren problema askatuko dugu ekuazio normalak eta
berauen Cholesky-ren faktorizazioaren bidez.
Adibidea 4.2.1 Askatu ondoko sistema lineal baldintzatuegia,
(4.8)
2x −
y =
1,
−x − 2y = −4,
−3x + 5y = −2.
Soluzioa:
 Hemen A ∈ M3×2 matrizea, b ∈ R3 bektorea eta ekuazio normalei dagozkien
AtA ∈ R2×2 eta Atb ∈ R2 ondokoak dira,
A =


2
−1
−1 −2
−3
5

 , b =


1
−4
−2

 , AtA =
14
−15
−15
30
,
Atb =
12
−3
.
AtAx = Atb sistema lineal simetrikoa Cholesky-
ren metodoaren bitartez askatuko dugu,
lehenik AtA matrizearen faktorizazioaren osagaiak kalkulatuko ditugu,
l11 =
√
14 = 3.742,
l21 = −15/
√
14 = −4.009,
l22 =
√
30 − 4.0092 = 3.732.
Ekuazio normalei dagokien sistema lineala AtA matrizearen faktorizazioaren menpean
idatz dezakegu,
3.742
0
−4.009 3.732
3.742 −4.009
0
3.732
x
y
=
12
−3
,
4

non 
(x, y) ekuazio normaleen soluzioa den. Orain atzerakako ardezkapenaz bi sistema
lineal triangeluarrak askatu beharko ditugu,
3.742
0
−4.009 3.732
z1
z2
=
12
−3
⇒
z1 = 3.207
z2 =
−3 + 4.009 · 3.207
3.732
= 2.641
3.742 −4.009
0
3.732
x
y
=
3.207
2.641
⇒
y = 0.7077
x =
3.207 + 4.009 · 0.7077
3.742
= 1.615
Minimo karratuaren problema honen (x, y) = 
(1.615, 0.7077) soluzioari dagokion hondar-
bektorea hauxe da,
r = b − A(x, y)t =


1
−4
−2

 −


2.522
−3.030
−1.307

 =


−1.522
−0.9696
−0.6935

 .
Cholesky-
ren faktorizazioko metodo honek eragozpen bat dauka, egoera larripean AtA-
ren matrize biderkadurak ondorioztatzen duen doitasun-
galera, hain zuzen. Adibidez, baldin
A-ren osagai batzuk oso txikiak badira 
(| | << 1) eta beraien kokaguneak ondokoak badira,
(4.9)
A =


1 1
0
0


⇒
AtA =
1 + 2
1
1
1 + 2
.
Noski, 2 ikaragarri txikia da eta ordenagailuak gordetzen duen doitasun maila baino txikiagoa
bada, orduan AtA matrize singulartzat hartuko du eta problema konputazionalki askaezina
da. Doitasun-
galerak sortzen dituen arazo hauek gainditzeko transformazio ortogonaleko fak-
torizazio metodoak aztertuko ditugu.
4.3
Transformazio ortogonaleko metodoak.
4.3.1
Householder-en transformazioak.
Atal honetan ekuazio normalek ondorioztatzen dituzten sistema lineal simetrikoak askatzeko
Cholesky-
ren faktorizazioa baino metodo eraginkorragoak aurkeztuko ditugu. Metodo mota
hauek transformazio ortogonaletan oinarrituta daude eta M = AtA matrize simetriko eta
positibo deﬁnitua Q matrize ortogonal eta R matrize triangeluarren arteko biderkaduraren
moduan adieraztean datzate, M = QR.
Eskema honen abantailak hauxek dira, matrize ortogonalen ezaugarriei esker, berauen
gainean betetzen diren eragiketek kontrolpeko borobiltze-
errorea ondorioztatzen dute.
5

Deﬁnizioa 4.3.1 Rn-ko x = (x1, ..., xn) eta y = 
(y1, ..., yn) bektoreen biderkadura eskalarra
honela deﬁnituko dugu,
(4.10)
x, y =
n
i=1
xiyi .
Deﬁnizioa 4.3.2 Rn-
ko x = 0 eta y = 0 bektoreen arteko θ angeluaren kosinua ondoko
biderkadura eskalarrez deﬁnituko dugu,
(4.11)
cos θ =
x, y
x
y
.
Deﬁnizioa 4.3.3 Q ∈ Mn×n matrizeak Q−1 = Qt betetzen duenean edo QtQ = QQt = I
eraberean, orduan matrize ortogonala dela diogu.
Deﬁnizioa 4.3.4 (z1, ..., zn) ⊂ Rn bektore ez-nuluen sortak
zi, zj = 0, ∀ i = j betetzen
duenean, orduan bektore-ortogonalen multzoa dela diogu.
Propietateak:
a) Baldin Q ortogonala bada, orduan Q−1 ortogonala da ere.
b) Baldin Q eta P ortogonalak badira, orduan QP ortogonala da ere.
c) Baldin Q ortogonala bada, orduan det(Q) = ±1 da.
d) Q ortogonala da ⇔ (Qx, Qy) = (x, y) ,
∀ x, y ∈ Rn.
e) Q ortogonalak normak mantentzen ditu,
Qx 2 = x 2 ,
∀ x ∈ Rn.
f) Baldin Q ortogonala bada, orduan
Q 2 = Q−1 2 = ρ(Q) = 1.
g) Baldin Q ortogonala bada, orduan beronen {q1, ..., qn} zutabe-bektoreek Rn-
ren oinarri
ortogonala osatzen dute.
4.3.2
Givens-en biraketak.
Demagun R2 planoaren h = (h1, h2)t ∈ R2 bektorea
eta θ angelu positiboa. Baldin h bektorea θ angelua
norabide positiboaz biratu nahi badugu, aski da ondoko
gisako Q matrizea bider h biderkatzeaz,
(4.12)
Q =
c −s
s
c
,
Qh =
ch1 − sh2
sh1 + ch2
.
non c = cos θ eta s = sin θ diren.
X
Y
h
Q h
Θ
6

Q bezelako matrize mota hauei biraketak esango diegu. Matrizearen irauliaren biderkadu-
ra Qt alderantzizko efektua eragiten dio, −θ angelua biratzea, hots, θ angelua biratzea alder-
antzizko norabidean. Noski, Qt = Q−1 da eta QtQh = Ih = h.
Faktorizazio ortogonaletako metodoak emandako sistema linealaren matrizearen M =
QR antzako faktorizazioa aurkituko du non Q matrize ortogonala eta R matrize goi-
triangeluarra
diren. Gero, QtM = R biderkaduri esker Rx = Qtb sistema triangeluarra idatziko dugu. Azken
hau atzerakako ordezkapenaren bidez erraz askatzen da. M-
ren QR faktorizazioa eraikitzeko
lehenengo urratsean baldin M-ren lehenengo zutabea m
(0)
1
= (m
(0)
11 , m
(0)
21 , ..., m
(0)
n1 )
t bada, or-
duan QtM matrizearena ¯
m
(1)
1
= (m
(1)
11 , 0, ..., 0)
t izan behar du, non
m
(0)
1
= m
(1)
1
diren.
Adibidez M ∈ M2×2 matrizearen kasuan
(4.13)
Qtm
(0)
1
=
m
(0)
11 cos θ + m
(0)
21 sin θ
−m
(0)
11 sin θ + m
(0)
21 cos θ
⇒ −m
(0)
11 sin θ + m
(0)
21 cos θ = 0 ⇒









sin θ =
m
(0)
21
m
(0)
1
,
cos θ =
m
(0)
11
m
(0)
1
.
Hemen
m
(0)
1
=
(m
(0)
11 )
2 + (m
(0)
21 )
2
norma da. Normalizazio hau matrizearen ortogonalta-
suna ziurtatuko du. n×n dimentsioko matrize orokorretarako biraketa osagaiz osagai burutuko
da, izan ere, M-
ren mji osagaia deusestatzeko Qji matrize ortogonala eraikiko dugu. Matrize
mota hauei Givens-en biraketak esan ohi zaie eta beraien egitura honako hau da,
(4.14)
Qji =





















1
. ..
1
c · · · · · · · · · −s
... 1
...
...
. ..
...
...
1
...
s · · · · · · · · ·
c
1
. ..
1





















i. errenkada
j. errenkada
Hemen c = mii/ m2ii + m2ji eta s = mji/
 m2ii + m2ji dira. Qji matrizearen adierazpenean
idatzitak azaltzen ez diren osagaiak In matrize-
identitatearenak bezelakoak dira.
Qji matrizea bider M biderkatzean soilik azken honen i. eta j. errenkaden osagaiak
aldatzen dira besteen gaineko efektua In identitate-
matrizearen biderkaduraren modukoa de-
lako. Ondorio honek R matrize triangeluarra eraikitzeko M ren gainean Qji erako matrizeen
biderkadura ordenatuak eta sistematikoak aplikatzea pentsarazten digu.
7

Qt
21 biraketa edo matrize ortogonalak
M-ren m
(0)
1
= (m
(0)
11 , m
(0)
21 , ..., m
(0)
n1 )
t lehenengo
zutabe-bektorearen (2, 1) kokaguneko osagaia 0 egingo du. Gero, Qt
31 eraikiko dugu (3, 1)
kokagunekoa deusestatzeko. Hurrenez hurren eta diagonal nagusiaren azpiko osagai guztiak 0
izan arte erizpide berdina jarraituz Qt
ji matrizeak osatuko ditugu,
(4.15)
Qt
21m
(0)
1
=
m
(1)
1
= (m
(1)
11 , 0, m
(1)
31 , ..., m
(1)
n1 )
t,
Qt
31Q
t
21m
(0)
1
= Qt
31m
(1)
1
= m
(2)
1
= (m
(2)
11 , 0, 0, m
(2)
41 , ..., m
(2)
n1 )
t,
...
...
...
...
Qt
n1 · · · Q
t
21m
(0)
1
= Qt
n1m
(n−2)
1
= m
(n−1)
1
= (m
(n−1)
11
, 0, 0, ..., 0)t.
Prozesu osoan (n − 1)n/
2 matrize ortogonalen kopurua eraiki behar dira amaieran QR
faktorizazioa osatzen duen Q matrizea lortzeko, Qt = Qt
n n−1 · · · Q
t
n 1 · · · Q
t
2 1 ⇒ Q
tM = R
non R goi-triangeluarra den. Lan guzti honek ondorioztatu duen biderkaketa-
zatiketa kopu-
rua 2n3/3 ordenakoa da, Gauss-
en ezabapenak ondorioztatuko lukeen kopuru bikoitza. Hala
ere QR faktorizazioek borobiltze errorea mugatua mantenduko du eta emaitzaren doitasuna
ziurtatzeko oso portaera eraginkorra dauka.
Behin M = QR faktorizazioa lortu dugun Mx = b sistemaren ebazpena erraza da
Qt matrizeaz ezkerretik biderkatzen, Rx = Qtb triangeluarra delako.
Adibidea 4.3.1 Givens-en biraketen metodoaren bidez
M matrizearen QR faktorizazioa kalkulatu,
M =


3
15 −1
−4
1
2
9
9
5


Soluzioa:
i) Q21 matrize ortogonala:







c =
3
32 + (−4)2
= 0.6,
s =
−4
32 + (−4)2
= −0.8
⇒ Q21 =


0.6
0.8 0
−0.8 0.6 0
0
0
1


Qt
21M =


0.6 −0.8 0
0.8
0.6
0
0
0
1




3
15 −1
−4
1
2
9
9
5

 =


5
8.2
−2.2
0 12.6
0.4
9
9
5


ii) Q31 matrize ortogonala:





c =
5
√
52 + 92
= 0.48564,
s =
9
√
52 + 92
= 0.87416
⇒ Q31 =


0.48564 0 −0.87416
0
1
0
0.87416 0
0.48564


8

Qt
31Q
t
21M =


0.48564
0 0.87416
0
1
0
−0.87416 0 0.48564




5
8.2
−2.2
0 12.6
0.4
9
9
5

 =


10.296
11.85
3.3024
0
12.6
0.4
0
−2.7974 4.3514


iii) Q32 matrize ortogonala:







c =
12.6
12.62 + (−2.7974)2
= 0.97621,
s =
−2.7974
12.62 + (−2.7974)2
= −0.21674
⇒ Q32 =


1
0
0
0
0.97621
0.21674
0 −0.21674 0.48564


R = Qt
32Q
t
31Q
t
21M =


10.296
11.85
3.3024
0
12.907 −0.55264
0
0
4.3346


Amaieran, faktorizazioaren Qt = Qt
32Q
t
31Q
t
21 matrize ortogonala eta Q hauek dira,
Qt =


0.29138
−0.38851
0.87416
0.89465
0.43415
−0.10526
−0.33862
0.81273
0.47409

 ⇒ Q =


0.29138
0.89465
−0.33862
−0.38851
0.43415
0.81273
0.87416
−0.10526
0.47409

 .
9

Ariketak
Ariketa 1. Givens-en rotazioen bitartez aurkitu ondoko M ma-
trizearen QR faktorizazioa non Q ortogonala eta R trian-
geluarra diren. Gero, faktorizazioaren laguntzaz, askatu eza-
zu Mx = b sistema lineala non b = (−3, 2, 1). Eragiketak
4 digito esangarrietaz burutu.
M =


1
0
−2
0
3
1
2 −1
2


Ariketa 2. Demagun ondoko Ax = b sistema lineal baldintzatuegia:
x1
+ 3x2
=
4
x2 + 2x3 = −2
−x1 − x2
=
5
2x2 + 3x3 = −6
a) Sistema honi dagozkion ekuazio normalak idatzi.
b) Lehenengoz askatu sistema lineala Dolittle-
ren metodoaz eta hiru digitoetako aritmetikaz.
c) Gero eraiki matrizearen QR faktorizazioa Givens-
en rotazioen bidez eta lau digitoetako
aritmetikaz.
Ariketa 3. (0, 1) , (0.25, 1.284) , (0.5, 1.6487) , (0.75, 2.117) eta 
(1, 2.7183) puntuen ondotik
pasatzen den P 
(x) = ax2 +bx+d bigarren mailako polinomioa aurkitu minimo karratuen
metotoaren bitartez.
a) Eraiki a, b eta d ezezagunetarako ekuazio normalak. Agertu zaizun sistema lineala QR fak-
torizazioaz askatu. Q matrize ortogonala Givens-
en biraketen metodoaz kalkulatu, bost
digitoetako aritmetikaz.
Ariketa 4. Izan bitez ondoko M matrizea eta beronen QR faktorizazioa kalkulatzeko Given’s-
en lehenengo bi biraketak Qt
21 eta Q
t
31:
A =


2
3
−1
m21
2
1
m31 −4
0

 , Qt
21 =


0.55469
0.83204 0
−0.83204 0.55469 0
0
0
1

 , Qt
31 =


0.51507
0 0.85714
0
1
0
−0.85714 0 0.51507


Zenbat balio dute m21-k eta m31-k 5 digito esangarriekiko aritmetikaz?
Ariketa 5. Givens-en rotazioak
M matrize osoa
QR faktor-
izaziaren moduan adierazteko erabili ohi dugu non R trian-
geluarra eta Q ortogonala diren. Givens-en rotazioen bitartez
eta lau digitoetako aritmetikaz, aurkitu ezazu ondoko ma-
trizearen QR faktorizazioa non R behe-triangeluarra den.
M =


1
4 −1
3
3
2
−2 0
1


10
