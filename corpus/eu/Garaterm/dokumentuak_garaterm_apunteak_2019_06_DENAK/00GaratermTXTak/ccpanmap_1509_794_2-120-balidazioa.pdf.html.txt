


Balidazioa
Josemari Sarasola Ledesma
2007ko urtarrila

Contents
1
Zertarako balidazioa?
3
2
Zorizkotasun kontrasteak
4
2.1
Bolada kontrastea
. . . . . . . . . . . . . . . . . . . . . . . . . .
4
3
Egokitzapenaren doitasunerako kontrasteak
8
3.1
Ji karratu kontrastea . . . . . . . . . . . . . . . . . . . . . . . . .
8
3.1.1
Aplikazioak eredu diskretuetan . . . . . . . . . . . . . . .
9
3.1.2
Aplikazioak eredu jarraietan . . . . . . . . . . . . . . . . .
11
4
Homogenotasun kontrasteak
12
4.1
Mann-Whitney-en U kontrastea . . . . . . . . . . . . . . . . . . .
12

Inferentzia
Josemari Sarasola Ledesma
1
Zertarako balidazioa?
Behin ereduaren parametroak zenbatetsi edo kontrastatu direla, eredua guz-
tiz zehaztuta geratzen da. Baina gogora dezagun eredua, parametroak ﬁnkatu
gabe, suposatu egiten genuela hasiera batean, datuak era deskribatzailean esplo-
ratu ondoren (histogramaren bitartez, adibidez) edo aldagaiaren izaera kontu-
tan harturik (seme alaba kopurua familia batean adibidez, Poisson-en legearen
arabera banatzen dela pensatu behar da, hasiera batean behintzat).
Para-
metroen balioak zehaztuta, eredua bera egiaztatzeko garaia heldu da, hau da,
eredua kontrastatu edo alderatu behar dugu. Horretarako kontraste edo alder-
akuntza ez parametrikoak erabiltzen dira (parametroaren balioa denean kon-
trastatzen dena, kontrastea parametrikoa da, beste aldean).
Ereduaz gainera, badira egiaztatu edo balidatu beharreko beste kontu batzuk
ere:
• Jaso ditugun datuak benetan zorizko laginketa sinple batez, hau da, inde-
pendentziaz, jasoak izan diren kontrastatu behar da. Horretarako zorizkotasun-
kontrasteak (contrastes de aleatoriedad) erabiliko ditugu.
• Jaso ditugun datuak homogenoak diren kontrastatu behar da. Izan ere,
datuak eredu edo populazio desberdinetakoak izan daitezke: adibidez, gi-
zonezko eta emakumezkoei buruzko datuak batera jartzen baditugu, kon-
trastatu behar dugu benetan batera jarri daitezkeen edo portaera des-
berdina izanik, datu multzo bakoitza bere aldetik aztertu behar dugun.
Kontraste hauei homogenotasun-kontrasteak deritze.
3

Inferentzia
Josemari Sarasola Ledesma
2
Zorizkotasun kontrasteak
Datuen zorizkotasuna kontrastatzeko alderakuntza aukera zabala dago. Bat
bakarrik ikasiko dugu: bolada kontrastea 1.
2.1
Bolada kontrastea
Kontraste hau egin ahal izateko, datuak dikotomikoak edo koantitatiboak izan
behar dira.
Hainbat egunetan zehar euria egin duen ala ez jaso da. Hauek dira datuak
(b:bai, e:ez):
b − b − b − e − b − b − b − e − e − b − e − e − e
Euri egunak zoriz gertatzen direla esan al daiteke?
Bolada kopurua zenbatu behar da: guztira 4 bolada daude:
1 : bbb; 2 : e; 3 : bbb; 4 : ee5 : b; 6 : eee
Bolada kopurua txikiegia bada, fenomenoa zoriz ez dela gertatzen ondorioz-
tatu behar da:
 euriaren ondoren orohar euria eta ateri ondoren ateri izaten dela
esan nahiko luke.
Bolada kopurua handiegia denean ere, fenomenoak zorizkotasun eza erakut-
siko du, joera argi bat alegia. Adibidean, bolada asko balira, euri egun baten
ondoren, ateri eguna etortzen dela (eta alderantziz) esan nahiko luke.
Zorizkotasuna bolada kopurua handiegia eta txikiegia denean ukatzen denez,
kontrastea alde bikoa izango da.
Adibidea hartuta, adierazgarritasun maila
%5ean ﬁnkatzen badugu, kontrastea alde bikoa denez, %2.5 utzi beharko dugu
alde banatan.
Hipotesi hutsean datuak zoriz gertatu direla baieztatuko da. Hipotesi honen
pean, bolada kopurua nola banatzen den, eta beraz bolada kopuru jakin bat
izateko probabilitatea 
(gertatu denaren probabilitatea, alegia) nola kalkulatzen
den ez dugu ikasiko, zertxobait zaila delako: Statcalc programaz bolada kopuru
ezberdinen probabilitateen kalkulua oso sinplea da. (Non parametric atalean
Run Dis botoian sakatu behar duzu. Leiho hau azalduko zaizu:
1Gazteleraz, contraste de rachas; ingelesez, runs test.
4

Inferentzia
Josemari Sarasola Ledesma
Sartu beharreko datuak 1st type symbols, 2nd type symbols, observed runs
r dira. Ondoren P(R<=r) eta Momt botoiak saka itzazu. Behatutako r bo-
lada kopurua boladen batezbestekoarekin alderaytuz, jakingo dugu gorako edo
azpiko probabilitateari begiratu behar diogun kontrastea ebazteko. Adibidean,
behatutako bolada kopurua 6 da, batezbestez 7.46 suertatzen direlarik, behetik
harritzen garenez, azpiko (edo berdin) probabilitateari begiratzen diogu: 0.29.
Kontrastea alde bikoa denez, probabilitate hau α/2-rekin alderatu behar da.
Gertatu denaren probabilitatea α/2 baino handiagoa denez, hipotesi hutsa,
zorizkotasuna alegia, onartu egiten dugu. Lagina zorizkotzat eta ikasi ditugun
inferentzia teknikak garatzeko egokitzat jo dezakegu.
5

Inferentzia
Josemari Sarasola Ledesma
Datu koantitatiboetarako ere erabil daiteke bolada kontrastea:
Hainbat egunetan zehar enpresa bateko ekoizpena jaso da unitatetan:
498, 510, 490, 505, 495, 501, 496, 497, 502, 520
Datu hauek zorizko lagin bat osatzen dute edo nolabaiteko dependentzia dagoela
esan daiteke? Adierazgarritasun maila: %10
Mediana kalkulatzen da: 499.5 . Medianatik gora edo behera dauden kon-
tutan hartuz bereizten ditugu datuak jaso ditugun ordenean 2:
−, +, −, +, −, +, −, −, +, +
Benetan independentzia izango balitz, medianatik gora edo beherako datuak
zoriz banatuko lirateke.
Bolada gutxi badaude, denboran zehar ekoizpenak gora (edo behera) egiteko
joera duela esan nahi du.
Bolada asko badaude, medianatik behera eta gorako datuak txandakatu
egiten direla esa nahi du, eta beraz, ekoizpen handiko egun baten ondoren,
ekoizpen txikiko egun bat etorriko da ziur aski (eta alderantziz).
4 bolada daudela ikusten dugu. Asko, gutxi edo kopuru normala al da? Sar
ditzagun datuak:
Boladen itxaropenarekin alderatuz (6 da), bolada asko daudela ikusten dugu.
Beraz, goiko probabilitateri erreparatzen diogu: 0.16 ≥ α/
2 betetzen denez, lag-
ina zorizkoa dela, ekoizpenak egnuetan zehar ez duela inongo joerarik erakusten
2Medianaren balioa duten datuak bazter egin daitezke kontrastea egiteko orduan.
6

Inferentzia
Josemari Sarasola Ledesma
alegia, erabakitzen dugu. Beraz, lagina zorizkoa deenz, datu hauetarako ikasi
ditugun inferentzia tresna guztiak erabil daitezke.
Bolada kontrastea denbora serieen azterketan ere maiz erabiltzen da, denbora se-
riean joera garbirik badagoen erabaki behar denean. Zorizkotasunezko hipotesi
hutsetik abiatuta, joera garbia baden (bolada gutxi izango dira orduan) er-
abaki behar denez alternatiboki, kontrastea alde bakarrekoa izango da, behetik
zehatzago. Adibide bat:
Azken urteotako batezbesteko tenperatura hauek jaso dira Igeldoko beha-
tokian:
13.4 − 11.2 − 11.8 − 14.2 − 16.7 − 14.5 − 15.8 − 16.2 − 14.9
Batezbesteko tenperatura goraka ari dela esan al daiteke? α = %2.
Mediana kalkulatzen dugu: 14.5.
Medianatik gorako eta beherako datuen zerrenda osatzen dugu (medianarekin
bat datorren datua baztertu egiten dugu):
− − − − + + ++
2 bolada daude. Sar ditzagun datuak programan:
Alde kritikoa kasu honetan behetik bakarrik dago, alternatiboki tenperatura
goraka ari bada, bolada gutxi izango delako. Beheko probabilitatea α baino
handiagoa da (0.0285 ≥ 0.02): tenperatura ez dela goraka ari erabaki behar da.
Ohar zaitez, probabilitatea kasu honetan α-rekin alderatzen dugula, kontrastea
alde bakarrekoa baita.
7

Inferentzia
Josemari Sarasola Ledesma
3
Egokitzapenaren doitasunerako kontrasteak
Inferentzia prozesua abiarazteko, eredu bat ezarri behar zaio aztergai dugun
aldagaiari. Eredua datuak zorrotz gabe esploratuz egin behar da. Inferentziaren
prozesuaren bukaeran ordea, parametroak koantiﬁkatu ditugunean, hasiera batean
suposatu genuen eredua datuekin bat datorren zorrotzago aztertu behar da:
orohar, eredua zuzena dela hipotesi huts bezala harturik, datuetatik eredue-
tara dagoen doitasun eza neurtzen estatistiko baten bitartez. Neurri hau aski
handia bada, kasualidadearen eraginez ez dela gertatu ondorioztatzen da eta
beraz, eredua ukatu egingo dugu. Guzti honetarako erabiltzen diren kontrasteei
egokitzapenaren doitasunerako kontrasteak 3 deritze.
Eredu normala da gehien suposatzen dena praktikan. Hau dela eta, badira
eredua normalerako egokitzapena apropos aztertzen duten duten kontrasteak,
Shapiro-Wilks-en kontrastea kasu. Dena den, gehien erabiltzen den kontrastea
ikasiko dugu: ji karratu kontrastea.
3.1
Ji karratu kontrastea
Kontrastea hau eredu diskretu zein jarraietarako erabil daiteke. Aldagai koali-
tatiboetarako ere erabil daiteke. Oso aplikazio zabala du, beraz.
Kontrasteakereduak ezartzen dituen maiztasun teorikoak maiztasun enpiriko
edo errealekin alderaten ditu estatistiko honen bitartez:
χ
2 =
i
(ei − ti)
2
ti
non ei: maiztasun enpirikoa, ti: maiztasun teorikoa, diren.
Zenbat eta handiagoa, datuak orduan eta urrutiago izango dira hipotesi
hutsean ezarritako eredutik. beraz, kontrastearen alde kritikoa beti dago goitik.
Estatistikoa honela banatzen da, non k eredua zatitu den balio edo klase
kopurua den:
χ
2 ∼ χ2
k−1
Ereduko parametroak datuetatik zenbatetsi direnean, askatasun maila kop-
urua hau izango da, non z den zenbattesi den parametro kopurua:
χ
2 ∼ χ2
k−1−z
3Gazteleraz, contrastes de bondad de ajuste.
8

Inferentzia
Josemari Sarasola Ledesma
3.1.1
Aplikazioak eredu diskretuetan
Seiko bat hainbat aldiz jaurtiki eta emaitza hauek lortu dira. %5-eko adieraz-
Zenbakia
Maiztasuna
1
10
2
14
3
12
4
22
5
15
6
17
90
garritasun mailaz, seikoa ongi eraikita dagoela esan al daiteke?
Hipotesi hutsean eredua egiazkotzat jotzen da: kasu honetan, seikoa ongi
eraikita badago, aintzat hartu beharreko eredua hau da, eredutik eratortzen
diren maiztasun teorikoekin batera: Maiztasun teorikoak ereduzko probabili-
Zenbakia
Prob.
ti
(ei−ti)
2
ti
1
1/6
901/6=15
1.66
2
1/6
901/6=15
0.06
3
1/6
901/6=15
0.6
4
1/6
901/6=15
3.26
5
1/6
901/6=15
0
6
1/6
901/6=15
0.26
1
90
5.84
tateak lagin tamainuarekin biderkatuz kalkulatu dira.
Azken zutabean,
(ei−ti)
2
ti
balioak kalkulatzen dira. baturak ematen digu ji
karratu estatistikoaren balioa:
χ
2 = 5.84
Estatistikoaren balio kritikoa eman dezagun: 6 − 1 = 5 askatasun maila
kopurua duen ji karratu banakuntzan, bere gainetik %5-eko probabilitatea uzten
duen balioa 11.1 da. Guri atera zaigun balioa txikia denez, datuetatik eredura
dagoen distantzia eredua zuzena ez dela erabakitzeko nahikoa ez da. Eredua
onartu egiten da eta beraz, seikoa nogi eraikita dagoela erabaki behar da.
9

Inferentzia
Josemari Sarasola Ledesma
Makina batek azken asteotan jasan dituen matxurak jaso dira. Hauek dira
emaitzak:
0 − 1 − 2 − 2 − 0 − 2 − 2 − 1 − 3 − 2 − 1 − 0 − 2 − 2
%10-
eko adierazgarritasun mailaz, matxurak zoriz gertatzen direla esan al daiteke?
Matxurak zoriz gertatzen direla suposatu behar da hipotesi hutsean. Horrek
esan nahi du asteko matxura kopurua Poisson-en banakuntzaren araberakoa
dela. Probabilitateak kalkulatzeko Poisson-en ereduko λ parametroaren balioa
behar dugu. Parametro hau ereduaren itxaropenarekin bat datorrenez, bera
zenbatesteko lagin batezbestekoa erabiliko dugu:
ˆ
λ = x =
20
14
= 1.43
Eredua zehaztuta, probabilitateak eta maiztasun teorikoak emateko moduan
gaude:
Kopurua
ei
Prob.
ti
(ei−ti)
2
ti
0
3
0.24
3.36
1
3
0.34
4.76
2
7
0.24
3.36
3
1
0.12
1.68
≥ 4
0
0.06
0.84
14
1
14
Kalkula ezazu orain zuk ji-karratu estatistikoa eta erabakia hartu:
10

Inferentzia
Josemari Sarasola Ledesma
3.1.2
Aplikazioak eredu jarraietan
Eredu jarraietan, maiztasun teorikoak kalkulatu ahal izateko, ereduaren ibil-
tartea klase batzuetan banatu behar da.
Eguneko ekoizpen datu hauek jaso dira:
4.5 − 5.6 − 6.7 − 7.2 − 4.1 − 3.9 − 5.2 − 3.1 − 4.2 − 6.1 − 7.4
Eredu normala aukeratu da eguneko ekoizpenerako. Parametroak ohizko zen-
batesleak erabiliz konatiﬁkatu behar dira. Eredu normala egokia den erabaki
behar duzu %1-eko adierazgarritasun mailaz.
Ereduaren ibiltartea klase hauetan zatituto dugu (nahi dugulako):
(−∞, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7), (7, 8), (8, ∞)
Hemendik aurrera ebaz ezazu zerorrek:
11

Inferentzia
Josemari Sarasola Ledesma
4
Homogenotasun kontrasteak
Lagina osatzen denean, baliteke ezaugarri ezberdinak dituzten datuak batera
jartzea. Horrela balitz, ikasi ditigun inferentzia teknikak ez lirateke baliozkoak
izango, prozesu osoan populazioa homogenoa zela pentsatu baita. Beraz, datuak
populazio bakar eta homogeno batekoak diren egiaztatu behar da. Horretarako,
homogenotasun kontrasteak erabil daitezke.
4.1
Mann-Whitney-en U kontrastea
Kontrastea U izena duen estatistiko batetik abaitzen da. U estatistikoak bi
populazioak zenbateraino diren ezberdinak neurtzen du: zenbat eta txikiagoa
edo handiagoa izan, bi populazioak hainbat eta heterogenoagoak izateko joera
izango dute. Beraz, kontrastearen alde kritikoa behetik zein goitik dago beti.
Beste izen hau ere ematen zaio kontraste honi: Wilcoxon rank-sum test edo
Wilcoxon-en orden-baturaren kontrastea.
Honela kalkulatzen da U : lagin bateko elementu bakoitza beste lagineko
elementu guztiekin alderatu eta handiagoa den kasu guztiak zenbatzen dira;
elementu guztietarako berdina eginez, totala kalkulatzen da. Elementuak alder-
atzean berdinketa badago, erdia kontatzen da.
Adibide batez ikasiko dugu. Emakumezko eta gizonezko batzuk pieza bat
egiteko behar izan duten denborak jaso dira minututan:
emakume
3
4
5
7
10
gizonezko
8
9
11
12
13
14
Datuak batera jarri al daitezke inferentzia egiteko? Hau da, bi populazioak
homogenoak edo berdintsuak direla esan al daiteke?
Emakumezkoen denborak gizonezkoek gainditzen duten aldi kopurua hau
da, gizonezko guztietarako batuketa eginez:
U = 4 + 4 + 5 + 5 + 5 + 5 = 28
Bada U kalkulatzeko beste modu bat: datu guztiak batera jartzen dira, eta
multzo bakoitzeko ordenak zenbatzen dira (berdinketa badago, 6. eta 7. po-
sizioan abidez, erdian (6.5ean) geratzen gara). Ondoren, ordenak batu (emaitza
R izango da) eta U honela kalkulatuko da:
U = n1n2 +
n1(n1 + 1)
2
− R
12

Inferentzia
Josemari Sarasola Ledesma
Aurreko adibidera itzuliz:
3(e) − 4(e) − 5(e) − 7(e) − 8(g) − 9(g) − 10(e) − 11(g) − 12(g) − 13(g) − 14(g)
Emakumezkoen ordenak edo sailkapen postuak gehituz:
R = 1 + 2 + 3 + 4 + 7 = 17
U = 5 × 6 +
5 × 6
2
− 17 = 28
Orain, U minimo hau zenbateraino den arraroa ikusi behar dugu, bere prob-
abilitatea alegia kalkulatu behar da. Horretarako, R softwarea erabiliko dugu.
Aginduak eta emaitzak hauek dira 4:
> y<-c(8,9,11,12,13,14)
> x<-c(3,4,5,7,10)
> wilcox.test(y,x)
Wilcoxon rank sum test
data:
y and x
W = 28, p-value = 0.01732
alternative hypothesis: true location shift is not equal to 0
p-
value delako adierazgarritasun mailarekin alderatu behar da erabaki bat hartzeko.
Ohar zaitez, U estatistikoaren emaitza ere ematen duela: W = 28. Kasu hone-
tan, α = 0.05 hartzen bada, hipotesi hutsa, homogenotasuna alegia, ukatuko
dugu: emakumezkoak eta gizonezkoak ezberdinak direla erabaki behar da eta
beraz, bien datuak ez direla batera jarri behar.
Lagin tamainuak handiak direnean, probabilitateak kalkulatzeko badago
hurbilketa normal bat.
Azkenik, kontrastea bi multzoetako batezbestekoak berdinak diren erabak-
itzeko ere oso ona dela esan behar da, Student t kontrastea bezain hobea egoera
askotan. Batezbesteko bat bestea baino handiagoa dela ere ezar daiteke alter-
natiba moduan baina honela kontrastea alde bakarrekoa bihurtuko dela hartu
behar da kontuan (orduan, R softwarean kontuz ibili behar da: aginduak es-
kaintzen dituen beste aukera batzuk behar bezala erabili beharko dira).
4wilcox.test
aginduan,
kontuan
hartzekoak
dira
datu
bektoreen
ordena:
wilcox.test(x,y) eta wilcox.test(y,x) aginduek ezberdin emango dute.
Hau gar-
rantzitsua da batzuetan kontrastea alde bakarrekoa dela planteatzen denean, nahiz eta orohar
kontrastea alde bikoa izango den. Ikus ezazu epigrafearen bukaeran
13
